"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[952],{4952:(tt,T,r)=>{r.r(T),r.d(T,{ContratosRoutingModule:()=>W});var y=r(8109),A=r(386),u=r(3566),g=r(1476),h=r(5313),c=r(6223),U=r(3620),w=r(3997),l=r(6814),f=r(2296),v=r(6007),Z=r(617),x=r(4170),b=r(4516),C=r(8525),_=r(7988),j=r(6385),d=r(2246),t=r(9212),m=r(2096);let E=(()=>{class o{constructor(){}getEjecuciones(){return(0,m.of)(d.P_)}getEjecucion(e){const n=d.P_.find(i=>i.id===e);return(0,m.of)(n)}createEjecucion(e){return d.P_.push(e),(0,m.of)(e)}updateEjecucion(e,n){const i=d.P_.findIndex(a=>a.id===e);return-1!==i?(d.P_[i]=n,(0,m.of)(n)):(0,m.of)(void 0)}deleteEjecucion(e){const n=d.P_.findIndex(i=>i.id===e);return-1!==n&&d.P_.splice(n,1),(0,m.of)()}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var F=r(3680);function q(o,s){1&o&&(t.TgZ(0,"div",35),t._UZ(1,"mat-progress-bar",36),t.qZA()),2&o&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function k(o,s){1&o&&t.GkF(0)}const I=o=>({$implicit:o});function J(o,s){if(1&o&&(t.ynx(0),t.YNc(1,k,1,0,"ng-container",46),t.BQk()),2&o){const e=t.oxw().$implicit;t.oxw(2);const n=t.MAs(59);t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(2,I,e))}}function Q(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",42)(2,"div",43),t._uU(3),t.qZA(),t.TgZ(4,"div",43),t._uU(5),t.qZA(),t.TgZ(6,"div"),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.TgZ(9,"div"),t._uU(10),t.ALo(11,"currency"),t.qZA(),t.TgZ(12,"div",43),t._uU(13),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"div")(18,"button",44),t.NdJ("click",function(){const a=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.toggleDetails(a.id))}),t._UZ(19,"mat-icon",10),t.qZA()()(),t.TgZ(20,"div",37),t.YNc(21,J,2,4,"ng-container",45),t.qZA(),t.BQk()}if(2&o){const e=s.$implicit,n=t.oxw(2);t.xp6(3),t.hij(" ",e.proveedor.nombre," "),t.xp6(2),t.hij(" ",e.contrato.no_contrato," "),t.xp6(2),t.hij(" ",t.gM2(8,8,e.costo_cup,"CUP","symbol","1.2-2")," "),t.xp6(3),t.hij(" ",t.gM2(11,13,e.costo_cl,"CLP","symbol","1.2-2")," "),t.xp6(3),t.hij(" ",e.trabajo_ejecutado," "),t.xp6(2),t.hij(" ",t.xi3(16,18,e.fecha_ejecucion,"shortDate")," "),t.xp6(4),t.Q6J("svgIcon",(null==n.selectedRow?null:n.selectedRow.id)===e.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),t.xp6(2),t.Q6J("ngIf",(null==n.selectedRow?null:n.selectedRow.id)===e.id)}}const S=o=>({"pointer-events-none":o}),R=()=>[5,10,25,100];function N(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div",37)(2,"div",38)(3,"div",39),t._uU(4,"Proveedor"),t.qZA(),t.TgZ(5,"div",39),t._uU(6,"Contrato"),t.qZA(),t.TgZ(7,"div",39),t._uU(8,"Costo (CUP)"),t.qZA(),t.TgZ(9,"div",39),t._uU(10,"Costo (CL)"),t.qZA(),t.TgZ(11,"div",39),t._uU(12,"Trabajo Ejecutado"),t.qZA(),t.TgZ(13,"div",39),t._uU(14,"Fecha Ejecuci\xf3n"),t.qZA(),t.TgZ(15,"div"),t._uU(16,"Detalles"),t.qZA()(),t.YNc(17,Q,22,21,"ng-container",40),t.qZA(),t._UZ(18,"mat-paginator",41),t.BQk()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("mat-sort-header","proveedor"),t.xp6(2),t.Q6J("mat-sort-header","contrato"),t.xp6(2),t.Q6J("mat-sort-header","costo_cup"),t.xp6(2),t.Q6J("mat-sort-header","costo_cl"),t.xp6(2),t.Q6J("mat-sort-header","trabajo_ejecutado"),t.xp6(2),t.Q6J("mat-sort-header","fecha_ejecucion"),t.xp6(4),t.Q6J("ngForOf",e.dataSource.data)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngClass",t.VKq(14,S,e.isLoading))("length",e.pagination.length)("pageIndex",e.pagination.page)("pageSize",e.pagination.size)("pageSizeOptions",t.DdM(16,R))("showFirstLastButtons",!0)}}function O(o,s){if(1&o&&(t.TgZ(0,"mat-option",66),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.nombre," ")}}function P(o,s){if(1&o&&(t.TgZ(0,"mat-option",66),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.no_contrato," ")}}function M(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",47)(1,"div",48)(2,"form",49)(3,"div",50)(4,"div",51)(5,"div",52)(6,"mat-form-field",53)(7,"mat-label"),t._uU(8,"Proveedor"),t.qZA(),t.TgZ(9,"mat-select",54),t.YNc(10,O,2,2,"mat-option",55),t.qZA()(),t.TgZ(11,"mat-form-field",53)(12,"mat-label"),t._uU(13,"Contrato"),t.qZA(),t.TgZ(14,"mat-select",56),t.YNc(15,P,2,2,"mat-option",55),t.qZA()(),t.TgZ(16,"mat-form-field",53)(17,"mat-label"),t._uU(18,"Costo (CUP)"),t.qZA(),t.TgZ(19,"span",57),t._uU(20,"CUP"),t.qZA(),t._UZ(21,"input",58),t.qZA()(),t.TgZ(22,"div",59)(23,"mat-form-field",53)(24,"mat-label"),t._uU(25,"Costo (CL)"),t.qZA(),t.TgZ(26,"span",57),t._uU(27,"CLP"),t.qZA(),t._UZ(28,"input",60),t.qZA(),t.TgZ(29,"mat-form-field",53)(30,"mat-label"),t._uU(31,"Trabajo Ejecutado"),t.qZA(),t._UZ(32,"input",61),t.qZA(),t.TgZ(33,"mat-form-field",53)(34,"mat-label"),t._uU(35,"Fecha Ejecuci\xf3n"),t.qZA(),t._UZ(36,"input",62),t.qZA()()()(),t.TgZ(37,"div",63)(38,"button",64),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteSelectedRecord())}),t._uU(39," Eliminar "),t.qZA(),t.TgZ(40,"div",4)(41,"button",65),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateSelectedRecord())}),t._uU(42," Actualizar "),t.qZA()()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.selectedRowForm),t.xp6(8),t.Q6J("ngForOf",e.mockProveedor),t.xp6(5),t.Q6J("ngForOf",e.mockContrato)}}function L(o,s){1&o&&(t.TgZ(0,"div",67),t._uU(1,"\xa1No hay ejecuciones!"),t.qZA())}let z=(()=>{class o{constructor(e){this.ejecucionService=e,this.data=[],this.columns=[{key:"proveedor",label:"Proveedor",nestedKey:"nombre",editable:!1,selectOptions:d.UB},{key:"contrato",label:"Contrato",nestedKey:"no_contrato",editable:!1,selectOptions:d.Io},{key:"costo_cup",label:"Costo (CUP)",type:"currency",editable:!0},{key:"costo_cl",label:"Costo (CL)",type:"currency",editable:!0},{key:"trabajo_ejecutado",label:"Trabajo Ejecutado",editable:!0},{key:"fecha_ejecucion",label:"Fecha Ejecuci\xf3n",type:"date",editable:!0}],this.title="Ejecuci\xf3n de Contratos",this.addButtonText="Agregar Ejecuci\xf3n",this.displayedColumns=[],this.searchInputControl=new c.NI(""),this.selectedRow=null,this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.dataSource=new h.by([]),this.selectedRowForm=new c.cw({})}ngOnInit(){this.displayedColumns=this.columns.map(e=>e.key).concat("details"),this.loadEjecuciones(),this.searchInputControl.valueChanges.pipe((0,U.b)(300),(0,w.x)()).subscribe(e=>{this.dataSource.filter=e?.trim().toLowerCase()||""}),this.dataSource.filterPredicate=(e,n)=>Object.keys(e).reduce((a,p)=>a+(this.getNestedValue(e,p,this.columns.find($=>$.key===p)?.nestedKey)||"")+" ","").toLowerCase().includes(n)}loadEjecuciones(){this.isLoading=!0,this.errorMessage="",this.ejecucionService.getEjecuciones().subscribe({next:e=>{this.data=e,this.dataSource.data=this.data,this.pagination.length=this.data.length,this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.isLoading=!1},error:e=>{this.errorMessage="Error loading ejecuciones",this.isLoading=!1}})}trackByFn(e,n){return n.id}getNestedValue(e,n,i){return i&&e[n]?e[n][i]:e[n]||""}toggleDetails(e){this.selectedRow=this.selectedRow?.id===e?null:this.data.find(n=>n.id===e),this.selectedRowForm=new c.cw({proveedor:new c.NI(this.selectedRow?.proveedor),contrato:new c.NI(this.selectedRow?.contrato),costo_cup:new c.NI(this.selectedRow?.costo_cup),costo_cl:new c.NI(this.selectedRow?.costo_cl),trabajo_ejecutado:new c.NI(this.selectedRow?.trabajo_ejecutado),fecha_ejecucion:new c.NI(this.selectedRow?.fecha_ejecucion)})}createRecord(){if(this.selectedRowForm.valid){const e={...this.selectedRowForm.value,id:this.data.length+1};this.ejecucionService.createEjecucion(e).subscribe({next:n=>{this.loadEjecuciones(),this.selectedRow=null,this.selectedRowForm.reset()}})}}updateSelectedRecord(){if(this.selectedRow&&this.selectedRowForm.valid){const e={...this.selectedRow,...this.selectedRowForm.value};this.ejecucionService.updateEjecucion(this.selectedRow.id,e).subscribe({next:n=>{this.loadEjecuciones()}})}}deleteSelectedRecord(){this.selectedRow&&this.ejecucionService.deleteEjecucion(this.selectedRow.id).subscribe({next:()=>{this.loadEjecuciones(),this.selectedRow=null}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(E))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-ejecucion-contrato"]],viewQuery:function(n,i){if(1&n&&(t.Gf(u.YE,5),t.Gf(g.NW,5)),2&n){let a;t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first)}},standalone:!0,features:[t.jDz],decls:62,vars:18,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"absolute","bottom-0","right-0","w-24","h-24","-m-6"],[1,"icon-size-24","opacity-25","text-green-500","dark:text-green-400",3,"svgIcon"],[1,"flex","items-center"],[1,"flex","flex-col"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[1,"text-green-600","font-medium","text-sm"],[1,"ml-auto","-mt-2"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["previousStatementMenu","matMenu"],["mat-menu-item",""],[1,"icon-size-5","mr-3",3,"svgIcon"],[1,"my-2"],[1,"flex","flex-row","flex-wrap","mt-4","-mx-6"],[1,"flex","flex-col","mx-6","my-3"],[1,"text-sm","font-medium","leading-none","text-secondary"],[1,"mt-2","font-medium","text-3xl","leading-none"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["rowDetailsTemplate",""],["noEjecucionesTemplate",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5",2,"grid-template-columns","repeat(7, minmax(0, 1fr))"],[3,"mat-sort-header"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"inventory-grid","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b",2,"grid-template-columns","repeat(7, minmax(0, 1fr))"],[1,"truncate"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"flex","flex-col","w-full",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","p-8"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-2/4","sm:pl-8"],[1,"w-full"],["formControlName","proveedor"],[3,"value",4,"ngFor","ngForOf"],["formControlName","contrato"],["matPrefix",""],["matInput","","type","number","formControlName","costo_cup"],[1,"flex","flex-col","w-full","lg:w-1/4","sm:pl-8"],["matInput","","type","number","formControlName","costo_cl"],["matInput","","formControlName","trabajo_ejecutado"],["matInput","","type","date","formControlName","fecha_ejecucion"],[1,"flex","items-center","justify-between","w-full","border-t","px-8","py-4"],["mat-button","","color","warn",1,"-ml-4",3,"click"],["mat-flat-button","","color","primary",3,"click"],[3,"value"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"mat-icon",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6),t._uU(7,"Estado Anterior"),t.qZA(),t.TgZ(8,"div",7),t._uU(9," Datos recientes de ejecuci\xf3n de contratos "),t.qZA()(),t.TgZ(10,"div",8)(11,"button",9),t._UZ(12,"mat-icon",10),t.qZA(),t.TgZ(13,"mat-menu",null,11)(15,"button",12)(16,"span",4),t._UZ(17,"mat-icon",13),t.TgZ(18,"span"),t._uU(19,"Ver detalles"),t.qZA()()(),t.TgZ(20,"button",12)(21,"span",4),t._UZ(22,"mat-icon",13),t.TgZ(23,"span"),t._uU(24,"Reportes"),t.qZA()()(),t._UZ(25,"mat-divider",14),t.TgZ(26,"button",12)(27,"span",4),t._UZ(28,"mat-icon",13),t.TgZ(29,"span"),t._uU(30,"Imprimir"),t.qZA()()(),t.TgZ(31,"button",12)(32,"span",4),t._UZ(33,"mat-icon",13),t.TgZ(34,"span"),t._uU(35,"Enviar por correo"),t.qZA()()()()()(),t.TgZ(36,"div",15)(37,"div",16)(38,"div",17),t._uU(39,"Total Ejecuciones"),t.qZA(),t.TgZ(40,"div",18),t._uU(41),t.qZA()()()(),t.TgZ(42,"div",19)(43,"div",20),t.YNc(44,q,2,1,"div",21),t.TgZ(45,"div",22),t._uU(46,"Ejecuci\xf3n de Contratos"),t.qZA(),t.TgZ(47,"div",23)(48,"mat-form-field",24),t._UZ(49,"mat-icon",25)(50,"input",26),t.qZA(),t.TgZ(51,"button",27),t.NdJ("click",function(){return i.createRecord()}),t._UZ(52,"mat-icon",28),t.TgZ(53,"span",29),t._uU(54,"Agregar"),t.qZA()()()(),t.TgZ(55,"div",30)(56,"div",31),t.YNc(57,N,19,17,"ng-container",32)(58,M,43,3,"ng-template",null,33,t.W1O)(60,L,2,0,"ng-template",null,34,t.W1O),t.qZA()()()()),2&n){const a=t.MAs(14),p=t.MAs(61);t.xp6(3),t.Q6J("svgIcon","heroicons_outline:check-circle"),t.xp6(8),t.Q6J("matMenuTriggerFor",a),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),t.xp6(5),t.Q6J("svgIcon","heroicons_solid:credit-card"),t.xp6(5),t.Q6J("svgIcon","heroicons_solid:banknotes"),t.xp6(6),t.Q6J("svgIcon","heroicons_solid:printer"),t.xp6(5),t.Q6J("svgIcon","heroicons_solid:envelope"),t.xp6(8),t.Oqu(i.data.length),t.xp6(3),t.Q6J("ngIf",i.isLoading),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar ejecuciones"),t.xp6(1),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(5),t.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",p)}},dependencies:[l.ez,l.mk,l.sg,l.O5,l.tP,l.H9,l.uU,f.ot,f.lW,f.RK,v.Cv,v.pW,u.JX,u.YE,u.nU,h.p0,Z.Ps,Z.Hw,c.UX,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.oH,c.sg,c.u,g.TU,g.NW,x.lN,x.KE,x.hX,x.qo,b.c,b.Nt,C.LD,C.gD,F.ey,_.Tx,_.VK,_.OP,_.p6,j.t,j.d],encapsulation:2,changeDetection:0})}return o})();var B=r(5170);function D(o,s){1&o&&(t.TgZ(0,"div",9),t._UZ(1,"mat-progress-bar",10),t.qZA()),2&o&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function Y(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.TgZ(4,"div",16),t._uU(5),t.qZA(),t.TgZ(6,"div"),t._uU(7),t.qZA(),t.TgZ(8,"div"),t._uU(9),t.ALo(10,"currency"),t.qZA(),t.TgZ(11,"div"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"div")(18,"button",17),t._uU(19,"Restaurar"),t.qZA(),t.TgZ(20,"button",18),t._uU(21,"Eliminar"),t.qZA()()(),t.BQk()),2&o){const e=s.$implicit;t.xp6(3),t.Oqu(e.no_contrato),t.xp6(2),t.Oqu(e.proveedor.nombre),t.xp6(2),t.Oqu(e.tipo_contrato.tipo_contrato),t.xp6(2),t.Oqu(t.gM2(10,6,e.valor_cup,"CUP","symbol","1.2-2")),t.xp6(3),t.Oqu(t.xi3(13,11,e.fecha_firmado,"shortDate")),t.xp6(3),t.Oqu(t.xi3(16,14,e.fecha_vencido,"shortDate"))}}function G(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div",11)(2,"div",12)(3,"div",13),t._uU(4,"No. Contrato"),t.qZA(),t.TgZ(5,"div",13),t._uU(6,"Proveedor"),t.qZA(),t.TgZ(7,"div",13),t._uU(8,"Tipo de Contrato"),t.qZA(),t.TgZ(9,"div",13),t._uU(10,"Valor (CUP)"),t.qZA(),t.TgZ(11,"div",13),t._uU(12,"Fecha Firmado"),t.qZA(),t.TgZ(13,"div",13),t._uU(14,"Fecha Vencido"),t.qZA(),t.TgZ(15,"div"),t._uU(16,"Acciones"),t.qZA()(),t.YNc(17,Y,22,17,"ng-container",14),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("mat-sort-header","no_contrato"),t.xp6(2),t.Q6J("mat-sort-header","proveedor"),t.xp6(2),t.Q6J("mat-sort-header","tipo_contrato"),t.xp6(2),t.Q6J("mat-sort-header","valor_cup"),t.xp6(2),t.Q6J("mat-sort-header","fecha_firmado"),t.xp6(2),t.Q6J("mat-sort-header","fecha_vencido"),t.xp6(4),t.Q6J("ngForOf",e.dataSource.data)("ngForTrackBy",e.trackByFn)}}function H(o,s){1&o&&(t.TgZ(0,"div",19),t._uU(1,"\xa1No hay contratos vencidos!"),t.qZA())}const K=[{path:"tipos",component:A.M},{path:"contratos",component:z},{path:"vencidos",component:(()=>{class o{constructor(e,n){this.contratoService=e,this.cdr=n,this.displayedColumns=["no_contrato","proveedor","tipo_contrato","valor_cup","fecha_firmado","fecha_vencido","acciones"],this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.dataSource=new h.by([])}ngOnInit(){this.loadExpiredContracts()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.cdr.markForCheck()}loadExpiredContracts(){this.isLoading=!0,this.errorMessage="",this.contratoService.getExpiredContratos().subscribe({next:e=>{console.log("Expired contracts received:",e),this.dataSource.data=e.filter(n=>n.proveedor&&n.proveedor.nombre),console.log("Expired DataSource data:",this.dataSource.data),this.pagination.length=this.dataSource.data.length,this.isLoading=!1,this.cdr.markForCheck()},error:e=>{console.error("Error fetching expired contracts:",e),this.errorMessage="Failed to load expired contracts. Please try again.",this.isLoading=!1,this.cdr.markForCheck()}})}trackByFn(e,n){return n.id}restoreContrato(e){this.contratoService.restoreContrato(e).subscribe({next:()=>{this.loadExpiredContracts(),this.cdr.markForCheck()},error:n=>{console.error("Error restoring contrato:",n),this.errorMessage="Failed to restore contract. Please try again.",this.cdr.markForCheck()}})}deleteContrato(e){this.contratoService.deleteContrato(e).subscribe({next:()=>{this.loadExpiredContracts(),this.cdr.markForCheck()},error:n=>{console.error("Error deleting contrato:",n),this.errorMessage="Failed to delete contract. Please try again.",this.cdr.markForCheck()}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(B.d),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-expired-contracts"]],viewQuery:function(n,i){if(1&n&&(t.Gf(u.YE,5),t.Gf(g.NW,5)),2&n){let a;t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first)}},standalone:!0,features:[t.jDz],decls:11,vars:3,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["noExpiredContracts",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5",2,"grid-template-columns","repeat(7, minmax(0, 1fr))"],[3,"mat-sort-header"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inventory-grid","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b",2,"grid-template-columns","repeat(7, minmax(0, 1fr))"],[1,"truncate"],["mat-button","","color","primary"],["mat-button","","color","warn"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,D,2,1,"div",3),t.TgZ(4,"div",4),t._uU(5,"Contratos Vencidos"),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6),t.YNc(8,G,18,8,"ng-container",7)(9,H,2,0,"ng-template",null,8,t.W1O),t.qZA()()()()),2&n){const a=t.MAs(10);t.xp6(3),t.Q6J("ngIf",i.isLoading),t.xp6(5),t.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",a)}},dependencies:[l.ez,l.sg,l.O5,l.H9,l.uU,f.ot,f.lW,v.Cv,v.pW,u.JX,u.YE,u.nU,h.p0,Z.Ps,c.UX,g.TU,x.lN,b.c,C.LD],styles:['@charset "UTF-8";.inventory-grid{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:1rem;padding:.5rem 0;border-bottom:1px solid #e0e0e0}.inventory-grid>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.bg-card{background-color:#fff;border-radius:.5rem;box-shadow:0 0 10px #0000001a}.text-secondary{color:#6b7280}.shadow{box-shadow:0 1px 3px #0000001a}\n'],encapsulation:2,changeDetection:0})}return o})()}];let W=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[y.Bz.forChild(K),y.Bz]})}return o})()}}]);