(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[403],{4065:(O,D,l)=>{"use strict";l.d(D,{_:()=>C});var U=l(2022),_=l(9212),A=l(9862);let C=(()=>{class e{constructor(c){this.http=c,this.baseUrl=U.P.DEPARTAMENTOS}getDepartamentos(){console.log("Fetching departamentos list from backend");const c=this.http.get(this.baseUrl);return c.subscribe(u=>console.log("Response from getDepartamentos:",u)),c}getDepartamentoById(c){console.log(`Fetching departamento with id ${c} from backend`);const u=this.http.get(`${this.baseUrl}/${c}`);return u.subscribe(f=>console.log(`Response from getDepartamentoById(${c}):`,f)),u}createDepartamento(c){console.log("Creating departamento:",c);const u=this.http.post(this.baseUrl,c);return u.subscribe(f=>console.log("Response from createDepartamento:",f)),u}updateDepartamento(c,u){console.log(`Updating departamento with id ${c}:`,u);const f=this.http.put(`${this.baseUrl}/${c}`,u);return f.subscribe(d=>console.log(`Response from updateDepartamento(${c}):`,d)),f}deleteDepartamento(c){console.log(`Deleting departamento with id ${c}`);const u=this.http.delete(`${this.baseUrl}/${c}`);return u.subscribe(()=>console.log(`Response from deleteDepartamento(${c}): success`)),u}static#e=this.\u0275fac=function(u){return new(u||e)(_.LFG(A.eN))};static#t=this.\u0275prov=_.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},8403:(O,D,l)=>{"use strict";l.r(D),l.d(D,{OrganizacionRoutingModule:()=>wt});var U=l(1896),_=l(6814),A=l(5195),C=l(6007),e=l(9212);let y=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[_.ez]})}return n})();var x=l(2096);let E=(()=>{class n{constructor(){}getLicense(){const t={id:1,entidad_id:1,numero_licencia:"ABC-123-XYZ",tipo_licencia:"Software",fecha_emision:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-10),fecha_vencimiento:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+20),estado:"Activo",entidad:{}};return(0,x.of)(t)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var v=l(9397),Z=l(6306),k=l(2022),R=l(9862);let j=(()=>{class n{constructor(t){this.http=t,this.entidad=[]}getLogs(){return this.http.get(k.P.MI_ENTIDAD).pipe((0,v.b)(t=>console.log("entidad fetched:",t)),(0,Z.K)(t=>(console.error("Error fetching contratos:",t),(0,x.of)([...this.entidad]))))}getContratoById(t){return this.http.get(`${k.P.MI_ENTIDAD}/${t}`).pipe((0,Z.K)(o=>{console.error("Error fetching contrato by id:",o);const i=this.entidad.find(r=>r.id===t);if(i)return(0,x.of)(i);throw o}))}createContrato(t){return this.http.post(k.P.MI_ENTIDAD,t).pipe((0,Z.K)(o=>{console.error("Error creating contrato:",o);const i={...t,id:this.entidad.length};return this.entidad.push(i),(0,x.of)(i)}))}updateContrato(t,o){return this.http.put(`${k.P.MI_ENTIDAD}/${t}`,o).pipe((0,Z.K)(i=>{console.error("Error updating contrato:",i);const r=this.entidad.findIndex(g=>g.id===t);if(-1!==r)return this.entidad[r]={...o,id:t},(0,x.of)(this.entidad[r]);throw new Error("Contrato not found")}))}deleteContrato(t){return this.http.delete(`${k.P.MI_ENTIDAD}/${t}`).pipe((0,Z.K)(o=>{console.error("Error deleting contrato:",o);const i=this.entidad.findIndex(r=>r.id===t);if(-1!==i)return this.entidad.splice(i,1),(0,x.of)(void 0);throw new Error("Contrato not found")}))}static#e=this.\u0275fac=function(o){return new(o||n)(e.LFG(R.eN))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function X(n,a){if(1&n&&(e.TgZ(0,"div",21),e._UZ(1,"img",22),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",t.licenseData.entidad.logo,e.LSH)("alt",t.licenseData.entidad.nombre_entidad+" Logo")}}function ee(n,a){if(1&n&&(e.TgZ(0,"div",41)(1,"span",42),e._uU(2,"Ubicaci\xf3n:"),e.qZA(),e.TgZ(3,"span",43),e._uU(4),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.AsE("",t.licenseData.entidad.municipio.nombre,", ",t.licenseData.entidad.provincia.nombre,"")}}function te(n,a){if(1&n&&(e.TgZ(0,"div",47)(1,"h4",48),e._uU(2,"Observaciones"),e.qZA(),e.TgZ(3,"p",49),e._uU(4),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.licenseData.observaciones)}}function oe(n,a){if(1&n&&(e.TgZ(0,"div",23)(1,"div",24)(2,"div",25)(3,"div",26),e._UZ(4,"i",27),e.TgZ(5,"span",28),e._uU(6,"Activaci\xf3n"),e.qZA()(),e.TgZ(7,"p",29),e._uU(8),e.qZA()(),e.TgZ(9,"div",25)(10,"div",26),e._UZ(11,"i",30),e.TgZ(12,"span",28),e._uU(13,"Expiraci\xf3n"),e.qZA()(),e.TgZ(14,"p",29),e._uU(15),e.qZA()(),e.TgZ(16,"div",25)(17,"div",26),e._UZ(18,"i",31),e.TgZ(19,"span",28),e._uU(20,"Estado"),e.qZA()(),e.TgZ(21,"div",32),e._UZ(22,"i"),e._uU(23),e.qZA()()(),e.TgZ(24,"div",33)(25,"div",34)(26,"div",35),e._uU(27),e.qZA(),e.TgZ(28,"div",36),e._uU(29,"d\xedas restantes"),e.qZA()()(),e.TgZ(30,"div",37)(31,"div",38)(32,"h3",39),e._uU(33,"Detalles de la Licencia"),e.qZA(),e.TgZ(34,"div",40)(35,"div",41)(36,"span",42),e._uU(37,"Tipo:"),e.qZA(),e.TgZ(38,"span",43),e._uU(39),e.qZA()(),e.TgZ(40,"div",41)(41,"span",42),e._uU(42,"ID:"),e.qZA(),e.TgZ(43,"span",44),e._uU(44),e.qZA()(),e.TgZ(45,"div",41)(46,"span",42),e._uU(47,"Entidad ID:"),e.qZA(),e.TgZ(48,"span",44),e._uU(49),e.qZA()()()(),e.TgZ(50,"div",38)(51,"h3",39),e._uU(52,"Informaci\xf3n de la Entidad"),e.qZA(),e.TgZ(53,"div",40)(54,"div",41)(55,"span",42),e._uU(56,"Nombre:"),e.qZA(),e.TgZ(57,"span",43),e._uU(58),e.qZA()(),e.TgZ(59,"div",41)(60,"span",42),e._uU(61,"C\xf3digo:"),e.qZA(),e.TgZ(62,"span",44),e._uU(63),e.qZA()(),e.TgZ(64,"div",41)(65,"span",42),e._uU(66,"Tipo Empresa:"),e.qZA(),e.TgZ(67,"span",43),e._uU(68),e.qZA()(),e.TgZ(69,"div",41)(70,"span",42),e._uU(71,"Domicilio Legal:"),e.qZA(),e.TgZ(72,"span",43),e._uU(73),e.qZA()(),e.TgZ(74,"div",41)(75,"span",42),e._uU(76,"Tel\xe9fonos:"),e.qZA(),e.TgZ(77,"span",43),e._uU(78),e.qZA()(),e.YNc(79,ee,5,2,"div",45),e.qZA()()(),e.YNc(80,te,5,1,"div",46),e.qZA()),2&n){const t=e.oxw();e.xp6(8),e.Oqu(t.formatDate(t.licenseData.fecha_emision)),e.xp6(7),e.Oqu(t.formatDate(t.licenseData.fecha_vencimiento)),e.xp6(6),e.Q6J("ngClass",t.getStatusColor()),e.xp6(1),e.Tol("icon-"+t.getStatusIcon()),e.xp6(1),e.hij(" ",t.licenseData.estado," "),e.xp6(4),e.Oqu(t.daysRemaining),e.xp6(12),e.Oqu(t.licenseData.tipo_licencia),e.xp6(5),e.Oqu(t.licenseData.id),e.xp6(5),e.Oqu(t.licenseData.entidad_id),e.xp6(9),e.Oqu(t.licenseData.entidad.nombre_entidad),e.xp6(5),e.Oqu(t.licenseData.entidad.codigo_entidad),e.xp6(5),e.Oqu(t.licenseData.entidad.tipo_empresa),e.xp6(5),e.Oqu(t.licenseData.entidad.domicilio_legal),e.xp6(5),e.Oqu(t.licenseData.entidad.telefonos),e.xp6(1),e.Q6J("ngIf",t.licenseData.entidad.municipio&&t.licenseData.entidad.provincia),e.xp6(1),e.Q6J("ngIf",t.licenseData.observaciones)}}function ne(n,a){if(1&n&&(e.TgZ(0,"tr",57)(1,"td",58),e._uU(2),e.qZA(),e.TgZ(3,"td",59),e._uU(4),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.serie),e.xp6(2),e.Oqu(t.fecha)}}function ie(n,a){if(1&n&&(e.TgZ(0,"div",60),e._UZ(1,"i",61),e.TgZ(2,"div",62)(3,"p",63),e._uU(4),e.qZA(),e.TgZ(5,"p",64),e._uU(6),e.qZA()()()),2&n){const t=a.$implicit;e.xp6(4),e.Oqu(t.usuario),e.xp6(2),e.hij("Activado: ",t.fecha,"")}}function ae(n,a){if(1&n&&(e.TgZ(0,"div",23)(1,"div",50)(2,"div",51)(3,"h3",39),e._uU(4,"Historial de Activaciones"),e.qZA(),e.TgZ(5,"div",52)(6,"table",53)(7,"thead")(8,"tr")(9,"th"),e._uU(10,"No. de serie"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Fecha"),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,ne,5,2,"tr",54),e.qZA()()()(),e.TgZ(15,"div",51)(16,"h3",39),e._uU(17,"Usuarios Vinculados"),e.qZA(),e.TgZ(18,"div",55),e.YNc(19,ie,7,2,"div",56),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",t.historialActivaciones),e.xp6(5),e.Q6J("ngForOf",t.historialActivaciones)}}function re(n,a){if(1&n&&(e.TgZ(0,"div",23)(1,"div",65)(2,"h3",39),e._uU(3),e.qZA(),e.TgZ(4,"div",66)(5,"div",67)(6,"h4",68),e._uU(7,"Caracter\xedsticas Incluidas"),e.qZA(),e.TgZ(8,"ul",69)(9,"li",70),e._UZ(10,"i",71),e._uU(11," Acceso completo al sistema ERP "),e.qZA(),e.TgZ(12,"li",70),e._UZ(13,"i",71),e._uU(14," Usuarios ilimitados "),e.qZA(),e.TgZ(15,"li",70),e._UZ(16,"i",71),e._uU(17," Soporte t\xe9cnico 24/7 "),e.qZA(),e.TgZ(18,"li",70),e._UZ(19,"i",71),e._uU(20," Actualizaciones autom\xe1ticas "),e.qZA(),e.TgZ(21,"li",70),e._UZ(22,"i",71),e._uU(23," Respaldo en la nube "),e.qZA()()(),e.TgZ(24,"div",72)(25,"h4",73),e._uU(26,"Informaci\xf3n T\xe9cnica"),e.qZA(),e.TgZ(27,"div",74)(28,"div",75)(29,"p",76),e._uU(30,"Versi\xf3n:"),e.qZA(),e.TgZ(31,"p",77),e._uU(32,"v2.4.1"),e.qZA()(),e.TgZ(33,"div",75)(34,"p",76),e._uU(35,"\xdaltima actualizaci\xf3n:"),e.qZA(),e.TgZ(36,"p",77),e._uU(37,"15 de mayo, 2025"),e.qZA()(),e.TgZ(38,"div",75)(39,"p",76),e._uU(40,"Compatibilidad:"),e.qZA(),e.TgZ(41,"p",77),e._uU(42,"Windows, macOS, Linux"),e.qZA()(),e.TgZ(43,"div",75)(44,"p",76),e._uU(45,"Base de datos:"),e.qZA(),e.TgZ(46,"p",77),e._uU(47,"PostgreSQL 14+"),e.qZA()()()()()()()),2&n){const t=e.oxw();e.xp6(3),e.hij("Detalles del Plan ",t.licenseData.tipo_licencia,"")}}let ce=(()=>{class n{constructor(t,o){this.licenseService=t,this.entidadService=o,this.activeTab="estado",this.licenseData=null,this.daysRemaining=0,this.isLoading=!0,this.error="",this.historialActivaciones=[{serie:"SN987654320",fecha:"1 de ene. 2024",usuario:"juan.perez@empresa.com"},{serie:"SN876543210",fecha:"15 de dic. 2023",usuario:"admin@empresa.com"}]}ngOnInit(){this.loadLicenseData()}loadLicenseData(){this.isLoading=!0,this.error="",this.entidadService.getLogs().subscribe({next:t=>{console.log("Respuesta de entidades:",t);try{let o=[];if(t&&t.data&&Array.isArray(t.data)?o=t.data:Array.isArray(t)&&(o=t),o.length>0){const i=o[0];this.licenseData={id:1,entidad_id:i.id,numero_licencia:"ABC123-XYZ456",tipo_licencia:"Empresarial Pro",fecha_emision:new Date("2025-06-01"),fecha_vencimiento:new Date("2025-07-01"),estado:"Activa",observaciones:"Licencia renovada autom\xe1ticamente",entidad:{id:i.id,municipio_id:1,nombre_entidad:i.nombre,codigo_entidad:i.codigo,domicilio_legal:i.domicilio_legal,telefonos:i.telefonos,logo:i.logo,tipo_empresa:i.tipo_empresa,ministerio:i.ministerio,activo:i.activo,director_id:i.director_id,provincia:{id:1,nombre_provincia:i.provincia},municipio:{id:1,provincia_id:1,nombre_municipio:i.municipio,provincia:{id:1,nombre_provincia:i.provincia}}}},this.calculateDaysRemaining()}else this.error="No se encontraron entidades"}catch(o){console.error("Error procesando datos de entidad:",o),this.error="Error procesando los datos de la entidad"}this.isLoading=!1},error:t=>{console.error("Error al cargar datos de entidad:",t),this.error="Error al cargar los datos de la entidad",this.isLoading=!1}})}setActiveTab(t){this.activeTab=t}calculateDaysRemaining(){if(!this.licenseData)return;const t=new Date,i=new Date(this.licenseData.fecha_vencimiento).getTime()-t.getTime();this.daysRemaining=Math.ceil(i/864e5)}getStatusColor(){return this.daysRemaining>15?"status-active":this.daysRemaining>7?"status-warning":"status-danger"}getStatusIcon(){return this.daysRemaining>7?"check-circle":"alert-circle"}formatDate(t){return t.toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}onRenovar(){console.log("Renovar licencia")}onDescargarLicencia(){console.log("Descargar licencia")}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(E),e.Y36(j))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-license"]],standalone:!0,features:[e.jDz],decls:37,vars:13,consts:[[1,"license-container"],[1,"license-card"],[1,"header-section"],[1,"header-content"],[1,"title-section"],["class","logo-section",4,"ngIf"],[1,"text-section"],[1,"main-title"],[1,"subtitle"],[1,"license-number"],[1,"license-code"],[1,"entity-code"],[1,"btn-renovar",3,"click"],[1,"tabs-container"],[1,"tabs-nav"],[1,"tab-button",3,"click"],[1,"content-card"],["class","content-section",4,"ngIf"],[1,"download-section"],[1,"btn-download",3,"click"],[1,"icon-download"],[1,"logo-section"],[1,"entity-logo",3,"src","alt"],[1,"content-section"],[1,"status-grid"],[1,"status-card"],[1,"status-header"],[1,"icon-calendar"],[1,"status-label"],[1,"status-value"],[1,"icon-clock"],[1,"icon-shield"],[1,"status-badge",3,"ngClass"],[1,"days-remaining-card"],[1,"days-content"],[1,"days-number"],[1,"days-label"],[1,"details-grid"],[1,"details-section"],[1,"section-title"],[1,"details-list"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[1,"detail-value","detail-code"],["class","detail-item",4,"ngIf"],["class","observaciones-card",4,"ngIf"],[1,"observaciones-card"],[1,"observaciones-title"],[1,"observaciones-text"],[1,"historial-grid"],[1,"historial-section"],[1,"table-container"],[1,"data-table"],["class","table-row",4,"ngFor","ngForOf"],[1,"usuarios-list"],["class","usuario-card",4,"ngFor","ngForOf"],[1,"table-row"],[1,"table-cell","table-code"],[1,"table-cell"],[1,"usuario-card"],[1,"icon-user"],[1,"usuario-info"],[1,"usuario-email"],[1,"usuario-fecha"],[1,"detalles-container"],[1,"plan-sections"],[1,"caracteristicas-card"],[1,"caracteristicas-title"],[1,"caracteristicas-list"],[1,"caracteristica-item"],[1,"icon-check-circle"],[1,"tecnica-card"],[1,"tecnica-title"],[1,"tecnica-grid"],[1,"tecnica-item"],[1,"tecnica-label"],[1,"tecnica-value"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,X,2,2,"div",5),e.TgZ(6,"div",6)(7,"h1",7),e._uU(8,"Licencia de Software"),e.qZA(),e.TgZ(9,"h2",8),e._uU(10),e.qZA(),e.TgZ(11,"p",9),e._uU(12," Licencia: "),e.TgZ(13,"span",10),e._uU(14),e.qZA()(),e.TgZ(15,"p",11),e._uU(16," C\xf3digo Entidad: "),e.TgZ(17,"span",10),e._uU(18),e.qZA()()()(),e.TgZ(19,"button",12),e.NdJ("click",function(){return i.onRenovar()}),e._uU(20," RENOVAR "),e.qZA()()(),e.TgZ(21,"div",13)(22,"div",14)(23,"button",15),e.NdJ("click",function(){return i.setActiveTab("estado")}),e._uU(24," Estado "),e.qZA(),e.TgZ(25,"button",15),e.NdJ("click",function(){return i.setActiveTab("historial")}),e._uU(26," Historial de Activaciones "),e.qZA(),e.TgZ(27,"button",15),e.NdJ("click",function(){return i.setActiveTab("detalles")}),e._uU(28," Detalles del Plan "),e.qZA()()()(),e.TgZ(29,"div",16),e.YNc(30,oe,81,17,"div",17)(31,ae,20,2,"div",17)(32,re,48,1,"div",17),e.TgZ(33,"div",18)(34,"button",19),e.NdJ("click",function(){return i.onDescargarLicencia()}),e._UZ(35,"i",20),e._uU(36," Descargar Licencia "),e.qZA()()()()),2&o&&(e.xp6(5),e.Q6J("ngIf",i.licenseData.entidad.logo),e.xp6(5),e.Oqu(i.licenseData.entidad.nombre_entidad),e.xp6(4),e.Oqu(i.licenseData.numero_licencia),e.xp6(4),e.Oqu(i.licenseData.entidad.codigo_entidad),e.xp6(5),e.ekj("active","estado"===i.activeTab),e.xp6(2),e.ekj("active","historial"===i.activeTab),e.xp6(2),e.ekj("active","detalles"===i.activeTab),e.xp6(3),e.Q6J("ngIf","estado"===i.activeTab),e.xp6(1),e.Q6J("ngIf","historial"===i.activeTab),e.xp6(1),e.Q6J("ngIf","detalles"===i.activeTab))},dependencies:[_.ez,_.mk,_.sg,_.O5,A.QW,C.Cv,y],styles:['@charset "UTF-8";.license-container{max-width:1024px;margin:0 auto;padding:24px;background-color:#f9fafb;min-height:100vh}.license-card,.content-card{background:white;border-radius:8px;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb}.license-card{margin-bottom:24px}.header-section{padding:32px;border-bottom:1px solid #f3f4f6}.header-content{display:flex;justify-content:space-between;align-items:flex-start}.title-section{display:flex;align-items:flex-start;gap:20px}.logo-section{flex-shrink:0}.entity-logo{width:80px;height:80px;object-fit:contain;border-radius:8px;border:1px solid #e5e7eb;background-color:#fff}.text-section{flex:1}.text-section h1.main-title{font-size:32px;font-weight:700;color:#111827;margin:0 0 8px}.text-section h2.subtitle{font-size:20px;color:#374151;margin:0 0 8px}.license-number,.entity-code{color:#6b7280;margin:0 0 4px}.license-code{font-family:Courier New,monospace;font-weight:500}.btn-renovar{background-color:#2563eb;color:#fff;padding:12px 24px;border:none;border-radius:8px;font-weight:500;cursor:pointer;transition:background-color .2s;margin-top:68px}.btn-renovar:hover{background-color:#1d4ed8}.tabs-container{padding:0 32px}.tabs-nav{display:flex;gap:32px;border-bottom:1px solid #e5e7eb}.tab-button{padding:16px 8px;border:none;background:none;border-bottom:2px solid transparent;font-weight:500;font-size:14px;color:#6b7280;cursor:pointer;transition:all .2s}.tab-button:hover{color:#374151}.tab-button.active{border-bottom-color:#2563eb;color:#2563eb}.content-section{padding:32px}.status-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:24px;margin-bottom:32px}.status-card{background-color:#f9fafb;border-radius:8px;padding:24px}.status-header{display:flex;align-items:center;gap:12px;margin-bottom:8px}.status-label{font-size:14px;color:#6b7280;font-weight:500}.status-value{font-size:18px;font-weight:600;color:#111827;margin:0}.status-badge{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:20px;font-size:14px;font-weight:500;width:-moz-fit-content;width:fit-content}.status-active{color:#065f46;background-color:#ecfdf5}.status-warning{color:#92400e;background-color:#fffbeb}.status-danger{color:#991b1b;background-color:#fef2f2}.days-remaining-card{background:linear-gradient(135deg,#dbeafe 0%,#e0e7ff 100%);border-radius:8px;padding:24px;margin-bottom:32px;border:1px solid #bfdbfe}.days-content{text-align:center}.days-number{font-size:48px;font-weight:700;color:#2563eb;margin-bottom:8px}.days-label{color:#1e40af;font-weight:500}.details-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:32px}.section-title{font-size:18px;font-weight:600;color:#111827;margin:0 0 16px}.details-list{display:flex;flex-direction:column;gap:12px}.detail-item{display:flex;justify-content:space-between}.detail-label{color:#6b7280}.detail-value{font-weight:500;color:#111827}.detail-code{font-family:Courier New,monospace}.observaciones-card{margin-top:32px;padding:16px;background-color:#dbeafe;border-radius:8px;border:1px solid #bfdbfe}.observaciones-title{font-weight:500;color:#1e40af;margin:0 0 8px}.observaciones-text{color:#1e3a8a;margin:0}.historial-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:32px}.table-container{overflow:hidden;border-radius:8px;border:1px solid #e5e7eb}.data-table{width:100%;border-collapse:collapse}.data-table thead{background-color:#f9fafb}.data-table th{padding:12px 16px;text-align:left;font-size:12px;font-weight:500;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.table-row:hover{background-color:#f9fafb}.table-cell{padding:12px 16px;font-size:14px;color:#111827;border-top:1px solid #e5e7eb}.table-code{font-family:Courier New,monospace}.usuarios-list{display:flex;flex-direction:column;gap:16px}.usuario-card{display:flex;align-items:center;gap:12px;padding:16px;background-color:#f9fafb;border-radius:8px}.usuario-info p{margin:0}.usuario-email{font-weight:500;color:#111827}.usuario-fecha{font-size:14px;color:#6b7280}.detalles-container{max-width:512px}.plan-sections{display:flex;flex-direction:column;gap:24px}.caracteristicas-card{background:linear-gradient(135deg,#ecfdf5 0%,#d1fae5 100%);border-radius:8px;padding:24px;border:1px solid #bbf7d0}.caracteristicas-title{font-weight:600;color:#065f46;margin:0 0 12px}.caracteristicas-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}.caracteristica-item{display:flex;align-items:center;gap:8px;color:#047857}.tecnica-card{background-color:#dbeafe;border-radius:8px;padding:24px;border:1px solid #bfdbfe}.tecnica-title{font-weight:600;color:#1e40af;margin:0 0 12px}.tecnica-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.tecnica-item{color:#1e3a8a}.tecnica-label{font-weight:500;margin:0 0 4px}.tecnica-value{margin:0}.download-section{padding:16px 32px;border-top:1px solid #f3f4f6;background-color:#f9fafb}.btn-download{display:flex;align-items:center;gap:8px;color:#2563eb;background:none;border:none;font-weight:500;cursor:pointer;transition:color .2s}.btn-download:hover{color:#1d4ed8}.icon-calendar:before{content:"\\1f4c5"}.icon-clock:before{content:"\\23f0"}.icon-shield:before{content:"\\1f6e1"}.icon-check-circle:before{content:"\\2705"}.icon-alert-circle:before{content:"\\26a0\\fe0f"}.icon-user:before{content:"\\1f464"}.icon-download:before{content:"\\2b07\\fe0f"}@media (max-width: 768px){.license-container{padding:16px}.header-content{flex-direction:column;gap:16px}.title-section{flex-direction:column;text-align:center}.entity-logo{width:60px;height:60px}.header-section,.content-section{padding:24px 16px}.tabs-container{padding:0 16px}.tabs-nav{gap:16px;overflow-x:auto}.status-grid,.details-grid,.historial-grid{grid-template-columns:1fr}.days-number{font-size:36px}}\n'],encapsulation:2})}return n})();function se(n,a){1&n&&(e.TgZ(0,"div",11),e._UZ(1,"div",12),e.qZA())}function le(n,a){if(1&n&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.importStatus)}}function de(n,a){1&n&&(e.TgZ(0,"div",14),e._UZ(1,"div",15),e.qZA())}function pe(n,a){if(1&n&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.exportStatus)}}function ge(n,a){1&n&&(e.TgZ(0,"div",16),e._UZ(1,"div",17),e.qZA())}function ue(n,a){if(1&n&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.restoreStatus)}}let me=(()=>{class n{constructor(){this.selectedFile=null,this.importInProgress=!1,this.importStatus=null,this.exportInProgress=!1,this.exportStatus=null,this.restoreInProgress=!1,this.restoreStatus=null}onFileSelected(t){const o=t.target;o.files&&o.files.length>0&&(this.selectedFile=o.files[0],this.importStatus=null)}importDatabase(){this.selectedFile?(this.importInProgress=!0,this.importStatus=null,setTimeout(()=>{this.importInProgress=!1,this.importStatus="Importaci\xf3n completada con \xe9xito.",this.selectedFile=null},3e3)):this.importStatus="Por favor, seleccione un archivo para importar."}exportDatabase(){this.exportInProgress=!0,this.exportStatus=null,setTimeout(()=>{this.exportInProgress=!1,this.exportStatus="Exportaci\xf3n completada con \xe9xito."},3e3)}restoreDatabase(){this.restoreInProgress=!0,this.restoreStatus=null,setTimeout(()=>{this.restoreInProgress=!1,this.restoreStatus="Restauraci\xf3n completada con \xe9xito."},3e3)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-bd"]],standalone:!0,features:[e.jDz],decls:23,vars:7,consts:[[1,"flex","flex-col","flex-auto","min-w-0","p-6","sm:p-10","space-y-8"],[1,"bg-white","dark:bg-gray-800","shadow","rounded-lg","p-6"],[1,"text-xl","font-semibold","mb-4"],["type","file","accept",".sql,.json,.zip",1,"mb-4","block","w-full","text-sm","text-gray-500","file:mr-4","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-blue-50","file:text-blue-700","hover:file:bg-blue-100","dark:file:bg-gray-700","dark:file:text-gray-300","dark:hover:file:bg-gray-600",3,"change"],[1,"px-6","py-2","bg-blue-600","text-white","rounded","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled","click"],["class","mt-2 h-2 bg-blue-200 rounded overflow-hidden",4,"ngIf"],["class","mt-2 text-sm text-gray-700 dark:text-gray-300",4,"ngIf"],[1,"px-6","py-2","bg-green-600","text-white","rounded","hover:bg-green-700",3,"click"],["class","mt-2 h-2 bg-green-200 rounded overflow-hidden",4,"ngIf"],[1,"px-6","py-2","bg-red-600","text-white","rounded","hover:bg-red-700",3,"click"],["class","mt-2 h-2 bg-red-200 rounded overflow-hidden",4,"ngIf"],[1,"mt-2","h-2","bg-blue-200","rounded","overflow-hidden"],[1,"h-2","bg-blue-600","animate-pulse","w-full"],[1,"mt-2","text-sm","text-gray-700","dark:text-gray-300"],[1,"mt-2","h-2","bg-green-200","rounded","overflow-hidden"],[1,"h-2","bg-green-600","animate-pulse","w-full"],[1,"mt-2","h-2","bg-red-200","rounded","overflow-hidden"],[1,"h-2","bg-red-600","animate-pulse","w-full"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Importar Base de Datos"),e.qZA(),e.TgZ(4,"input",3),e.NdJ("change",function(g){return i.onFileSelected(g)}),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.importDatabase()}),e._uU(6," Importar "),e.qZA(),e.YNc(7,se,2,0,"div",5)(8,le,2,1,"p",6),e.qZA(),e.TgZ(9,"div",1)(10,"h2",2),e._uU(11,"Exportar Base de Datos"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return i.exportDatabase()}),e._uU(13," Exportar "),e.qZA(),e.YNc(14,de,2,0,"div",8)(15,pe,2,1,"p",6),e.qZA(),e.TgZ(16,"div",1)(17,"h2",2),e._uU(18,"Restaurar Base de Datos"),e.qZA(),e.TgZ(19,"button",9),e.NdJ("click",function(){return i.restoreDatabase()}),e._uU(20," Restaurar "),e.qZA(),e.YNc(21,ge,2,0,"div",10)(22,ue,2,1,"p",6),e.qZA()()),2&o&&(e.xp6(5),e.Q6J("disabled",!i.selectedFile),e.xp6(2),e.Q6J("ngIf",i.importInProgress),e.xp6(1),e.Q6J("ngIf",i.importStatus),e.xp6(6),e.Q6J("ngIf",i.exportInProgress),e.xp6(1),e.Q6J("ngIf",i.exportStatus),e.xp6(6),e.Q6J("ngIf",i.restoreInProgress),e.xp6(1),e.Q6J("ngIf",i.restoreStatus))},dependencies:[_.ez,_.O5,A.QW,C.Cv]})}return n})();var s=l(6223),M=l(2296),q=l(4170),J=l(617),L=l(4516),F=l(1476),I=l(3566),T=l(5313),z=l(2596),Q=l(8525),_e=l(5619),fe=l(8645),he=l(7174),B=l(3680);function be(n,a){if(1&n&&(e.TgZ(0,"div",41),e._UZ(1,"img",42),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("src",t.dataSource.data[0].logo,e.LSH)("alt",t.dataSource.data[0].nombre_entidad)}}function xe(n,a){if(1&n&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.getInitials(t.dataSource.data[0].nombre_entidad)," ")}}function ve(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",44)(1,"button",45),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.openAddEntidadDialog())}),e.TgZ(2,"mat-icon"),e._uU(3,"add"),e.qZA()()()}}function Ze(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6)(4,"h1",7),e._uU(5,"Mi Entidad"),e.qZA(),e.TgZ(6,"div",8)(7,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleEditMode(!0))}),e.TgZ(8,"mat-icon",10),e._uU(9,"edit"),e.qZA(),e._uU(10," Editar "),e.qZA(),e.TgZ(11,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.goBack())}),e.TgZ(12,"mat-icon"),e._uU(13,"close"),e.qZA()()()(),e.TgZ(14,"div",12)(15,"div",13)(16,"div",14)(17,"div",15)(18,"div",16),e.YNc(19,be,2,2,"div",17)(20,xe,2,1,"ng-template",null,18,e.W1O),e.qZA()()(),e.TgZ(22,"h2",19),e._uU(23),e.qZA(),e.TgZ(24,"div",20)(25,"div",21)(26,"mat-icon",22),e._uU(27,"business"),e.qZA(),e._uU(28),e.qZA(),e.TgZ(29,"div",23)(30,"mat-icon",22),e._uU(31,"location_city"),e.qZA(),e._uU(32),e.qZA(),e.TgZ(33,"div",24)(34,"mat-icon",22),e._uU(35),e.qZA(),e._uU(36),e.qZA()()(),e.TgZ(37,"div",25)(38,"div",26)(39,"div",27)(40,"mat-icon",28),e._uU(41,"account_balance"),e.qZA()(),e.TgZ(42,"div")(43,"p",29),e._uU(44,"Ministerio"),e.qZA(),e.TgZ(45,"p",30),e._uU(46),e.qZA()()(),e.TgZ(47,"div",26)(48,"div",31)(49,"mat-icon",32),e._uU(50,"phone"),e.qZA()(),e.TgZ(51,"div")(52,"p",29),e._uU(53,"Tel\xe9fono"),e.qZA(),e.TgZ(54,"p",30),e._uU(55),e.qZA()()(),e.TgZ(56,"div",26)(57,"div",33)(58,"mat-icon",34),e._uU(59,"location_on"),e.qZA()(),e.TgZ(60,"div")(61,"p",29),e._uU(62,"Ubicaci\xf3n"),e.qZA(),e.TgZ(63,"p",30),e._uU(64),e.qZA()()(),e.TgZ(65,"div",35)(66,"div",36)(67,"mat-icon",37),e._uU(68,"home"),e.qZA()(),e.TgZ(69,"div")(70,"p",29),e._uU(71,"Domicilio Legal"),e.qZA(),e.TgZ(72,"p",30),e._uU(73),e.qZA()()(),e.TgZ(74,"div",26)(75,"div",38)(76,"mat-icon",39),e._uU(77,"calendar_today"),e.qZA()(),e.TgZ(78,"div")(79,"p",29),e._uU(80,"Fecha de Registro"),e.qZA(),e.TgZ(81,"p",30),e._uU(82),e.qZA()()()()(),e.YNc(83,ve,4,0,"div",40),e.qZA()(),e.BQk()}if(2&n){const t=e.MAs(21),o=e.oxw(2);e.xp6(19),e.Q6J("ngIf",o.dataSource.data[0].logo)("ngIfElse",t),e.xp6(4),e.hij(" ",o.dataSource.data[0].nombre_entidad," "),e.xp6(5),e.hij(" ",o.dataSource.data[0].codigo_entidad," "),e.xp6(4),e.hij(" ",o.dataSource.data[0].tipo_empresa," "),e.xp6(1),e.ekj("bg-green-50",o.dataSource.data[0].activo)("text-green-700",o.dataSource.data[0].activo)("bg-red-50",!o.dataSource.data[0].activo)("text-red-700",!o.dataSource.data[0].activo),e.xp6(2),e.hij(" ",o.dataSource.data[0].activo?"check_circle":"cancel"," "),e.xp6(1),e.hij(" ",o.dataSource.data[0].activo?"Activa":"Inactiva"," "),e.xp6(10),e.Oqu(o.dataSource.data[0].ministerio),e.xp6(9),e.Oqu(o.dataSource.data[0].telefonos),e.xp6(9),e.AsE("",null==o.dataSource.data[0].municipio?null:o.dataSource.data[0].municipio.nombre_municipio,", ",null==o.dataSource.data[0].provincia?null:o.dataSource.data[0].provincia.nombre_provincia,""),e.xp6(9),e.Oqu(o.dataSource.data[0].domicilio_legal),e.xp6(9),e.Oqu(o.formatDate(o.dataSource.data[0].createdAt)),e.xp6(1),e.Q6J("ngIf",o.canAddEntidad())}}function Te(n,a){if(1&n&&(e.TgZ(0,"div",41),e._UZ(1,"img",42),e.qZA()),2&n){const t=e.oxw(3);let o,i;e.xp6(1),e.Q6J("src",null==(o=t.contactForm.get("logo"))?null:o.value,e.LSH)("alt",null==(i=t.contactForm.get("nombre"))?null:i.value)}}function Ce(n,a){if(1&n&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);let o;e.xp6(1),e.hij(" ",t.getInitials((null==(o=t.contactForm.get("nombre"))?null:o.value)||"E")," ")}}function ye(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es requerido "),e.qZA())}function Ae(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El c\xf3digo es requerido "),e.qZA())}function we(n,a){if(1&n&&(e.TgZ(0,"mat-option",69),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Ue(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El tipo de empresa es requerido "),e.qZA())}function Ee(n,a){if(1&n&&(e.TgZ(0,"mat-option",69),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ke(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El ministerio es requerido "),e.qZA())}function qe(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El tel\xe9fono es requerido "),e.qZA())}function De(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La provincia es requerida "),e.qZA())}function Pe(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El municipio es requerido "),e.qZA())}function Me(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El domicilio legal es requerido "),e.qZA())}function Se(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6)(4,"h1",7),e._uU(5,"Editar Entidad"),e.qZA(),e.TgZ(6,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleEditMode(!1))}),e.TgZ(7,"mat-icon"),e._uU(8,"close"),e.qZA()()(),e.TgZ(9,"div",12)(10,"form",46)(11,"div",47)(12,"div",15)(13,"div",16)(14,"div",48)(15,"input",49,50),e.NdJ("change",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.uploadLogo(i.target.files))}),e.qZA(),e.TgZ(17,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(16);return e.KtG(i.click())}),e.TgZ(18,"mat-icon"),e._uU(19,"camera_alt"),e.qZA()(),e.TgZ(20,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.removeLogo())}),e.TgZ(21,"mat-icon"),e._uU(22,"delete"),e.qZA()()(),e.YNc(23,Te,2,2,"div",17)(24,Ce,2,1,"ng-template",null,52,e.W1O),e.qZA()()(),e.TgZ(26,"div",53)(27,"mat-form-field",54)(28,"mat-label"),e._uU(29,"Nombre de la Entidad"),e.qZA(),e._UZ(30,"input",55),e.YNc(31,ye,2,0,"mat-error",3),e.qZA(),e.TgZ(32,"mat-form-field",54)(33,"mat-label"),e._uU(34,"C\xf3digo de la Entidad"),e.qZA(),e._UZ(35,"input",56),e.YNc(36,Ae,2,0,"mat-error",3),e.qZA(),e.TgZ(37,"mat-form-field",54)(38,"mat-label"),e._uU(39,"Tipo de Empresa"),e.qZA(),e.TgZ(40,"mat-select",57),e.YNc(41,we,2,2,"mat-option",58),e.qZA(),e.YNc(42,Ue,2,0,"mat-error",3),e.qZA(),e.TgZ(43,"mat-form-field",54)(44,"mat-label"),e._uU(45,"Ministerio"),e.qZA(),e.TgZ(46,"mat-select",57),e.YNc(47,Ee,2,2,"mat-option",58),e.qZA(),e.YNc(48,ke,2,0,"mat-error",3),e.qZA(),e.TgZ(49,"mat-form-field",54)(50,"mat-label"),e._uU(51,"Tel\xe9fonos"),e.qZA(),e._UZ(52,"input",59),e.YNc(53,qe,2,0,"mat-error",3),e.qZA(),e.TgZ(54,"mat-form-field",54)(55,"mat-label"),e._uU(56,"Provincia"),e.qZA(),e._UZ(57,"input",60),e.YNc(58,De,2,0,"mat-error",3),e.qZA(),e.TgZ(59,"mat-form-field",54)(60,"mat-label"),e._uU(61,"Municipio"),e.qZA(),e._UZ(62,"input",61),e.YNc(63,Pe,2,0,"mat-error",3),e.qZA(),e.TgZ(64,"mat-form-field",54)(65,"mat-label"),e._uU(66,"Domicilio Legal"),e.qZA(),e._UZ(67,"textarea",62),e.YNc(68,Me,2,0,"mat-error",3),e.qZA(),e.TgZ(69,"div",26)(70,"mat-slide-toggle",63),e._uU(71," Entidad Activa "),e.qZA()()(),e.TgZ(72,"div",64)(73,"button",65),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.deleteEntidad(i.dataSource.data[0]))}),e.TgZ(74,"mat-icon",10),e._uU(75,"delete"),e.qZA(),e._uU(76," Eliminar "),e.qZA(),e.TgZ(77,"div",66)(78,"button",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleEditMode(!1))}),e._uU(79," Cancelar "),e.qZA(),e.TgZ(80,"button",68),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.saveEntidad())}),e.TgZ(81,"mat-icon",10),e._uU(82,"save"),e.qZA(),e._uU(83," Guardar "),e.qZA()()()()()()(),e.BQk()}if(2&n){const t=e.MAs(25),o=e.oxw(2);let i,r,g,P,H,K,$,V,W;e.xp6(10),e.Q6J("formGroup",o.contactForm),e.xp6(13),e.Q6J("ngIf",null==(i=o.contactForm.get("logo"))?null:i.value)("ngIfElse",t),e.xp6(7),e.Q6J("formControlName","nombre"),e.xp6(1),e.Q6J("ngIf",null==(r=o.contactForm.get("nombre"))?null:r.hasError("required")),e.xp6(4),e.Q6J("formControlName","codigo"),e.xp6(1),e.Q6J("ngIf",null==(g=o.contactForm.get("codigo"))?null:g.hasError("required")),e.xp6(4),e.Q6J("formControlName","tipo_empresa"),e.xp6(1),e.Q6J("ngForOf",o.tiposEmpresa),e.xp6(1),e.Q6J("ngIf",null==(P=o.contactForm.get("tipo_empresa"))?null:P.hasError("required")),e.xp6(4),e.Q6J("formControlName","ministerio"),e.xp6(1),e.Q6J("ngForOf",o.ministerios),e.xp6(1),e.Q6J("ngIf",null==(H=o.contactForm.get("ministerio"))?null:H.hasError("required")),e.xp6(4),e.Q6J("formControlName","telefonos"),e.xp6(1),e.Q6J("ngIf",null==(K=o.contactForm.get("telefonos"))?null:K.hasError("required")),e.xp6(4),e.Q6J("formControlName","provincia"),e.xp6(1),e.Q6J("ngIf",null==($=o.contactForm.get("provincia"))?null:$.hasError("required")),e.xp6(4),e.Q6J("formControlName","municipio"),e.xp6(1),e.Q6J("ngIf",null==(V=o.contactForm.get("municipio"))?null:V.hasError("required")),e.xp6(4),e.Q6J("formControlName","domicilio_legal"),e.xp6(1),e.Q6J("ngIf",null==(W=o.contactForm.get("domicilio_legal"))?null:W.hasError("required")),e.xp6(2),e.Q6J("formControlName","activo"),e.xp6(10),e.Q6J("disabled",o.contactForm.invalid)}}function Ie(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",2),e.YNc(2,Ze,84,22,"ng-container",3)(3,Se,84,23,"ng-container",3),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.editMode),e.xp6(1),e.Q6J("ngIf",t.editMode)}}function Oe(n,a){}let Fe=(()=>{class n{constructor(t,o,i,r,g){this.entidadService=t,this.catalogService=o,this._cdr=i,this.fb=r,this._document=g,this.displayedColumns=["id","nombre","codigo","domicilio_legal","telefonos","tipo_empresa","municipio","actions"],this.dataSource=new T.by,this._entidadesSubject=new _e.X([]),this.entidades$=this._entidadesSubject.asObservable(),this.isLoading=!1,this.error="",this.serverPagination={total:0,currentPage:1,totalPages:0,limit:50},this.pagination={length:0,page:0,size:10},this.editMode=!1,this.selectedEntidad=null,this.tiposEmpresa=["Empresa Estatal","Empresa Mixta","Empresa Privada","Cooperativa","Organizaci\xf3n"],this.ministerios=["MINCIN","MINAG","MINSAP","MINED","MININT","MINFAR"],this._unsubscribeAll=new fe.x,this.contactForm=this.fb.group({nombre:["",s.kI.required],codigo:["",s.kI.required],tipo_empresa:["",s.kI.required],ministerio:["",s.kI.required],telefonos:["",s.kI.required],provincia:["",s.kI.required],municipio:["",s.kI.required],domicilio_legal:["",s.kI.required],activo:[!0],logo:[null]})}ngOnInit(){this.initializeForm(),this.loadEntidades()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}initializeForm(){this.contactForm=this.fb.group({id:[null],nombre:["",s.kI.required],codigo:["",s.kI.required],domicilio_legal:["",s.kI.required],telefonos:["",s.kI.required],tipo_empresa:["",s.kI.required],ministerio:["",s.kI.required],municipio:["",s.kI.required],provincia:["",s.kI.required],activo:[!0],logo:[null],director_id:[null]})}loadEntidades(){this.isLoading=!0,this.error="",console.log("Iniciando carga de entidades..."),this.loadCatalogos(),this.entidadService.getLogs().subscribe({next:t=>{console.log("Respuesta completa del servicio:",t);try{let o=[];if(t&&t.data)Array.isArray(t.data)?(o=t.data,console.log("Datos encontrados en response.data (array):",o)):"object"==typeof t.data&&null!==t.data&&(o=[t.data],console.log("Datos encontrados en response.data (objeto \xfanico):",o)),t.pagination&&(this.serverPagination={total:t.pagination.total,currentPage:t.pagination.page,totalPages:t.pagination.pages,limit:t.pagination.limit});else if(Array.isArray(t))o=t,console.log("Datos encontrados directamente en response:",o);else{if("object"!=typeof t||null===t)return console.error("Estructura de datos no reconocida:",t),this.error="No se encontraron datos de entidades",this.isLoading=!1,void this._cdr.markForCheck();o=[t],console.log("Datos encontrados directamente en response (objeto \xfanico):",o)}if(console.log("Datos a transformar:",o),0===o.length)console.log("No hay entidades para mostrar"),this._entidadesSubject.next([]),this.dataSource.data=[],this.pagination.length=0;else{const i=this.transformApiData(o);console.log("Datos transformados:",i),this._entidadesSubject.next(i),this.dataSource.data=i,this.pagination.length=i.length,setTimeout(()=>{this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort)})}}catch(o){console.error("Error procesando datos:",o),this.error="Error procesando los datos del servidor"}this.isLoading=!1,this._cdr.markForCheck()},error:t=>{console.error("Error al cargar entidades:",t),this.error="Error al cargar las entidades del servidor",this.isLoading=!1,this._cdr.markForCheck()}})}loadCatalogos(){this.catalogService.getTiposEmpresa().subscribe({next:t=>{console.log("Tipos de empresa:",t),t&&Array.isArray(t)&&(this.tiposEmpresa=t.map(o=>o.nombre||o)),this._cdr.markForCheck()},error:t=>console.error("Error cargando tipos de empresa:",t)}),this.catalogService.getMinisterios().subscribe({next:t=>{console.log("Ministerios:",t),t&&Array.isArray(t)&&(this.ministerios=t.map(o=>o.nombre||o)),this._cdr.markForCheck()},error:t=>console.error("Error cargando ministerios:",t)}),this.catalogService.getProvincias().subscribe({next:t=>{console.log("Provincias:",t),this._cdr.markForCheck()},error:t=>console.error("Error cargando provincias:",t)}),this.catalogService.getMunicipios().subscribe({next:t=>{console.log("Municipios:",t),this._cdr.markForCheck()},error:t=>console.error("Error cargando municipios:",t)})}transformApiData(t){return console.log("Transformando datos API:",t),t.map(o=>{console.log("Transformando item:",o);const i={id:1,nombre_provincia:o.provincia||"Sin provincia"},g={id:o.id,municipio_id:1,nombre_entidad:o.nombre,codigo_entidad:o.codigo,domicilio_legal:o.domicilio_legal,telefonos:o.telefonos,logo:o.logo,tipo_empresa:o.tipo_empresa,ministerio:o.ministerio,activo:o.activo,director_id:o.director_id,createdAt:o.createdAt,updatedAt:o.updatedAt,provincia:i,municipio:{id:1,nombre_municipio:o.municipio||"Sin municipio",provincia_id:1,provincia:i}};return console.log("Item transformado:",g),g})}openEditEntidadDialog(t){this.editMode=!0,this.selectedEntidad=t,this.contactForm.patchValue({id:t.id,nombre:t.nombre_entidad,codigo:t.codigo_entidad,domicilio_legal:t.domicilio_legal,telefonos:t.telefonos,tipo_empresa:t.tipo_empresa,ministerio:t.ministerio,municipio:t.municipio?.nombre_municipio||"",provincia:t.provincia?.nombre_provincia||"",activo:t.activo,logo:t.logo,director_id:t.director_id}),this._cdr.markForCheck()}saveEntidad(){if(this.contactForm.invalid)return;const t=this.contactForm.value;this.editMode&&this.selectedEntidad?this.updateEntidad(t):this.createEntidad(t)}createEntidad(t){console.log("Crear entidad:",t);const o={id:1,nombre_provincia:t.provincia},i={id:1,nombre_municipio:t.municipio,provincia_id:1,provincia:o},r={id:Date.now(),municipio_id:1,nombre_entidad:t.nombre,codigo_entidad:t.codigo,domicilio_legal:t.domicilio_legal,telefonos:t.telefonos,logo:t.logo,tipo_empresa:t.tipo_empresa,ministerio:t.ministerio,activo:t.activo,director_id:t.director_id,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),provincia:o,municipio:i},P=[...this._entidadesSubject.getValue(),r];this._entidadesSubject.next(P),this.dataSource.data=P,this.pagination.length=P.length,this.cancelEdit()}updateEntidad(t){if(!this.selectedEntidad)return;console.log("Actualizar entidad:",t);const o=this._entidadesSubject.getValue(),i=o.findIndex(r=>r.id===this.selectedEntidad.id);if(-1!==i){const r={id:1,nombre_provincia:t.provincia},g={id:1,nombre_municipio:t.municipio,provincia_id:1,provincia:r};o[i]={...o[i],nombre_entidad:t.nombre,codigo_entidad:t.codigo,domicilio_legal:t.domicilio_legal,telefonos:t.telefonos,tipo_empresa:t.tipo_empresa,ministerio:t.ministerio,activo:t.activo,logo:t.logo,director_id:t.director_id,updatedAt:(new Date).toISOString(),provincia:r,municipio:g},this._entidadesSubject.next([...o]),this.dataSource.data=o}this.cancelEdit()}cancelEdit(){this.editMode=!1,this.selectedEntidad=null,this.contactForm.reset(),this._cdr.markForCheck()}deleteEntidad(t){if(confirm(`\xbfEst\xe1 seguro de que desea eliminar la entidad "${t.nombre_entidad}"?`)){console.log("Eliminar entidad:",t.id);const i=this._entidadesSubject.getValue().filter(r=>r.id!==t.id);this._entidadesSubject.next(i),this.dataSource.data=i,this.pagination.length=i.length,this._cdr.markForCheck()}}canAddEntidad(){return!1}trackByFn(t,o){return o.id||t}uploadLogo(t){if(!t||!t[0])return;const o=t[0];if(!o.type.startsWith("image/"))return void alert("Por favor seleccione un archivo de imagen v\xe1lido");if(o.size>5242880)return void alert("El archivo es demasiado grande. M\xe1ximo 5MB");const i=new FileReader;i.onload=()=>{this.contactForm.get("logo")?.setValue(i.result),this.contactForm.markAsDirty(),this._cdr.markForCheck()},i.readAsDataURL(o)}removeLogo(){this.contactForm.get("logo").setValue(null),this.contactForm.markAsDirty(),this._cdr.markForCheck()}openAddEntidadDialog(){this.editMode=!1,this.selectedEntidad=null,this.contactForm.reset(),this.contactForm.patchValue({activo:!0,nombre:"",codigo:"",tipo_empresa:"",ministerio:"",telefonos:"",provincia:"",municipio:"",domicilio_legal:"",logo:null,director_id:null}),this.contactForm.markAsPristine(),this.contactForm.markAsUntouched(),this._cdr.markForCheck()}toggleEditMode(t){if(this.editMode=t,t&&this.dataSource.data.length>0){const o=this.dataSource.data[0];this.selectedEntidad=o,this.contactForm.patchValue({id:o.id,nombre:o.nombre_entidad,codigo:o.codigo_entidad,domicilio_legal:o.domicilio_legal,telefonos:o.telefonos,tipo_empresa:o.tipo_empresa,ministerio:o.ministerio,municipio:o.municipio?.nombre_municipio||"",provincia:o.provincia?.nombre_provincia||"",activo:o.activo,logo:o.logo,director_id:o.director_id})}else this.selectedEntidad=null,this.contactForm.reset(),this.contactForm.patchValue({activo:!0});this._cdr.markForCheck()}getInitials(t){if(!t)return"E";const o=t.split(" ");return 1===o.length?o[0].charAt(0).toUpperCase():(o[0].charAt(0)+o[o.length-1].charAt(0)).toUpperCase()}formatDate(t){return t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):""}goBack(){this.editMode?this.toggleEditMode(!1):console.log("Navegando hacia atr\xe1s...")}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(j),e.Y36(he.a),e.Y36(e.sBO),e.Y36(s.qu),e.Y36(_.K0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-entidad-list"]],viewQuery:function(o,i){if(1&o&&(e.Gf(F.NW,5),e.Gf(I.YE,5)),2&o){let r;e.iGM(r=e.CRH())&&(i.paginator=r.first),e.iGM(r=e.CRH())&&(i.sort=r.first)}},standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["multipleEntities",""],[1,"flex","flex-col","w-full"],[4,"ngIf"],[1,"min-h-screen","bg-gray-50","py-8","px-4"],[1,"max-w-2xl","mx-auto"],[1,"flex","justify-between","items-center","mb-8"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"flex","items-center","space-x-4"],["mat-flat-button","","color","primary",1,"px-6",3,"click"],[1,"mr-2"],["mat-icon-button","",1,"w-10","h-10",3,"click"],[1,"bg-white","rounded-2xl","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"px-8","py-8","text-center"],[1,"flex","justify-center","mb-6"],[1,"relative"],[1,"w-24","h-24","rounded-full","bg-gray-200","flex","items-center","justify-center","overflow-hidden"],["class","w-full h-full",4,"ngIf","ngIfElse"],["noLogo",""],[1,"text-2xl","font-semibold","text-gray-900","mb-2"],[1,"flex","flex-wrap","gap-2","justify-center","mb-8"],[1,"flex","items-center","bg-blue-50","text-blue-700","px-3","py-1","rounded-full","text-sm"],[1,"w-4","h-4","mr-1",2,"font-size","16px"],[1,"flex","items-center","bg-green-50","text-green-700","px-3","py-1","rounded-full","text-sm"],[1,"flex","items-center","px-3","py-1","rounded-full","text-sm"],[1,"px-8","pb-8","space-y-6"],[1,"flex","items-center"],[1,"w-8","h-8","bg-blue-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-blue-600","w-5","h-5",2,"font-size","18px"],[1,"text-sm","text-gray-500"],[1,"text-gray-900","font-medium"],[1,"w-8","h-8","bg-green-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-green-600","w-5","h-5",2,"font-size","18px"],[1,"w-8","h-8","bg-purple-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-purple-600","w-5","h-5",2,"font-size","18px"],[1,"flex","items-start"],[1,"w-8","h-8","bg-orange-100","rounded-full","flex","items-center","justify-center","mr-4","mt-1"],[1,"text-orange-600","w-5","h-5",2,"font-size","18px"],[1,"w-8","h-8","bg-gray-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-gray-600","w-5","h-5",2,"font-size","18px"],["class","fixed bottom-8 right-8",4,"ngIf"],[1,"w-full","h-full"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"text-gray-600","text-2xl","font-medium"],[1,"fixed","bottom-8","right-8"],["mat-fab","","color","primary","matTooltip","Agregar nueva entidad",3,"click"],[1,"p-8",3,"formGroup"],[1,"flex","justify-center","mb-8"],[1,"absolute","inset-0","bg-black","bg-opacity-50","opacity-0","hover:opacity-100","transition-opacity","duration-200","flex","items-center","justify-center","space-x-2"],["id","logo-file-input","type","file","accept","image/*",1,"hidden",3,"change"],["logoFileInput",""],["type","button","mat-icon-button","",1,"text-white",3,"click"],["noLogoEdit",""],[1,"space-y-6"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Nombre de la entidad",3,"formControlName"],["matInput","","placeholder","C\xf3digo \xfanico",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","N\xfamero de tel\xe9fono",3,"formControlName"],["matInput","","placeholder","Provincia",3,"formControlName"],["matInput","","placeholder","Municipio",3,"formControlName"],["matInput","","placeholder","Direcci\xf3n completa","rows","3",3,"formControlName"],["color","primary",3,"formControlName"],[1,"flex","justify-between","items-center","mt-8","pt-6","border-t"],["type","button","mat-button","","color","warn",3,"click"],[1,"flex","space-x-4"],["type","button","mat-button","",3,"click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(o,i){if(1&o&&e.YNc(0,Ie,4,2,"ng-container",0)(1,Oe,0,0,"ng-template",null,1,e.W1O),2&o){const r=e.MAs(2);e.Q6J("ngIf",1===i.dataSource.data.length)("ngIfElse",r)}},dependencies:[_.ez,_.sg,_.O5,M.ot,M.lW,M.RK,M.cs,C.Cv,I.JX,T.p0,J.Ps,J.Hw,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,F.TU,q.lN,q.KE,q.hX,q.TO,L.c,L.Nt,z.AV,z.gM,Q.LD,Q.gD,B.ey],styles:[".custom-top-offset{top:75px}\n"],encapsulation:2,changeDetection:0})}return n})();var Y=l(217);let Ne=(()=>{class n{constructor(t){this.http=t,this.log=[]}getLogs(){return this.http.get(k.P.LOGS.BASE).pipe((0,v.b)(t=>console.log("log fetched:",t)),(0,Z.K)(t=>(console.error("Error fetching contratos:",t),(0,x.of)([...this.log]))))}logsdelete(){return this.http.delete(k.P.LOGS.DELETE_ALL).pipe((0,v.b)(t=>console.log("log fetched:",t)),(0,Z.K)(t=>(console.error("Error fetching contratos:",t),(0,x.of)([...this.log]))))}exportToExcel(){return this.http.post(k.P.LOGS.EXPORT_EXCEL,{},{responseType:"blob"}).pipe((0,v.b)(t=>console.log("Excel export initiated")),(0,Z.K)(t=>(console.error("Error exporting logs to Excel:",t),(0,x.of)(new Blob))))}exportToPDF(){return this.http.post(k.P.LOGS.EXPORT_PDF,{},{responseType:"blob"}).pipe((0,v.b)(t=>console.log("PDF export initiated")),(0,Z.K)(t=>(console.error("Error exporting logs to PDF:",t),(0,x.of)(new Blob))))}static#e=this.\u0275fac=function(o){return new(o||n)(e.LFG(R.eN))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Je(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"div",20),e._UZ(3,"i",21),e.TgZ(4,"input",22),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.searchTerm=i)})("input",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSearchChange())}),e.qZA()(),e.TgZ(5,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.toggleFilters())}),e._UZ(6,"i",24),e._uU(7," Filtros "),e.qZA()(),e.TgZ(8,"div",25),e._uU(9),e.TgZ(10,"span",26),e._uU(11),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.searchTerm),e.xp6(1),e.ekj("active",t.showFilters),e.xp6(4),e.AsE(" Mostrando ",t.filteredLogs.length," de ",t.logs.length," registros locales "),e.xp6(2),e.hij("(",t.serverPagination.total," total en servidor)")}}function Le(n,a){if(1&n&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function Qe(n,a){if(1&n&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function Re(n,a){if(1&n&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function je(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",27)(1,"div",28)(2,"div",29)(3,"label"),e._uU(4,"Usuario"),e.qZA(),e.TgZ(5,"select",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filterUser=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onFilterChange())}),e.TgZ(6,"option",31),e._uU(7,"Todos los usuarios"),e.qZA(),e.YNc(8,Le,2,2,"option",32),e.qZA()(),e.TgZ(9,"div",29)(10,"label"),e._uU(11,"Tabla"),e.qZA(),e.TgZ(12,"select",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filterTable=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onFilterChange())}),e.TgZ(13,"option",31),e._uU(14,"Todas las tablas"),e.qZA(),e.YNc(15,Qe,2,2,"option",32),e.qZA()(),e.TgZ(16,"div",29)(17,"label"),e._uU(18,"Acci\xf3n"),e.qZA(),e.TgZ(19,"select",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filterAction=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onFilterChange())}),e.TgZ(20,"option",31),e._uU(21,"Todas las acciones"),e.qZA(),e.YNc(22,Re,2,2,"option",32),e.qZA()(),e.TgZ(23,"div",29)(24,"button",33),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearFilters())}),e._uU(25," Limpiar filtros "),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.filterUser),e.xp6(3),e.Q6J("ngForOf",t.uniqueUsers),e.xp6(4),e.Q6J("ngModel",t.filterTable),e.xp6(3),e.Q6J("ngForOf",t.uniqueTables),e.xp6(4),e.Q6J("ngModel",t.filterAction),e.xp6(3),e.Q6J("ngForOf",t.uniqueActions)}}function ze(n,a){1&n&&(e.TgZ(0,"div",35),e._UZ(1,"div",36),e.TgZ(2,"p"),e._uU(3,"Cargando logs del sistema..."),e.qZA()())}function Be(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",37),e._UZ(1,"i",38),e.TgZ(2,"h3"),e._uU(3,"Error al cargar los logs"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.qZA(),e.TgZ(6,"button",39),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.refresh())}),e._uU(7," Reintentar "),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.error)}}function Ye(n,a){if(1&n&&(e.TgZ(0,"tr",48)(1,"td",49),e._uU(2),e.qZA(),e.TgZ(3,"td",50)(4,"div",51)(5,"div",52),e._UZ(6,"i",42),e.qZA(),e._uU(7),e.qZA()(),e.TgZ(8,"td",53),e._uU(9),e.qZA(),e.TgZ(10,"td",54)(11,"span",55),e._uU(12),e.qZA()(),e.TgZ(13,"td",56)(14,"span",57),e._uU(15),e.qZA()()()),2&n){const t=a.$implicit,o=e.oxw(2);e.xp6(2),e.hij("#",t.id,""),e.xp6(5),e.hij(" ",t.usuario," "),e.xp6(2),e.Oqu(o.formatDate(t.fecha)),e.xp6(3),e.Oqu(t.tabla),e.xp6(2),e.Q6J("ngClass",o.getActionClass(t.accion)),e.xp6(1),e.hij(" ",t.accion," ")}}function Ge(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",66),e.NdJ("click",function(){const r=e.CHM(t).$implicit,g=e.oxw(3);return e.KtG(g.changePage(r))}),e._uU(1),e.qZA()}if(2&n){const t=a.$implicit,o=e.oxw(3);e.ekj("active",o.localCurrentPage===t),e.xp6(1),e.hij(" ",t," ")}}function He(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",58)(1,"div",59)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"div",60)(5,"button",61),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changePage(i.localCurrentPage-1))}),e._UZ(6,"i",62),e._uU(7," Anterior "),e.qZA(),e.TgZ(8,"div",63),e.YNc(9,Ge,2,3,"button",64),e.qZA(),e.TgZ(10,"button",61),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changePage(i.localCurrentPage+1))}),e._uU(11," Siguiente "),e._UZ(12,"i",65),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(3),e.lnq(" Mostrando ",t.getStartIndex()," a ",t.getEndIndex()," de ",t.filteredLogs.length," resultados filtrados "),e.xp6(2),e.Q6J("disabled",1===t.localCurrentPage),e.xp6(4),e.Q6J("ngForOf",t.getPagesArray()),e.xp6(1),e.Q6J("disabled",t.localCurrentPage===t.localTotalPages)}}function Ke(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",67)(1,"div",68)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"div",69)(5,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changeServerPage(i.serverPagination.currentPage-1))}),e._UZ(6,"i",62),e._uU(7," P\xe1gina Anterior "),e.qZA(),e.TgZ(8,"div",71)(9,"span"),e._uU(10),e.qZA()(),e.TgZ(11,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changeServerPage(i.serverPagination.currentPage+1))}),e._uU(12," P\xe1gina Siguiente "),e._UZ(13,"i",65),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(3),e.lnq(" P\xe1gina ",t.serverPagination.currentPage," de ",t.serverPagination.totalPages," del servidor (",t.serverPagination.total," registros totales) "),e.xp6(2),e.Q6J("disabled",1===t.serverPagination.currentPage),e.xp6(5),e.AsE("",t.serverPagination.currentPage," / ",t.serverPagination.totalPages,""),e.xp6(1),e.Q6J("disabled",t.serverPagination.currentPage===t.serverPagination.totalPages)}}function $e(n,a){if(1&n&&(e.TgZ(0,"div",40)(1,"table",41)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"ID"),e.qZA(),e.TgZ(6,"th"),e._UZ(7,"i",42),e._uU(8," Usuario "),e.qZA(),e.TgZ(9,"th"),e._UZ(10,"i",43),e._uU(11," Fecha "),e.qZA(),e.TgZ(12,"th"),e._UZ(13,"i",44),e._uU(14," Tabla "),e.qZA(),e.TgZ(15,"th"),e._UZ(16,"i",4),e._uU(17," Acci\xf3n "),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,Ye,16,6,"tr",45),e.qZA()(),e.YNc(20,He,13,6,"div",46)(21,Ke,14,7,"div",47),e.qZA()),2&n){const t=e.oxw();e.xp6(19),e.Q6J("ngForOf",t.paginatedLogs),e.xp6(1),e.Q6J("ngIf",t.localTotalPages>1),e.xp6(1),e.Q6J("ngIf",t.serverPagination.totalPages>1)}}function Ve(n,a){1&n&&(e.TgZ(0,"p"),e._uU(1," No hay logs que coincidan con los filtros aplicados. "),e.qZA())}function We(n,a){1&n&&(e.TgZ(0,"p"),e._uU(1,"No hay logs disponibles en esta p\xe1gina."),e.qZA())}function Xe(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clearFilters())}),e._uU(1," Limpiar filtros "),e.qZA()}}function et(n,a){if(1&n&&(e.TgZ(0,"div",72),e._UZ(1,"i",4),e.TgZ(2,"h3"),e._uU(3,"No se encontraron logs"),e.qZA(),e.YNc(4,Ve,2,0,"p",73)(5,We,2,0,"ng-template",null,74,e.W1O)(7,Xe,2,0,"button",75),e.qZA()),2&n){const t=e.MAs(6),o=e.oxw();e.xp6(4),e.Q6J("ngIf",o.searchTerm||o.filterUser||o.filterTable||o.filterAction)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",o.searchTerm||o.filterUser||o.filterTable||o.filterAction)}}let tt=(()=>{class n{constructor(t,o){this.logService=t,this.cdr=o,this.logs=[],this.loading=!0,this.error="",this.serverPagination={total:0,currentPage:1,totalPages:0,limit:50},this.searchTerm="",this.filterUser="",this.filterTable="",this.filterAction="",this.showFilters=!1,this.localCurrentPage=1,this.itemsPerPage=10,this.filteredLogs=[],this.paginatedLogs=[],this.uniqueUsers=[],this.uniqueTables=[],this.uniqueActions=[],this.localTotalPages=0}ngOnInit(){this.loadLogs()}loadLogs(t=1){this.loading=!0,this.error="",this.logService.getLogs().subscribe({next:o=>{if(console.log("Respuesta completa:",o),o&&o.data&&Array.isArray(o.data)){const i=o;this.serverPagination={total:i.pagination.total,currentPage:i.pagination.page,totalPages:i.pagination.pages,limit:i.pagination.limit},this.logs=this.transformApiData(i.data),this.calculateUniqueValues(),this.applyFilters()}else console.error("Estructura de datos inesperada:",o),this.error="Estructura de datos inesperada del servidor";this.loading=!1},error:o=>{console.error("Error al cargar logs:",o),this.error="Error al cargar los logs del sistema",this.loading=!1}})}transformApiData(t){return t.map(o=>{let i=this.extractTableFromDetails(o.details);return i||(i=this.extractTableFromDescription(o.description)),{id:o.id,usuario:`ID: ${o.user_id}`,fecha:new Date(o.createdAt),tabla:i,accion:this.mapActionToSpanish(o.action)}})}extractTableFromDetails(t){try{const o=JSON.parse(t);if(o.tipo)return o.tipo}catch{console.warn("No se pudo parsear details:",t)}return""}extractTableFromDescription(t){return t.includes("Catalogo")?"catalogo":t.includes("ministerios")?"ministerios":t.includes("municipios")?"municipios":"sistema"}mapActionToSpanish(t){return{consultar:"READ",crear:"CREATE",actualizar:"UPDATE",eliminar:"DELETE"}[t]||t.toUpperCase()}calculateUniqueValues(){this.uniqueUsers=[...new Set(this.logs.map(t=>t.usuario))],this.uniqueTables=[...new Set(this.logs.map(t=>t.tabla))],this.uniqueActions=[...new Set(this.logs.map(t=>t.accion))]}applyFilters(){this.filteredLogs=this.logs.filter(t=>(""===this.searchTerm||t.usuario.toLowerCase().includes(this.searchTerm.toLowerCase())||t.tabla.toLowerCase().includes(this.searchTerm.toLowerCase())||t.accion.toLowerCase().includes(this.searchTerm.toLowerCase()))&&(""===this.filterUser||t.usuario===this.filterUser)&&(""===this.filterTable||t.tabla===this.filterTable)&&(""===this.filterAction||t.accion===this.filterAction)),this.localTotalPages=Math.ceil(this.filteredLogs.length/this.itemsPerPage),this.localCurrentPage=Math.min(this.localCurrentPage,Math.max(1,this.localTotalPages)),this.updatePagination()}updatePagination(){const t=(this.localCurrentPage-1)*this.itemsPerPage;this.paginatedLogs=this.filteredLogs.slice(t,t+this.itemsPerPage)}onSearchChange(){this.localCurrentPage=1,this.applyFilters()}onFilterChange(){this.localCurrentPage=1,this.applyFilters()}toggleFilters(){this.showFilters=!this.showFilters}clearFilters(){this.searchTerm="",this.filterUser="",this.filterTable="",this.filterAction="",this.localCurrentPage=1,this.applyFilters()}changePage(t){t>=1&&t<=this.localTotalPages&&(this.localCurrentPage=t,this.updatePagination())}changeServerPage(t){t>=1&&t<=this.serverPagination.totalPages&&this.loadLogs(t)}getActionClass(t){switch(t){case"CREATE":return"action-create";case"READ":return"action-read";case"UPDATE":return"action-update";case"DELETE":return"action-delete";default:return"action-default"}}formatDate(t){return t.toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}getPagesArray(){return Array.from({length:this.localTotalPages},(t,o)=>o+1)}getStartIndex(){return(this.localCurrentPage-1)*this.itemsPerPage+1}getEndIndex(){return Math.min(this.localCurrentPage*this.itemsPerPage,this.filteredLogs.length)}refresh(){this.loadLogs(this.serverPagination.currentPage)}exportToExcel(){this.loading=!0,this.logService.exportToExcel().subscribe({next:t=>{(0,Y.saveAs)(t,"logs.xlsx"),this.loading=!1},error:()=>{this.loading=!1}})}exportToPDF(){this.loading=!0,this.logService.exportToPDF().subscribe({next:t=>{(0,Y.saveAs)(t,"logs.pdf"),this.loading=!1},error:()=>{this.loading=!1}})}deleteLogs(){this.loading=!0,this.logService.logsdelete().subscribe({next:()=>{this.loading=!1},error:()=>{this.loading=!1}})}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(Ne),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-system"]],standalone:!0,features:[e.jDz],decls:26,vars:10,consts:[[1,"logs-container"],[1,"header"],[1,"header-title"],[1,"title-section"],[1,"icon-activity"],[1,"action-buttons"],[1,"btn","btn-primary",3,"disabled","click"],[1,"icon-refresh"],[1,"btn","btn-success",3,"disabled","click"],[1,"icon-download"],[1,"btn","btn-danger",3,"disabled","click"],[1,"icon-trash"],["class","search-filters-section",4,"ngIf"],["class","filters-section",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","table-container",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"search-filters-section"],[1,"search-and-filter"],[1,"search-container"],[1,"icon-search"],["type","text","placeholder","Buscar logs...",1,"search-input",3,"ngModel","ngModelChange","input"],[1,"btn-filter",3,"click"],[1,"icon-filter"],[1,"results-count"],[1,"server-info"],[1,"filters-section"],[1,"filters-grid"],[1,"filter-group"],[3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-secondary","full-width",3,"click"],[3,"value"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[1,"icon-alert-circle"],[1,"btn","btn-primary",3,"click"],[1,"table-container"],[1,"logs-table"],[1,"icon-user"],[1,"icon-calendar"],[1,"icon-database"],["class","table-row",4,"ngFor","ngForOf"],["class","pagination-container",4,"ngIf"],["class","server-pagination-container",4,"ngIf"],[1,"table-row"],[1,"log-id"],[1,"log-user"],[1,"user-info"],[1,"user-avatar"],[1,"log-date"],[1,"log-table"],[1,"table-badge"],[1,"log-action"],[1,"action-badge",3,"ngClass"],[1,"pagination-container"],[1,"pagination-info"],[1,"pagination-controls"],[1,"btn-pagination",3,"disabled","click"],[1,"icon-chevron-left"],[1,"page-numbers"],["class","btn-page",3,"active","click",4,"ngFor","ngForOf"],[1,"icon-chevron-right"],[1,"btn-page",3,"click"],[1,"server-pagination-container"],[1,"server-pagination-info"],[1,"server-pagination-controls"],[1,"btn-pagination","server-btn",3,"disabled","click"],[1,"server-page-info"],[1,"empty-state"],[4,"ngIf","ngIfElse"],["noLogs",""],["class","btn btn-primary",3,"click",4,"ngIf"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"i",4),e.TgZ(5,"h1"),e._uU(6,"Logs del Sistema"),e.qZA()(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return i.refresh()}),e._UZ(9,"i",7),e._uU(10," Actualizar "),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.exportToExcel()}),e._UZ(12,"i",9),e._uU(13," Exportar a Excel "),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return i.exportToPDF()}),e._UZ(15,"i",9),e._uU(16," Exportar a PDF "),e.qZA(),e.TgZ(17,"button",10),e.NdJ("click",function(){return i.deleteLogs()}),e._UZ(18,"i",11),e._uU(19," Eliminar logs "),e.qZA()()(),e.YNc(20,Je,12,6,"div",12)(21,je,26,6,"div",13),e.qZA(),e.YNc(22,ze,4,0,"div",14)(23,Be,8,1,"div",15)(24,$e,22,3,"div",16)(25,et,8,3,"div",17),e.qZA()),2&o&&(e.xp6(8),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",i.showFilters&&!i.loading),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",i.error&&!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading&&!i.error),e.xp6(1),e.Q6J("ngIf",0===i.filteredLogs.length&&!i.loading&&!i.error))},dependencies:[_.ez,_.mk,_.sg,_.O5,s.u5,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.On],styles:['@charset "UTF-8";.logs-container[_ngcontent-%COMP%]{padding:1.5rem;width:100%;background-color:#f9fafb;min-height:100vh}.header[_ngcontent-%COMP%]{margin-bottom:2rem}.header-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:700;color:#111827;margin:0}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.btn-success[_ngcontent-%COMP%]{background-color:#16a34a;color:#fff}.btn-success[_ngcontent-%COMP%]:hover{background-color:#15803d}.btn-secondary[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}.search-filters-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;padding:1rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb}.search-and-filter[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem}.search-container[_ngcontent-%COMP%]{position:relative}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem .5rem 2.5rem;border:1px solid #d1d5db;border-radius:.5rem;width:16rem;font-size:.875rem}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.btn-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border:1px solid #d1d5db;background-color:#fff;border-radius:.5rem;cursor:pointer;transition:all .2s}.btn-filter[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-filter.active[_ngcontent-%COMP%]{background-color:#eff6ff;border-color:#93c5fd;color:#1d4ed8}.results-count[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.filters-section[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;padding-top:1rem}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.25rem}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:.875rem}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.full-width[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb;overflow:hidden}.logs-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.logs-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f9fafb;border-bottom:1px solid #e5e7eb}.logs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem 1.5rem;text-align:left;font-size:.75rem;font-weight:500;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.logs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.25rem}.logs-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6}.table-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.logs-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.5rem;font-size:.875rem}.log-id[_ngcontent-%COMP%]{font-weight:500;color:#111827}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.user-avatar[_ngcontent-%COMP%]{width:2rem;height:2rem;background-color:#dbeafe;border-radius:50%;display:flex;align-items:center;justify-content:center}.user-avatar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#2563eb}.table-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500;background-color:#f3f4f6;color:#374151;border:1px solid #e5e7eb}.action-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500;border:1px solid}.action-create[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534;border-color:#bbf7d0}.action-read[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af;border-color:#93c5fd}.action-update[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e;border-color:#fcd34d}.action-delete[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b;border-color:#fca5a5}.action-default[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151;border-color:#e5e7eb}.pagination-container[_ngcontent-%COMP%]{background-color:#fff;padding:.75rem 1.5rem;border-top:1px solid #e5e7eb;display:flex;align-items:center;justify-content:space-between}.pagination-info[_ngcontent-%COMP%]{font-size:.875rem;color:#374151}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.btn-pagination[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;padding:.5rem .75rem;font-size:.875rem;font-weight:500;border:1px solid #d1d5db;background-color:#fff;border-radius:.375rem;cursor:pointer;transition:all .2s}.btn-pagination[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f9fafb}.btn-pagination[_ngcontent-%COMP%]:disabled{color:#9ca3af;cursor:not-allowed}.page-numbers[_ngcontent-%COMP%]{display:flex;gap:.25rem}.btn-page[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.875rem;font-weight:500;border:1px solid #d1d5db;background-color:#fff;border-radius:.375rem;cursor:pointer;transition:all .2s}.btn-page[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-page.active[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff;border-color:#2563eb}.empty-state[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb;padding:2rem;text-align:center}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;color:#9ca3af;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:500;color:#111827;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:1rem}.icon-activity[_ngcontent-%COMP%]:before{content:"\\26a1"}.icon-refresh[_ngcontent-%COMP%]:before{content:"\\1f504"}.icon-download[_ngcontent-%COMP%]:before{content:"\\2b07\\fe0f"}.icon-search[_ngcontent-%COMP%]:before{content:"\\1f50d";position:absolute;left:.75rem;top:50%;transform:translateY(-50%);color:#9ca3af}.icon-filter[_ngcontent-%COMP%]:before{content:"\\1f53d"}.icon-user[_ngcontent-%COMP%]:before{content:"\\1f464"}.icon-calendar[_ngcontent-%COMP%]:before{content:"\\1f4c5"}.icon-database[_ngcontent-%COMP%]:before{content:"\\1f5c3\\fe0f"}.icon-chevron-left[_ngcontent-%COMP%]:before{content:"\\25c0"}.icon-chevron-right[_ngcontent-%COMP%]:before{content:"\\25b6"}@media (max-width: 768px){.logs-container[_ngcontent-%COMP%]{padding:1rem}.header-title[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.search-and-filter[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.logs-table[_ngcontent-%COMP%]{font-size:.75rem}.logs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .logs-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}.pagination-container[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}}']})}return n})();var ot=l(3620),N=l(7988),G=l(5986),nt=l(4065),it=l(1892);const at=["columnMenuTrigger"];function rt(n,a){1&n&&(e.TgZ(0,"div",27),e._UZ(1,"mat-progress-bar",28),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode","indeterminate"))}function ct(n,a){1&n&&(e.TgZ(0,"th",43),e._uU(1,"#"),e.qZA())}function st(n,a){if(1&n&&(e.TgZ(0,"td",44),e._uU(1),e.qZA()),2&n){const t=a.index;e.oxw();const o=e.MAs(14);e.xp6(1),e.hij(" ",((null==o?null:o.pageIndex)||0)*((null==o?null:o.pageSize)||10)+t+1," ")}}function lt(n,a){if(1&n&&(e.TgZ(0,"th",48),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("mat-sort-header",t.key)("matTooltip",t.tooltip),e.xp6(1),e.hij(" ",t.label," ")}}function dt(n,a){if(1&n&&(e.TgZ(0,"td",49),e._uU(1),e.qZA()),2&n){const t=a.$implicit,o=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.hij(" ",i.getColumnValue(t,o.key)," ")}}function pt(n,a){1&n&&(e.ynx(0,45),e.YNc(1,lt,2,3,"th",46)(2,dt,2,1,"td",47),e.BQk()),2&n&&e.Q6J("matColumnDef",a.$implicit.key)}function gt(n,a){1&n&&(e.TgZ(0,"th",50),e._uU(1,"Acciones"),e.qZA())}function ut(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",51)(1,"button",52),e.NdJ("click",function(){const r=e.CHM(t).$implicit,g=e.oxw(2);return e.KtG(g.toggleDetails(r))}),e._UZ(2,"mat-icon",53),e.qZA()()}if(2&n){const t=a.$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("svgIcon",o.isRowSelected(t)?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down")}}function mt(n,a){1&n&&e._UZ(0,"tr",54)}function _t(n,a){1&n&&e._UZ(0,"tr",55)}function ft(n,a){1&n&&e.GkF(0)}const ht=n=>({$implicit:n});function bt(n,a){if(1&n&&(e.TgZ(0,"tr",56)(1,"td",57),e.YNc(2,ft,1,0,"ng-container",58),e.qZA()()),2&n){const t=a.$implicit,o=e.oxw(2),i=e.MAs(45);e.ekj("expanded",(null==o.selectedRow?null:o.selectedRow.id)===t.id),e.xp6(1),e.uIk("colspan",o.displayedColumns.length),e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(5,ht,t))}}const xt=()=>["detail"],vt=()=>[5,10,25,50,100];function Zt(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",29)(2,"table",30),e.ynx(3,31),e.YNc(4,ct,2,0,"th",32)(5,st,2,1,"td",33),e.BQk(),e.YNc(6,pt,3,1,"ng-container",34),e.ynx(7,35),e.YNc(8,gt,2,0,"th",36)(9,ut,3,1,"td",37),e.BQk(),e.YNc(10,mt,1,0,"tr",38)(11,_t,1,0,"tr",39)(12,bt,3,7,"tr",40),e.qZA()(),e._UZ(13,"mat-paginator",41,42),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("dataSource",t.dataSource),e.xp6(4),e.Q6J("ngForOf",t.getVisibleColumns()),e.xp6(4),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(10,xt)),e.xp6(1),e.Q6J("length",t.dataSource.data.length)("pageSize",10)("pageSizeOptions",e.DdM(11,vt))("showFirstLastButtons",!0)}}function Tt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",59),e._UZ(1,"mat-icon",60),e.TgZ(2,"div",61),e._uU(3,"\xa1No hay departamentos!"),e.qZA(),e.TgZ(4,"p",62),e._uU(5,"Comienza agregando tu primer departamento al sistema"),e.qZA(),e.TgZ(6,"button",63),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openNewDepartamentoDialog())}),e._UZ(7,"mat-icon",11),e.TgZ(8,"span",64),e._uU(9,"Agregar Departamento"),e.qZA()()()}2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:building-office"),e.xp6(6),e.Q6J("svgIcon","heroicons_outline:plus"))}function Ct(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",65),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(1,"mat-checkbox",66),e.NdJ("change",function(){const r=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.toggleColumn(r.key))})("click",function(i){return i.stopPropagation()}),e._uU(2),e.qZA()()}if(2&n){const t=a.$implicit;e.xp6(1),e.Q6J("checked",t.visible)("color","primary"),e.xp6(1),e.hij(" ",t.label," ")}}function yt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",67)(1,"div",68)(2,"form",69)(3,"div",70)(4,"h3",71),e._uU(5," Detalles del Departamento "),e.qZA(),e.TgZ(6,"button",72),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeDetails())}),e._UZ(7,"mat-icon",11),e.qZA()(),e.TgZ(8,"div",73)(9,"mat-form-field",74)(10,"mat-label"),e._uU(11,"Nombre del Departamento"),e.qZA(),e._UZ(12,"input",75)(13,"mat-icon",76),e.qZA(),e.TgZ(14,"mat-form-field",74)(15,"mat-label"),e._uU(16,"C\xf3digo"),e.qZA(),e._UZ(17,"input",77)(18,"mat-icon",76),e.qZA(),e.TgZ(19,"mat-form-field",74)(20,"mat-label"),e._uU(21,"Director"),e.qZA(),e._UZ(22,"input",78)(23,"mat-icon",76),e.qZA(),e.TgZ(24,"mat-form-field",74)(25,"mat-label"),e._uU(26,"Email"),e.qZA(),e._UZ(27,"input",79)(28,"mat-icon",76),e.qZA(),e.TgZ(29,"mat-form-field",74)(30,"mat-label"),e._uU(31,"Tel\xe9fono"),e.qZA(),e._UZ(32,"input",80)(33,"mat-icon",76),e.qZA(),e.TgZ(34,"mat-form-field",74)(35,"mat-label"),e._uU(36,"Estado"),e.qZA(),e.TgZ(37,"mat-select",81)(38,"mat-option",82),e._uU(39,"Activo"),e.qZA(),e.TgZ(40,"mat-option",83),e._uU(41,"Inactivo"),e.qZA()()()(),e.TgZ(42,"mat-form-field",74)(43,"mat-label"),e._uU(44,"Descripci\xf3n"),e.qZA(),e._UZ(45,"textarea",84)(46,"mat-icon",76),e.qZA(),e.TgZ(47,"div",85)(48,"button",86),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteSelectedRecord())}),e._UZ(49,"mat-icon",87),e._uU(50," Eliminar "),e.qZA(),e.TgZ(51,"div",88)(52,"button",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeDetails())}),e._uU(53," Cancelar "),e.qZA(),e.TgZ(54,"button",90),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateSelectedRecord())}),e._UZ(55,"mat-icon",87),e._uU(56," Actualizar "),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.selectedRowForm),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(6),e.Q6J("svgIcon","heroicons_outline:building-office"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:hashtag"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:user"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:envelope"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:phone"),e.xp6(13),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:trash"),e.xp6(6),e.Q6J("svgIcon","heroicons_outline:check")}}const At=[{path:"entidad",component:Fe},{path:"trabajadores",loadChildren:()=>l.e(389).then(l.bind(l,9389)).then(n=>n.TrabajadoresModule)},{path:"departamentos",component:(()=>{class n{constructor(t,o,i){this.departamentoService=t,this.cdr=o,this.exportService=i,this.columnSettings=[{key:"nombre_departamento",label:"Nombre",visible:!0,tooltip:"Nombre del departamento"},{key:"codigo",label:"C\xf3digo",visible:!0,tooltip:"C\xf3digo del departamento"},{key:"descripcion",label:"Descripci\xf3n",visible:!0,tooltip:"Descripci\xf3n del departamento"},{key:"director",label:"Director",visible:!1,tooltip:"Director del departamento"},{key:"estado",label:"Estado",visible:!0,tooltip:"Estado del departamento"},{key:"fecha_creacion",label:"Fecha Creaci\xf3n",visible:!1,tooltip:"Fecha de creaci\xf3n"},{key:"ministerio",label:"Ministerio",visible:!1,tooltip:"Ministerio al que pertenece"},{key:"presupuesto_anual",label:"Presupuesto",visible:!1,tooltip:"Presupuesto anual"},{key:"telefono",label:"Tel\xe9fono",visible:!1,tooltip:"Tel\xe9fono del departamento"}],this.displayedColumns=[],this.dataSource=new T.by([]),this.searchInputControl=new s.NI,this.selectedRow=null,this.isLoading=!1,this.selectedRowForm=new s.cw({id:new s.NI(""),nombre_departamento:new s.NI(""),codigo:new s.NI(""),descripcion:new s.NI(""),director:new s.NI(""),estado:new s.NI(""),fecha_creacion:new s.NI(""),ministerio:new s.NI(""),presupuesto_anual:new s.NI(""),telefono:new s.NI("")})}ngOnInit(){this.updateDisplayedColumns(),this.isLoading=!0,this.departamentoService.getDepartamentos().subscribe(t=>{this.dataSource.data=t.data,this.isLoading=!1,this.cdr.detectChanges()}),this.dataSource.filterPredicate=(t,o)=>{if(!o)return!0;const i=o.toLowerCase().split(" ").filter(g=>g.length>0),r=[t.nombre_departamento,t.codigo,t.descripcion].join(" ").toLowerCase();return i.every(g=>r.includes(g))},this.searchInputControl.valueChanges.pipe((0,ot.b)(300)).subscribe(t=>{this.dataSource.filter=t.trim().toLowerCase(),this.closeDetails()})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.cdr.detectChanges()}getVisibleColumns(){return this.columnSettings.filter(t=>t.visible)}updateDisplayedColumns(){this.displayedColumns=["index",...this.getVisibleColumns().map(t=>t.key),"actions"]}toggleColumn(t){const o=this.columnSettings.find(i=>i.key===t);o&&(o.visible=!o.visible,this.updateDisplayedColumns(),this.cdr.detectChanges())}getColumnValue(t,o){switch(o){case"estado":return"activo"===t[o]?"Activo":"Inactivo";case"fecha_creacion":return t[o]?new Date(t[o]).toLocaleDateString():"-";case"presupuesto_anual":return t[o]?`$${Number(t[o]).toLocaleString()}`:"-";case"descripcion":return t[o]||"Sin descripci\xf3n";default:return t[o]||"-"}}isRowSelected(t){return!!this.selectedRow&&(this.selectedRow.id||this.selectedRow.nombre_departamento)===(t.id||t.nombre_departamento)}toggleDetails(t){const o=t.id||t.nombre_departamento;(this.selectedRow?.id||this.selectedRow?.nombre_departamento)===o?this.selectedRow=null:(this.selectedRow=t,this.selectedRowForm.patchValue(t))}closeDetails(){this.selectedRow=null}openNewDepartamentoDialog(){console.log("Open new departamento dialog")}updateSelectedRecord(){this.selectedRow&&this.selectedRowForm.valid&&console.log("Updating record:",this.selectedRowForm.value)}deleteSelectedRecord(){this.selectedRow&&console.log("Deleting record:",this.selectedRow)}exportToPDF(){const t=this.getVisibleColumns().map(i=>({key:i.key,label:i.label})),o=this.dataSource.filteredData.map(i=>{const r={};return t.forEach(g=>{r[g.key]=this.getColumnValue(i,g.key)}),r});this.exportService.exportToPDF(o,t,"Lista de Departamentos","departamentos")}exportToExcel(){const t=this.getVisibleColumns().map(i=>({key:i.key,label:i.label})),o=this.dataSource.filteredData.map(i=>{const r={};return t.forEach(g=>{r[g.key]=this.getColumnValue(i,g.key)}),r});this.exportService.exportToExcel(o,t,"departamentos")}print(){this.getFilteredData();const o=window.open("","_blank");o&&(o.document.close(),o.focus(),setTimeout(()=>{o.print(),o.close()},250))}getFilteredData(){return this.dataSource.filteredData?this.dataSource.filteredData:this.dataSource.data}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(nt._),e.Y36(e.sBO),e.Y36(it.T))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-departamento"]],viewQuery:function(o,i){if(1&o&&(e.Gf(F.NW,5),e.Gf(I.YE,5),e.Gf(at,5,N.p6)),2&o){let r;e.iGM(r=e.CRH())&&(i.paginator=r.first),e.iGM(r=e.CRH())&&(i.sort=r.first),e.iGM(r=e.CRH())&&(i.columnMenuTrigger=r.first)}},standalone:!0,features:[e.jDz],decls:46,vars:17,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","placeholder","Buscar departamentos",3,"formControl","autocomplete"],["mat-icon-button","","matTooltip","Configurar columnas",1,"ml-2",3,"matMenuTriggerFor","color"],["columnMenuTrigger","matMenuTrigger"],[3,"svgIcon"],["mat-icon-button","","matTooltip","Exportar",1,"ml-2",3,"matMenuTriggerFor"],["mat-flat-button","","color","primary",1,"ml-4",3,"click"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden"],[4,"ngIf","ngIfElse"],["noDepartments",""],[1,"column-menu"],["columnMenu","matMenu"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-300","border-b"],[1,"p-2",3,"click"],["class","flex items-center py-1 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",3,"click",4,"ngFor","ngForOf"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],["rowDetailsTemplate",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"min-w-full",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","class","w-16 text-center",4,"matHeaderCellDef"],["mat-cell","","class","w-16 text-center",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","","class","w-24 text-center",4,"matHeaderCellDef"],["mat-cell","","class","w-24 text-center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-150",4,"matRowDef","matRowDefColumns"],["mat-row","","class","expanded-row",3,"expanded",4,"matRowDef","matRowDefColumns"],[1,"border-t","bg-gray-50","dark:bg-transparent",3,"length","pageSize","pageSizeOptions","showFirstLastButtons"],["paginator",""],["mat-header-cell","",1,"w-16","text-center"],["mat-cell","",1,"w-16","text-center"],[3,"matColumnDef"],["mat-header-cell","","class","font-semibold",3,"mat-sort-header","matTooltip",4,"matHeaderCellDef"],["mat-cell","","class","truncate max-w-xs",4,"matCellDef"],["mat-header-cell","",1,"font-semibold",3,"mat-sort-header","matTooltip"],["mat-cell","",1,"truncate","max-w-xs"],["mat-header-cell","",1,"w-24","text-center"],["mat-cell","",1,"w-24","text-center"],["mat-stroked-button","","matTooltip","Ver detalles",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-header-row",""],["mat-row","",1,"hover:bg-gray-50","dark:hover:bg-gray-800","transition-colors","duration-150"],["mat-row","",1,"expanded-row"],[1,"p-0"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","flex-col","items-center","justify-center","py-16"],[1,"text-6xl","text-gray-400","mb-4",3,"svgIcon"],[1,"text-2xl","font-semibold","text-gray-600","mb-2"],[1,"text-gray-500","mb-6","text-center"],["mat-flat-button","","color","primary",3,"click"],[1,"ml-2"],[1,"flex","items-center","py-1","px-2","hover:bg-gray-100","dark:hover:bg-gray-700","rounded",3,"click"],[3,"checked","color","change","click"],[1,"bg-gray-50","dark:bg-gray-800","border-t"],[1,"p-6"],[1,"space-y-4",3,"formGroup"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-900","dark:text-gray-100"],["mat-icon-button","","matTooltip","Cerrar",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"w-full"],["matInput","","formControlName","nombre"],["matSuffix","",3,"svgIcon"],["matInput","","formControlName","codigo"],["matInput","","formControlName","director"],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","telefono"],["formControlName","estado"],["value","activo"],["value","inactivo"],["matInput","","formControlName","descripcion","rows","3"],[1,"flex","items-center","justify-between","pt-4","border-t"],["mat-button","","color","warn",1,"flex","items-center",3,"click"],[1,"mr-2",3,"svgIcon"],[1,"flex","space-x-2"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",1,"flex","items-center",3,"click"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,rt,2,1,"div",3),e.TgZ(4,"div",4),e._uU(5,"Departamentos"),e.qZA(),e.TgZ(6,"div",5)(7,"mat-form-field",6),e._UZ(8,"mat-icon",7)(9,"input",8),e.qZA(),e.TgZ(10,"button",9,10),e._UZ(12,"mat-icon",11),e.qZA(),e.TgZ(13,"button",12),e._UZ(14,"mat-icon",11),e.qZA(),e.TgZ(15,"button",13),e.NdJ("click",function(){return i.openNewDepartamentoDialog()}),e._UZ(16,"mat-icon",11),e.TgZ(17,"span",14),e._uU(18,"Agregar"),e.qZA()()()(),e.TgZ(19,"div",15)(20,"div",16),e.YNc(21,Zt,15,12,"ng-container",17)(22,Tt,10,2,"ng-template",null,18,e.W1O),e.qZA()()()(),e.TgZ(24,"mat-menu",19,20)(26,"div",21),e._uU(27," Mostrar Columnas "),e.qZA(),e.TgZ(28,"div",22),e.NdJ("click",function(g){return g.stopPropagation()}),e.YNc(29,Ct,3,3,"div",23),e.qZA()(),e.TgZ(30,"mat-menu",null,24)(32,"button",25),e.NdJ("click",function(){return i.exportToPDF()}),e._UZ(33,"mat-icon",11),e.TgZ(34,"span"),e._uU(35,"Exportar a PDF"),e.qZA()(),e.TgZ(36,"button",25),e.NdJ("click",function(){return i.exportToExcel()}),e._UZ(37,"mat-icon",11),e.TgZ(38,"span"),e._uU(39,"Exportar a Excel"),e.qZA()(),e.TgZ(40,"button",25),e.NdJ("click",function(){return i.print()}),e._UZ(41,"mat-icon",11),e.TgZ(42,"span"),e._uU(43,"Imprimir"),e.qZA()()(),e.YNc(44,yt,57,10,"ng-template",null,26,e.W1O)),2&o){const r=e.MAs(23),g=e.MAs(25),P=e.MAs(31);e.xp6(3),e.Q6J("ngIf",i.isLoading),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:magnifying-glass"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off"),e.xp6(1),e.Q6J("matMenuTriggerFor",g)("color","primary"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:view-columns"),e.xp6(1),e.Q6J("matMenuTriggerFor",P),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:arrow-down-tray"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",r),e.xp6(8),e.Q6J("ngForOf",i.columnSettings),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:table-cells"),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:printer")}},dependencies:[_.ez,_.sg,_.O5,_.tP,A.QW,T.p0,T.BZ,T.fO,T.as,T.w1,T.Dz,T.nj,T.ge,T.ev,T.XQ,T.Gk,F.TU,F.NW,I.JX,I.YE,I.nU,M.ot,M.lW,M.RK,J.Ps,J.Hw,q.lN,q.KE,q.hX,q.qo,q.R9,L.c,L.Nt,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.oH,s.sg,s.u,N.Tx,N.VK,N.OP,N.p6,G.p9,G.oG,Q.LD,Q.gD,B.ey]})}return n})()},{path:"log",component:tt},{path:"licencia",component:ce},{path:"bd",component:me}];let wt=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.oAB({type:n});static#o=this.\u0275inj=e.cJS({imports:[U.Bz.forChild(At),U.Bz]})}return n})()},1892:(O,D,l)=>{"use strict";l.d(D,{T:()=>C});var U=l(1388),_=l(5520),A=l(9212);let C=(()=>{class e{constructor(){}exportToPDF(c,u,f,d){if(!c||0===c.length)return void alert("No hay datos para exportar");const p=new U.ZP({orientation:"landscape",unit:"mm",format:"a4"});if(d){const b=new Image;b.src=d,b.onload=()=>{p.addImage(b,"JPEG",14,10,30,15),this.addPDFContent(p,c,u,f)},b.onerror=()=>{this.addPDFContent(p,c,u,f)}}else this.addPDFContent(p,c,u,f)}addPDFContent(c,u,f,d){c.setFontSize(16),c.setTextColor(40,40,40),c.text(d,50,20),c.setFontSize(10),c.setTextColor(100,100,100),c.text(`Fecha de generaci\xf3n: ${(new Date).toLocaleDateString("es-ES")}`,14,30),c.text(`Total de registros: ${u.length}`,14,35);const p=f.map(h=>h.label),b=u.map(h=>f.map(w=>this.formatValue(h[w.key])));(0,_.ZP)(c,{head:[p],body:b,startY:45,theme:"striped",styles:{fontSize:8,cellPadding:3,overflow:"linebreak",halign:"left"},headStyles:{fillColor:[41,128,185],textColor:[255,255,255],fontStyle:"bold",fontSize:9},margin:{top:45,left:14,right:14,bottom:20},didDrawPage:h=>{const w=c.getNumberOfPages(),y=c.internal.pageSize,x=y.height||y.getHeight();c.setFontSize(8),c.setTextColor(100,100,100),c.text(`P\xe1gina ${h.pageNumber} de ${w}`,14,x-10);const E="Sistema Contratacion",v=c.getTextWidth(E),Z=y.width||y.getWidth();c.text(E,Z-14-v,x-10)}});const m=`${d.toLowerCase().replace(/\s+/g,"_")}_export_${(new Date).toISOString().split("T")[0]}.pdf`;c.save(m)}exportToExcel(c,u,f){if(!c||0===c.length)return void alert("No hay datos para exportar");const d=[],p=u.map(y=>y.label);d.push(p.join(",")),c.forEach(y=>{const x=u.map(E=>{const v=this.formatValue(y[E.key]);return"string"==typeof v&&(v.includes(",")||v.includes('"'))?`"${v.replace(/"/g,'""')}"`:v});d.push(x.join(","))});const b=d.join("\n"),m=new Blob([b],{type:"text/csv;charset=utf-8;"}),h=window.URL.createObjectURL(m),w=document.createElement("a");w.href=h,w.download=f.endsWith(".csv")?f:`${f}.csv`,w.click(),window.URL.revokeObjectURL(h)}formatValue(c){return null==c?"":c instanceof Date?c.toLocaleDateString("es-ES"):"number"==typeof c?c.toLocaleString("es-ES"):c.toString()}static#e=this.\u0275fac=function(u){return new(u||e)};static#t=this.\u0275prov=A.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},217:function(O,D){var l,_;void 0!==(_="function"==typeof(l=function(){"use strict";function C(d,p,b){var m=new XMLHttpRequest;m.open("GET",d),m.responseType="blob",m.onload=function(){f(m.response,p,b)},m.onerror=function(){console.error("could not download file")},m.send()}function e(d){var p=new XMLHttpRequest;p.open("HEAD",d,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function S(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(p)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,u=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(d,p,b){var m=c.URL||c.webkitURL,h=document.createElement("a");h.download=p=p||d.name||"download",h.rel="noopener","string"==typeof d?(h.href=d,h.origin===location.origin?S(h):e(h.href)?C(d,p,b):S(h,h.target="_blank")):(h.href=m.createObjectURL(d),setTimeout(function(){m.revokeObjectURL(h.href)},4e4),setTimeout(function(){S(h)},0))}:"msSaveOrOpenBlob"in navigator?function(d,p,b){if(p=p||d.name||"download","string"!=typeof d)navigator.msSaveOrOpenBlob(function A(d,p){return typeof p>"u"?p={autoBom:!1}:"object"!=typeof p&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\ufeff",d],{type:d.type}):d}(d,b),p);else if(e(d))C(d,p,b);else{var m=document.createElement("a");m.href=d,m.target="_blank",setTimeout(function(){S(m)})}}:function(d,p,b,m){if((m=m||open("","_blank"))&&(m.document.title=m.document.body.innerText="downloading..."),"string"==typeof d)return C(d,p,b);var h="application/octet-stream"===d.type,w=/constructor/i.test(c.HTMLElement)||c.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||h&&w||u)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var Z=x.result;Z=y?Z:Z.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=Z:location=Z,m=null},x.readAsDataURL(d)}else{var E=c.URL||c.webkitURL,v=E.createObjectURL(d);m?m.location=v:location.href=v,m=null,setTimeout(function(){E.revokeObjectURL(v)},4e4)}});c.saveAs=f.saveAs=f,O.exports=f})?l.apply(D,[]):l)&&(O.exports=_)}}]);