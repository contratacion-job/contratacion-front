"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[590],{2590:(mt,A,a)=>{a.r(A),a.d(A,{ContratosRoutingModule:()=>ut});var k=a(8109),q=a(8297),p=a(3566),h=a(1476),T=a(5313),i=a(6223),F=a(3620),S=a(3997),I=a(9773),l=a(6814),g=a(2296),w=a(6007),v=a(617),d=a(4170),_=a(4516),b=a(8525),J=a(7988),R=a(6385),u=a(2246),y=a(7700),N=a(8660),Q=a(5099),U=a(8034),j=a(3680),t=a(9212);function P(n,s){if(1&n&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.nombre," ")}}function L(n,s){if(1&n&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.no_contrato," ")}}let O=(()=>{class n{constructor(e,o,r,c){this.fb=e,this.dialogRef=o,this.dialog=r,this.data=c,this.proveedores=[],this.contratos=[]}ngOnInit(){this.form=this.fb.group({proveedor:["",i.kI.required],contrato:["",i.kI.required],costo_cup:["",i.kI.required],costo_cl:["",i.kI.required],trabajo_ejecutado:["",i.kI.required],fecha_ejecucion:["",i.kI.required]})}openNewProveedorDialog(){this.dialog.open(N.d,{width:"40%",height:"60%",disableClose:!1}).afterClosed().subscribe(o=>{o&&this.proveedores.push(o)})}openNewContratoDialog(){this.dialog.open(Q._,{width:"40%",height:"90%",disableClose:!1}).afterClosed().subscribe(o=>{o&&this.contratos.push(o)})}save(){this.form.valid&&this.dialogRef.close(this.form.value)}cancel(){this.dialogRef.close()}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(i.qu),t.Y36(y.so),t.Y36(y.uw),t.Y36(y.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-suplemento-form"]],standalone:!0,features:[t.jDz],decls:46,vars:5,consts:[[1,"flex","flex-col","p-6","w-full"],[1,"text-2xl","font-bold","mb-6"],[1,"flex","flex-col","gap-4",3,"formGroup"],[1,"flex","items-center","gap-2"],[1,"flex-auto"],["formControlName","proveedor"],[3,"value",4,"ngFor","ngForOf"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],[1,"icon-size-5"],["formControlName","contrato"],["matInput","","type","number","formControlName","costo_cup"],["matInput","","type","number","formControlName","costo_cl"],["matInput","","formControlName","trabajo_ejecutado"],["matInput","","formControlName","fecha_ejecucion",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],[1,"flex","justify-end","gap-2"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"value"]],template:function(o,r){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"Agregar Ejecuci\xf3n"),t.qZA(),t.TgZ(3,"form",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),t._uU(7,"Proveedor"),t.qZA(),t.TgZ(8,"mat-select",5),t.YNc(9,P,2,2,"mat-option",6),t.qZA()(),t.TgZ(10,"button",7),t.NdJ("click",function(){return r.openNewProveedorDialog()}),t.TgZ(11,"mat-icon",8),t._uU(12,"add"),t.qZA()()(),t.TgZ(13,"div",3)(14,"mat-form-field",4)(15,"mat-label"),t._uU(16,"Contrato"),t.qZA(),t.TgZ(17,"mat-select",9),t.YNc(18,L,2,2,"mat-option",6),t.qZA()(),t.TgZ(19,"button",7),t.NdJ("click",function(){return r.openNewContratoDialog()}),t.TgZ(20,"mat-icon",8),t._uU(21,"add"),t.qZA()()(),t.TgZ(22,"mat-form-field")(23,"mat-label"),t._uU(24,"Costo (CUP)"),t.qZA(),t._UZ(25,"input",10),t.qZA(),t.TgZ(26,"mat-form-field")(27,"mat-label"),t._uU(28,"Costo (CL)"),t.qZA(),t._UZ(29,"input",11),t.qZA(),t.TgZ(30,"mat-form-field")(31,"mat-label"),t._uU(32,"Trabajo Ejecutado"),t.qZA(),t._UZ(33,"textarea",12),t.qZA(),t.TgZ(34,"mat-form-field")(35,"mat-label"),t._uU(36,"Fecha Ejecuci\xf3n"),t.qZA(),t._UZ(37,"input",13)(38,"mat-datepicker-toggle",14)(39,"mat-datepicker",null,15),t.qZA(),t.TgZ(41,"div",16)(42,"button",17),t.NdJ("click",function(){return r.cancel()}),t._uU(43,"Cancelar"),t.qZA(),t.TgZ(44,"button",18),t.NdJ("click",function(){return r.save()}),t._uU(45,"Guardar"),t.qZA()()()()),2&o){const c=t.MAs(40);t.xp6(3),t.Q6J("formGroup",r.form),t.xp6(6),t.Q6J("ngForOf",r.proveedores),t.xp6(9),t.Q6J("ngForOf",r.contratos),t.xp6(19),t.Q6J("matDatepicker",c),t.xp6(1),t.Q6J("for",c)}},dependencies:[l.ez,l.sg,i.UX,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u,d.lN,d.KE,d.hX,d.R9,_.c,_.Nt,g.ot,g.lW,b.LD,b.gD,j.ey,U.FA,U.Mq,U.hl,U.nW,j.XK,v.Ps,v.Hw]})}return n})();var D=a(8645),x=a(2096);let z=(()=>{class n{constructor(){}getEjecuciones(){return(0,x.of)(u.P_)}getEjecucionById(e){const o=u.P_.find(r=>r.id===e);return(0,x.of)(o)}addEjecucion(e){return u.P_.push(e),(0,x.of)(e)}updateEjecucion(e){const o=u.P_.findIndex(r=>r.id===e.id);return-1!==o&&(u.P_[o]=e),(0,x.of)(e)}deleteEjecucion(e){const o=u.P_.findIndex(r=>r.id===e);return-1!==o?(u.P_.splice(o,1),(0,x.of)(!0)):(0,x.of)(!1)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function M(n,s){1&n&&(t.TgZ(0,"div",23),t._UZ(1,"mat-progress-bar",24),t.qZA()),2&n&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function B(n,s){1&n&&t.GkF(0)}const Y=n=>({$implicit:n});function G(n,s){if(1&n&&(t.ynx(0),t.YNc(1,B,1,0,"ng-container",38),t.BQk()),2&n){const e=t.oxw().$implicit;t.oxw(2);const o=t.MAs(60);t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(2,Y,e))}}function V(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",31)(2,"div",32),t._uU(3),t.qZA(),t.TgZ(4,"div",32),t._uU(5),t.qZA(),t.TgZ(6,"div"),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.TgZ(9,"div"),t._uU(10),t.ALo(11,"currency"),t.qZA(),t.TgZ(12,"div",32),t._uU(13),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"div",33)(18,"button",34),t.NdJ("click",function(){const c=t.CHM(e).$implicit,f=t.oxw(2);return t.KtG(f.toggleDetails(c.id))}),t._UZ(19,"mat-icon",35),t.qZA()()(),t.TgZ(20,"div",36),t.YNc(21,G,2,4,"ng-container",37),t.qZA(),t.BQk()}if(2&n){const e=s.$implicit,o=t.oxw(2);t.xp6(3),t.hij(" ",(null==e.proveedor?null:e.proveedor.nombre)||"Sin proveedor"," "),t.xp6(2),t.hij(" ",(null==e.contrato?null:e.contrato.no_contrato)||"Sin contrato"," "),t.xp6(2),t.hij(" ",t.gM2(8,8,e.costo_cup,"CUP","symbol","1.2-2")," "),t.xp6(3),t.hij(" ",t.gM2(11,13,e.costo_cl,"CLP","symbol","1.2-2")," "),t.xp6(3),t.hij(" ",e.trabajo_ejecutado," "),t.xp6(2),t.hij(" ",t.xi3(16,18,e.fecha_ejecucion,"shortDate")," "),t.xp6(4),t.Q6J("svgIcon",(null==o.selectedRow?null:o.selectedRow.id)===e.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),t.xp6(2),t.Q6J("ngIf",(null==o.selectedRow?null:o.selectedRow.id)===e.id)}}const W=n=>({"pointer-events-none":n}),H=()=>[5,10,25,100];function K(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"div",25)(2,"div",26)(3,"div",27),t._uU(4,"Proveedor"),t.qZA(),t.TgZ(5,"div",27),t._uU(6,"Contrato"),t.qZA(),t.TgZ(7,"div",27),t._uU(8,"Costo (CUP)"),t.qZA(),t.TgZ(9,"div",27),t._uU(10,"Costo (CL)"),t.qZA(),t.TgZ(11,"div",27),t._uU(12,"Trabajo Ejecutado"),t.qZA(),t.TgZ(13,"div",27),t._uU(14,"Fecha Ejecuci\xf3n"),t.qZA(),t.TgZ(15,"div",28),t._uU(16,"Detalles"),t.qZA()(),t.YNc(17,V,22,21,"ng-container",29),t.qZA(),t._UZ(18,"mat-paginator",30),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("mat-sort-header","proveedor"),t.xp6(2),t.Q6J("mat-sort-header","contrato"),t.xp6(2),t.Q6J("mat-sort-header","costo_cup"),t.xp6(2),t.Q6J("mat-sort-header","costo_cl"),t.xp6(2),t.Q6J("mat-sort-header","trabajo_ejecutado"),t.xp6(2),t.Q6J("mat-sort-header","fecha_ejecucion"),t.xp6(4),t.Q6J("ngForOf",e.dataSource.filteredData)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngClass",t.VKq(14,W,e.isLoading))("length",e.pagination.length)("pageIndex",e.pagination.page)("pageSize",e.pagination.size)("pageSizeOptions",t.DdM(16,H))("showFirstLastButtons",!0)}}function X(n,s){if(1&n&&(t.TgZ(0,"mat-option",60),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.nombre," ")}}function $(n,s){if(1&n&&(t.TgZ(0,"mat-option",60),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.no_contrato," ")}}function tt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",39)(1,"div",40)(2,"form",41)(3,"div",42)(4,"div",43)(5,"div",44)(6,"mat-form-field",45)(7,"mat-label"),t._uU(8,"Proveedor"),t.qZA(),t.TgZ(9,"mat-select",46),t.YNc(10,X,2,2,"mat-option",47),t.qZA()(),t.TgZ(11,"mat-form-field",45)(12,"mat-label"),t._uU(13,"Contrato"),t.qZA(),t.TgZ(14,"mat-select",48),t.YNc(15,$,2,2,"mat-option",47),t.qZA()(),t.TgZ(16,"mat-form-field",45)(17,"mat-label"),t._uU(18,"Costo (CUP)"),t.qZA(),t.TgZ(19,"span",49),t._uU(20,"CUP"),t.qZA(),t._UZ(21,"input",50),t.qZA()(),t.TgZ(22,"div",51)(23,"mat-form-field",45)(24,"mat-label"),t._uU(25,"Costo (CL)"),t.qZA(),t.TgZ(26,"span",49),t._uU(27,"CLP"),t.qZA(),t._UZ(28,"input",52),t.qZA(),t.TgZ(29,"mat-form-field",45)(30,"mat-label"),t._uU(31,"Trabajo Ejecutado"),t.qZA(),t._UZ(32,"input",53),t.qZA(),t.TgZ(33,"mat-form-field",45)(34,"mat-label"),t._uU(35,"Fecha Ejecuci\xf3n"),t.qZA(),t._UZ(36,"input",54),t.qZA()()()(),t.TgZ(37,"div",55)(38,"button",56),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.deleteSelectedRecord())}),t.qZA(),t.TgZ(39,"div",57)(40,"button",58),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.updateSelectedRecord())}),t._uU(41," Actualizar "),t.qZA(),t.TgZ(42,"button",59),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.deleteSelectedRecord())}),t._uU(43," Eliminar "),t.qZA()()()()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.selectedRowForm),t.xp6(8),t.Q6J("ngForOf",e.mockProveedor),t.xp6(5),t.Q6J("ngForOf",e.mockContrato),t.xp6(23),t.Q6J("color","warn")}}function et(n,s){1&n&&(t.TgZ(0,"div",61),t._uU(1,"\xa1No hay ejecuciones!"),t.qZA())}let ot=(()=>{class n{constructor(e,o,r){this.ejecucionService=e,this.dialog=o,this.cdr=r,this.data=[],this.montoInicialCup=8e3,this.totalEjecutadoCup=6e3,this.montoRestanteCup=2e3,this.montoInicialUsd="-",this.totalEjecutadoUsd="-",this.montoRestanteUsd="-",this.columns=[{key:"proveedor",label:"Proveedor",nestedKey:"nombre",editable:!1,selectOptions:u.UB},{key:"contrato",label:"Contrato",nestedKey:"no_contrato",editable:!1,selectOptions:u.Io},{key:"costo_cup",label:"Costo (CUP)",type:"currency",editable:!0},{key:"costo_cl",label:"Costo (CL)",type:"currency",editable:!0},{key:"trabajo_ejecutado",label:"Trabajo Ejecutado",editable:!0},{key:"fecha_ejecucion",label:"Fecha Ejecuci\xf3n",type:"date",editable:!0}],this._unsubscribeAll=new D.x,this.title="Ejecuci\xf3n de Contratos",this.addButtonText="Agregar Ejecuci\xf3n",this.displayedColumns=[],this.searchInputControl=new i.NI(""),this.selectedRow=null,this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.dataSource=new T.by([]),this.selectedRowForm=new i.cw({})}ngOnInit(){this.displayedColumns=this.columns.map(e=>e.key).concat("details"),this.loadEjecuciones(),this.searchInputControl.valueChanges.pipe((0,F.b)(300),(0,S.x)(),(0,I.R)(this._unsubscribeAll)).subscribe(e=>{console.log("Search query:",e),this.dataSource.filter=e?.trim().toLowerCase()||"",console.log("Filtered data:",this.dataSource.filteredData),this.cdr.detectChanges(),this.dataSource._updateChangeSubscription()}),this.dataSource.filterPredicate=(e,o)=>Object.keys(e).reduce((c,f)=>c+(this.getNestedValue(e,f,this.columns.find(m=>m.key===f)?.nestedKey)||"")+" ","").toLowerCase().includes(o)}loadEjecuciones(){this.isLoading=!0,this.errorMessage="",this.ejecucionService.getEjecuciones().subscribe({next:e=>{this.data=e,this.dataSource.data=this.data,this.pagination.length=this.data.length,this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.isLoading=!1},error:e=>{this.errorMessage="Error loading ejecuciones",this.isLoading=!1}})}trackByFn(e,o){return o.id}getNestedValue(e,o,r){return r&&e[o]?e[o][r]:e[o]||""}toggleDetails(e){this.selectedRow=this.selectedRow?.id===e?null:this.data.find(o=>o.id===e),this.selectedRowForm=new i.cw({proveedor:new i.NI(this.selectedRow?.proveedor),contrato:new i.NI(this.selectedRow?.contrato),costo_cup:new i.NI(this.selectedRow?.costo_cup),costo_cl:new i.NI(this.selectedRow?.costo_cl),trabajo_ejecutado:new i.NI(this.selectedRow?.trabajo_ejecutado),fecha_ejecucion:new i.NI(this.selectedRow?.fecha_ejecucion)})}createRecord(){this.dialog.open(O,{width:"30%",height:"90%",disableClose:!1}).afterClosed().subscribe(o=>{o&&this.loadEjecuciones()})}updateSelectedRecord(){if(this.selectedRow&&this.selectedRowForm.valid){const e={...this.selectedRow,...this.selectedRowForm.value};this.ejecucionService.updateEjecucion(e).subscribe({next:o=>{this.loadEjecuciones()}})}}deleteSelectedRecord(){this.selectedRow&&this.ejecucionService.deleteEjecucion(this.selectedRow.id).subscribe({next:()=>{this.loadEjecuciones(),this.selectedRow=null}})}exportToCSV(){if(!this.dataSource.filteredData||0===this.dataSource.filteredData.length)return;const e=[];e.push(["Proveedor","Contrato","Costo (CUP)","Costo (CL)","Trabajo Ejecutado","Fecha Ejecuci\xf3n"].join(",")),this.dataSource.filteredData.forEach(m=>{const pt=[m.proveedor?.nombre||"",m.contrato?.no_contrato||"",m.costo_cup,m.costo_cl,m.trabajo_ejecutado||"",m.fecha_ejecucion||""].map(C=>"string"==typeof C&&(C.includes(",")||C.includes('"'))?`"${C.replace(/"/g,'""')}"`:C);e.push(pt.join(","))});const r=e.join("\n"),c=new Blob([r],{type:"text/csv;charset=utf-8;"}),f=window.URL.createObjectURL(c),Z=document.createElement("a");Z.href=f,Z.download="ejecuciones_export.csv",Z.click(),window.URL.revokeObjectURL(f)}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(z),t.Y36(y.uw),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-ejecucion-contrato"]],viewQuery:function(o,r){if(1&o&&(t.Gf(p.YE,5),t.Gf(h.NW,5)),2&o){let c;t.iGM(c=t.CRH())&&(r.sort=c.first),t.iGM(c=t.CRH())&&(r.paginator=c.first)}},standalone:!0,features:[t.jDz],decls:63,vars:28,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"flex","flex-row","flex-wrap","mt-4","-mx-6"],[1,"flex","flex-col","mx-6","my-3"],[1,"text-sm","font-medium","leading-none","text-secondary"],[1,"mt-2","font-medium","text-3xl","leading-none"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-col","sm:flex-row","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4","search-add-wrapper"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","mt-4","sm:mt-0","w-40","text-lg",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-icon-button","","matTooltip","Exportar tabla a CSV","aria-label","Exportar tabla a CSV",1,"ml-4","mt-4","sm:mt-0",3,"color","click"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["rowDetailsTemplate",""],["noEjecucionesTemplate",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"flex","flex-col","h-full","overflow-y-auto"],["matSort","","matSortDisableClear","",1,"inventory-grid","sticky","top-0","z-30","grid","gap-4","py-4","px-6","md:px-8","shadow-md","text-md","font-semibold","text-secondary","bg-white","dark:bg-gray-900","border-b","border-gray-200","dark:border-gray-700",2,"grid-template-columns","200px 200px 150px 150px 300px 250px 120px"],[3,"mat-sort-header"],[1,"sticky-end"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","items-center","text-m",2,"grid-template-columns","200px 200px 150px 150px 300px 250px 200px"],[1,"truncate"],[1,"flex","items-center","justify-center","sticky-end"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","whitespace-nowrap",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"grid"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"responsive-form","flex","flex-col","w-full","max-w-full","mx-auto","box-border",2,"width","100%","max-width","500px","padding","0 16px","box-sizing","border-box",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","p-8"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-2/4","sm:pl-8"],[1,"w-full"],["formControlName","proveedor"],[3,"value",4,"ngFor","ngForOf"],["formControlName","contrato"],["matPrefix",""],["matInput","","type","number","formControlName","costo_cup"],[1,"flex","flex-col","w-full","lg:w-1/4","sm:pl-8"],["matInput","","type","number","formControlName","costo_cl"],["matInput","","formControlName","trabajo_ejecutado"],["matInput","","type","date","formControlName","fecha_ejecucion"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","w-full","border-t","px-4","sm:px-8","py-4"],["mat-button","",1,"-ml-4",3,"color","click"],[1,"flex","flex-col","sm:flex-row","items-center","gap-3","w-full","sm:w-auto","lg:w-auto"],["mat-stroked-button","","color","primary",1,"w-full","sm:w-auto","lg:w-auto","px-6",3,"click"],["mat-stroked-button","","color","warn",1,"w-full","sm:w-auto","lg:w-auto","px-6",3,"click"],[3,"value"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(o,r){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5,"Total Ejecuciones"),t.qZA(),t.TgZ(6,"div",5),t._uU(7),t.qZA()(),t.TgZ(8,"div",3)(9,"div",4),t._uU(10," Monto Inicial CUP "),t.qZA(),t.TgZ(11,"div",5),t._uU(12),t.ALo(13,"currency"),t.qZA()(),t.TgZ(14,"div",3)(15,"div",4),t._uU(16," Total Ejecutado CUP "),t.qZA(),t.TgZ(17,"div",5),t._uU(18),t.ALo(19,"currency"),t.qZA()(),t.TgZ(20,"div",3)(21,"div",4),t._uU(22," Monto Restante CUP "),t.qZA(),t.TgZ(23,"div",5),t._uU(24),t.ALo(25,"currency"),t.qZA()(),t.TgZ(26,"div",3)(27,"div",4),t._uU(28," Monto Inicial USD "),t.qZA(),t.TgZ(29,"div",5),t._uU(30),t.qZA()(),t.TgZ(31,"div",3)(32,"div",4),t._uU(33," Total Ejecutado USD "),t.qZA(),t.TgZ(34,"div",5),t._uU(35),t.qZA()(),t.TgZ(36,"div",3)(37,"div",4),t._uU(38," Monto Restante USD "),t.qZA(),t.TgZ(39,"div",5),t._uU(40),t.qZA()()()(),t.TgZ(41,"div",6)(42,"div",7),t.YNc(43,M,2,1,"div",8),t.TgZ(44,"div",9),t._uU(45,"Ejecuci\xf3n de Contratos"),t.qZA(),t.TgZ(46,"div",10)(47,"mat-form-field",11),t._UZ(48,"mat-icon",12)(49,"input",13),t.qZA(),t.TgZ(50,"button",14),t.NdJ("click",function(){return r.createRecord()}),t._UZ(51,"mat-icon",15),t.TgZ(52,"span",16),t._uU(53,"Agregar"),t.qZA()(),t.TgZ(54,"button",17),t.NdJ("click",function(){return r.exportToCSV()}),t._UZ(55,"mat-icon",15),t.qZA()()(),t.TgZ(56,"div",18)(57,"div",19),t.YNc(58,K,19,17,"ng-container",20)(59,tt,44,4,"ng-template",null,21,t.W1O)(61,et,2,0,"ng-template",null,22,t.W1O),t.qZA()()()()),2&o){const c=t.MAs(62);t.xp6(7),t.Oqu(r.data.length),t.xp6(5),t.hij(" ",t.xi3(13,19,r.montoInicialCup,"CUP")," "),t.xp6(6),t.hij(" ",t.xi3(19,22,r.totalEjecutadoCup,"CUP")," "),t.xp6(6),t.hij(" ",t.xi3(25,25,r.montoRestanteCup,"CUP")," "),t.xp6(6),t.hij(" ",r.montoInicialUsd," "),t.xp6(5),t.hij(" ",r.totalEjecutadoUsd," "),t.xp6(5),t.hij(" ",r.montoRestanteUsd," "),t.xp6(3),t.Q6J("ngIf",r.isLoading),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",r.searchInputControl)("autocomplete","off")("placeholder","Buscar ejecuciones"),t.xp6(1),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(3),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:arrow-up-tray"),t.xp6(3),t.Q6J("ngIf",r.dataSource.data.length>0)("ngIfElse",c)}},dependencies:[l.ez,l.mk,l.sg,l.O5,l.tP,l.H9,l.uU,g.ot,g.lW,g.RK,w.Cv,w.pW,p.JX,p.YE,p.nU,T.p0,v.Ps,v.Hw,i.UX,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.oH,i.sg,i.u,h.TU,h.NW,d.lN,d.KE,d.hX,d.qo,_.c,_.Nt,b.LD,b.gD,j.ey,J.Tx,R.t],styles:[".inventory-grid{display:grid;grid-template-columns:25px repeat(9,1fr) 35px;gap:1rem;width:100%;box-sizing:border-box}.inventory-grid.z-3{position:sticky;top:0;background:white;z-index:20;box-shadow:0 2px 5px -2px #0000001a;overflow:visible}.dark .inventory-grid.z-3{background:#1E293B}.inventory-grid>div:last-child{position:sticky;right:0;background:white;z-index:10;box-shadow:-2px 0 5px -2px #0000001a}.dark .inventory-grid>div:last-child{background:#1E293B}.sticky-end{position:sticky;right:0;background:white;z-index:11;box-shadow:-2px 0 5px -2px #0000001a}.dark .sticky-end{background:#1E293B}.dark .inventory-grid>div{color:#e0e0e0}.dark .sticky-end .mat-stroked-button{background:#1E293B!important;color:#fff!important;border-color:#1e293b!important}.dark .sticky-end .mat-stroked-button .mat-icon{color:#fff!important}.inventory-grid>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host{display:block;width:100%;overflow-x:auto}@media (max-width: 768px){.inventory-grid{grid-template-columns:25px 70px 110px 90px 90px 80px 80px 80px 80px 80px 35px}}\n"],encapsulation:2,changeDetection:0})}return n})();var nt=a(5170);function rt(n,s){1&n&&(t.TgZ(0,"div",9),t._UZ(1,"mat-progress-bar",10),t.qZA()),2&n&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function it(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.TgZ(4,"div",16),t._uU(5),t.qZA(),t.TgZ(6,"div"),t._uU(7),t.qZA(),t.TgZ(8,"div"),t._uU(9),t.ALo(10,"currency"),t.qZA(),t.TgZ(11,"div"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"div")(18,"button",17),t._uU(19,"Restaurar"),t.qZA(),t.TgZ(20,"button",18),t._uU(21,"Eliminar"),t.qZA()()(),t.BQk()),2&n){const e=s.$implicit;t.xp6(3),t.Oqu(e.no_contrato),t.xp6(2),t.Oqu(e.proveedor.nombre),t.xp6(2),t.Oqu(e.tipo_contrato.tipo_contrato),t.xp6(2),t.Oqu(t.gM2(10,6,e.valor_cup,"CUP","symbol","1.2-2")),t.xp6(3),t.Oqu(t.xi3(13,11,e.fecha_firmado,"shortDate")),t.xp6(3),t.Oqu(t.xi3(16,14,e.fecha_vencido,"shortDate"))}}function at(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"div",11)(2,"div",12)(3,"div",13),t._uU(4,"No. Contrato"),t.qZA(),t.TgZ(5,"div",13),t._uU(6,"Proveedor"),t.qZA(),t.TgZ(7,"div",13),t._uU(8,"Tipo de Contrato"),t.qZA(),t.TgZ(9,"div",13),t._uU(10,"Valor (CUP)"),t.qZA(),t.TgZ(11,"div",13),t._uU(12,"Fecha Firmado"),t.qZA(),t.TgZ(13,"div",13),t._uU(14,"Fecha Vencido"),t.qZA(),t.TgZ(15,"div"),t._uU(16,"Acciones"),t.qZA()(),t.YNc(17,it,22,17,"ng-container",14),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("mat-sort-header","no_contrato"),t.xp6(2),t.Q6J("mat-sort-header","proveedor"),t.xp6(2),t.Q6J("mat-sort-header","tipo_contrato"),t.xp6(2),t.Q6J("mat-sort-header","valor_cup"),t.xp6(2),t.Q6J("mat-sort-header","fecha_firmado"),t.xp6(2),t.Q6J("mat-sort-header","fecha_vencido"),t.xp6(4),t.Q6J("ngForOf",e.dataSource.data)("ngForTrackBy",e.trackByFn)}}function ct(n,s){1&n&&(t.TgZ(0,"div",19),t._uU(1,"\xa1No hay contratos vencidos!"),t.qZA())}let st=(()=>{class n{constructor(e,o){this.contratoService=e,this.cdr=o,this.displayedColumns=["no_contrato","proveedor","tipo_contrato","valor_cup","fecha_firmado","fecha_vencido","acciones"],this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.dataSource=new T.by([])}ngOnInit(){this.loadExpiredContracts()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.cdr.markForCheck()}loadExpiredContracts(){this.isLoading=!0,this.errorMessage="",this.contratoService.getExpiredContratos().subscribe({next:e=>{console.log("Expired contracts received:",e),this.dataSource.data=e.filter(o=>o.proveedor&&o.proveedor.nombre),console.log("Expired DataSource data:",this.dataSource.data),this.pagination.length=this.dataSource.data.length,this.isLoading=!1,this.cdr.markForCheck()},error:e=>{console.error("Error fetching expired contracts:",e),this.errorMessage="Failed to load expired contracts. Please try again.",this.isLoading=!1,this.cdr.markForCheck()}})}trackByFn(e,o){return o.id}restoreContrato(e){this.contratoService.restoreContrato(e).subscribe({next:()=>{this.loadExpiredContracts(),this.cdr.markForCheck()},error:o=>{console.error("Error restoring contrato:",o),this.errorMessage="Failed to restore contract. Please try again.",this.cdr.markForCheck()}})}deleteContrato(e){this.contratoService.deleteContrato(e).subscribe({next:()=>{this.loadExpiredContracts(),this.cdr.markForCheck()},error:o=>{console.error("Error deleting contrato:",o),this.errorMessage="Failed to delete contract. Please try again.",this.cdr.markForCheck()}})}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(nt.d),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-expired-contracts"]],viewQuery:function(o,r){if(1&o&&(t.Gf(p.YE,5),t.Gf(h.NW,5)),2&o){let c;t.iGM(c=t.CRH())&&(r.sort=c.first),t.iGM(c=t.CRH())&&(r.paginator=c.first)}},standalone:!0,features:[t.jDz],decls:11,vars:3,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["noExpiredContracts",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5",2,"grid-template-columns","repeat(7, minmax(0, 1fr))"],[3,"mat-sort-header"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inventory-grid","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b",2,"grid-template-columns","repeat(7, minmax(0, 1fr))"],[1,"truncate"],["mat-button","","color","primary"],["mat-button","","color","warn"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(o,r){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,rt,2,1,"div",3),t.TgZ(4,"div",4),t._uU(5,"Contratos Vencidos"),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6),t.YNc(8,at,18,8,"ng-container",7)(9,ct,2,0,"ng-template",null,8,t.W1O),t.qZA()()()()),2&o){const c=t.MAs(10);t.xp6(3),t.Q6J("ngIf",r.isLoading),t.xp6(5),t.Q6J("ngIf",r.dataSource.data.length>0)("ngIfElse",c)}},dependencies:[l.ez,l.sg,l.O5,l.H9,l.uU,g.ot,g.lW,w.Cv,w.pW,p.JX,p.YE,p.nU,T.p0,v.Ps,i.UX,h.TU,d.lN,_.c,b.LD],styles:['@charset "UTF-8";.inventory-grid{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:1rem;padding:.5rem 0;border-bottom:1px solid #e0e0e0}.inventory-grid>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.bg-card{background-color:#fff;border-radius:.5rem;box-shadow:0 0 10px #0000001a}.text-secondary{color:#6b7280}.shadow{box-shadow:0 1px 3px #0000001a}\n'],encapsulation:2,changeDetection:0})}return n})();var E=a(5195);const dt=[{path:"tipos",component:q.M},{path:"contratos",component:ot},{path:"vencidos",component:st},{path:"vencidas",component:(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-expired"]],standalone:!0,features:[t.jDz],decls:4,vars:0,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-6","sm:p-10"],[1,"h-400","min-h-400","max-h-400","border-2","border-dashed","border-gray-300","rounded-2xl"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"mat-card"),t.qZA()()())},dependencies:[l.ez,E.QW,E.a8]})}return n})()}];let ut=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[k.Bz.forChild(dt),k.Bz]})}return n})()}}]);