"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[352],{8352:(ft,h,c)=>{c.r(h),c.d(h,{TrabajadoresComponent:()=>_t});var m=c(6814),u=c(2296),_=c(617),x=c(5313),d=c(4170),b=c(4516),T=c(6007),f=c(1476),v=c(3566),C=c(2596),s=c(6223),A=c(8645),I=c(3620),q=c(3997),F=c(9773),p=c(7700),Z=c(8525),t=c(9212);let U=(()=>{class n{constructor(e){this.el=e,this.appRestrictInput="",this.maxLength=0}onKeyPress(e){if(!this.appRestrictInput)return!0;if(this.maxLength>0&&this.el.nativeElement.value.length>=this.maxLength)return e.preventDefault(),!1;const r=new RegExp(this.appRestrictInput),o=String.fromCharCode(e.charCode);return!!r.test(o)||(e.preventDefault(),!1)}onPaste(e){e.preventDefault();const r=e.clipboardData?.getData("text")||"";if(new RegExp(`^${this.appRestrictInput}+$`).test(r)){let a=this.el.nativeElement.value+r;this.maxLength>0&&a.length>this.maxLength&&(a=a.substring(0,this.maxLength)),this.el.nativeElement.value=a,this.el.nativeElement.dispatchEvent(new Event("input"))}}onInput(e){this.maxLength>0&&e.target.value.length>this.maxLength&&(e.target.value=e.target.value.substring(0,this.maxLength))}static#t=this.\u0275fac=function(r){return new(r||n)(t.Y36(t.SBq))};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","appRestrictInput",""]],hostBindings:function(r,o){1&r&&t.NdJ("keypress",function(l){return o.onKeyPress(l)})("paste",function(l){return o.onPaste(l)})("input",function(l){return o.onInput(l)})},inputs:{appRestrictInput:"appRestrictInput",maxLength:"maxLength"},standalone:!0})}return n})(),w=(()=>{class n{constructor(e){this.el=e}onInput(e){const r=e.target,o=r.value;if(o){const a=o.toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");r.value=a,r.dispatchEvent(new Event("input"))}}onBlur(e){const r=e.target,o=r.value.trim();if(o){const a=o.toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");r.value=a,r.dispatchEvent(new Event("input"))}}static#t=this.\u0275fac=function(r){return new(r||n)(t.Y36(t.SBq))};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","appCapitalizeInput",""]],hostBindings:function(r,o){1&r&&t.NdJ("input",function(l){return o.onInput(l)})("blur",function(l){return o.onBlur(l)})},standalone:!0})}return n})();var j=c(2682),E=c(3680);function J(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El nombre es requerido"),t.qZA())}function M(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El nombre debe tener al menos 2 caracteres"),t.qZA())}function N(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,J,2,0,"span",5)(2,M,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.nombre||null==e.nombre.errors?null:e.nombre.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.nombre||null==e.nombre.errors?null:e.nombre.errors.minlength)}}function O(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El apellido es requerido"),t.qZA())}function Q(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El apellido debe tener al menos 2 caracteres"),t.qZA())}function P(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,O,2,0,"span",5)(2,Q,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.apellido||null==e.apellido.errors?null:e.apellido.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.apellido||null==e.apellido.errors?null:e.apellido.errors.minlength)}}function S(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El usuario es requerido"),t.qZA())}function D(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El usuario debe tener al menos 3 caracteres"),t.qZA())}function R(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,S,2,0,"span",5)(2,D,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.usuario||null==e.usuario.errors?null:e.usuario.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.usuario||null==e.usuario.errors?null:e.usuario.errors.minlength)}}function L(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El email es requerido"),t.qZA())}function Y(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"Ingrese un email v\xe1lido"),t.qZA())}function z(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,L,2,0,"span",5)(2,Y,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.email||null==e.email.errors?null:e.email.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.email||null==e.email.errors?null:e.email.errors.email)}}function B(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El cargo es requerido"),t.qZA())}function $(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,B,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.cargo||null==e.cargo.errors?null:e.cargo.errors.required)}}function H(n,i){if(1&n&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.nombre," ")}}function V(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El departamento es requerido"),t.qZA())}function G(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,V,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.departamento_id||null==e.departamento_id.errors?null:e.departamento_id.errors.required)}}function K(n,i){if(1&n&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function W(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"El rol es requerido"),t.qZA())}function X(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,W,2,0,"span",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.rol||null==e.rol.errors?null:e.rol.errors.required)}}function tt(n,i){1&n&&(t.TgZ(0,"mat-form-field",3)(1,"mat-label"),t._uU(2,"Contrase\xf1a"),t.qZA(),t._UZ(3,"input",20),t.TgZ(4,"mat-hint"),t._uU(5,"Se asignar\xe1 una contrase\xf1a temporal que el usuario deber\xe1 cambiar"),t.qZA()())}let k=(()=>{class n{constructor(e,r,o,a){this.fb=e,this.trabajadoresService=r,this.dialogRef=o,this.data=a,this.roles=[{value:"visor",label:"Visor",description:"Solo visualiza informaci\xf3n, puede imprimir y exportar"},{value:"operador",label:"Operador",description:"Agrega y modifica contratos y suplementos (sin eliminar)"},{value:"ejecutor",label:"Ejecutor",description:"Ejecuta contratos, maneja facturas de cobro"},{value:"administrador",label:"Administrador",description:"Elimina contratos, modifica Mi Entidad, backup BD"}],this.isEdit=a.isEdit,this.initForm()}initForm(){this.trabajadorForm=this.fb.group({nombre:["",[s.kI.required,s.kI.minLength(2)]],apellido:["",[s.kI.required,s.kI.minLength(2)]],usuario:["",[s.kI.required,s.kI.minLength(3)]],email:["",[s.kI.required,s.kI.email]],telefono:["",[s.kI.pattern(/^[0-9]*$/)]],telefono_movil:["",[s.kI.pattern(/^[+]?[0-9]*$/)]],cargo:["",[s.kI.required]],departamento_id:["",[s.kI.required]],rol:["",[s.kI.required]],contrasena:[""]}),this.isEdit||this.trabajadorForm.get("contrasena")?.setValidators([s.kI.required,s.kI.minLength(6)])}ngOnInit(){this.departamentos$=this.trabajadoresService.getDepartamentos(),this.isEdit&&this.data.trabajador?this.trabajadorForm.patchValue({nombre:this.data.trabajador.nombre,apellido:this.data.trabajador.apellido,usuario:this.data.trabajador.usuario,email:this.data.trabajador.email,telefono:this.data.trabajador.telefono,telefono_movil:this.data.trabajador.telefono_movil,cargo:this.data.trabajador.cargo,departamento_id:this.data.trabajador.departamento_id,rol:this.data.trabajador.rol}):(this.trabajadorForm.get("telefono_movil")?.setValue("+53"),this.trabajadorForm.get("telefono")?.setValue("+22"))}get nombre(){return this.trabajadorForm.get("nombre")}get apellido(){return this.trabajadorForm.get("apellido")}get usuario(){return this.trabajadorForm.get("usuario")}get email(){return this.trabajadorForm.get("email")}get telefono(){return this.trabajadorForm.get("telefono")}get telefono_movil(){return this.trabajadorForm.get("telefono_movil")}get cargo(){return this.trabajadorForm.get("cargo")}get departamento_id(){return this.trabajadorForm.get("departamento_id")}get rol(){return this.trabajadorForm.get("rol")}get contrasena(){return this.trabajadorForm.get("contrasena")}onSubmit(){this.trabajadorForm.valid?this.dialogRef.close(this.trabajadorForm.value):Object.keys(this.trabajadorForm.controls).forEach(e=>{this.trabajadorForm.get(e)?.markAsTouched()})}onCancel(){this.dialogRef.close()}static#t=this.\u0275fac=function(r){return new(r||n)(t.Y36(s.qu),t.Y36(j.r),t.Y36(p.so),t.Y36(p.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-trabajador-form"]],standalone:!0,features:[t.jDz],decls:59,vars:17,consts:[[1,"trabajador-form-dialog"],["mat-dialog-title","",1,"flex","items-center"],[1,"flex","flex-col","gap-4",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","nombre","placeholder","Ingrese el nombre","appCapitalizeInput",""],[4,"ngIf"],["matInput","","formControlName","apellido","placeholder","Ingrese el apellido","appCapitalizeInput",""],["matInput","","formControlName","usuario","placeholder","Ingrese el nombre de usuario","appCapitalizeInput",""],["matInput","","type","email","formControlName","email","placeholder","ejemplo@correo.com"],["matInput","","formControlName","telefono","placeholder","Ingrese el tel\xe9fono","appRestrictInput","[0-9]"],["matInput","","formControlName","telefono_movil","placeholder","Ingrese el tel\xe9fono m\xf3vil","appRestrictInput","[+0-9]"],["matInput","","formControlName","cargo","placeholder","Ingrese el cargo","appCapitalizeInput",""],["formControlName","departamento_id"],[3,"value",4,"ngFor","ngForOf"],["formControlName","rol"],["appearance","outline",4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"value"],["matInput","","type","password","formControlName","contrasena","placeholder","Contrase\xf1a temporal"]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"h2",1)(2,"mat-icon"),t._uU(3),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"mat-dialog-content")(6,"form",2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Nombre"),t.qZA(),t._UZ(10,"input",4),t.YNc(11,N,3,2,"mat-error",5),t.qZA(),t.TgZ(12,"mat-form-field",3)(13,"mat-label"),t._uU(14,"Apellido"),t.qZA(),t._UZ(15,"input",6),t.YNc(16,P,3,2,"mat-error",5),t.qZA(),t.TgZ(17,"mat-form-field",3)(18,"mat-label"),t._uU(19,"Usuario"),t.qZA(),t._UZ(20,"input",7),t.YNc(21,R,3,2,"mat-error",5),t.qZA(),t.TgZ(22,"mat-form-field",3)(23,"mat-label"),t._uU(24,"Email"),t.qZA(),t._UZ(25,"input",8),t.YNc(26,z,3,2,"mat-error",5),t.qZA(),t.TgZ(27,"mat-form-field",3)(28,"mat-label"),t._uU(29,"Tel\xe9fono"),t.qZA(),t._UZ(30,"input",9),t.qZA(),t.TgZ(31,"mat-form-field",3)(32,"mat-label"),t._uU(33,"Tel\xe9fono M\xf3vil"),t.qZA(),t._UZ(34,"input",10),t.qZA(),t.TgZ(35,"mat-form-field",3)(36,"mat-label"),t._uU(37,"Cargo"),t.qZA(),t._UZ(38,"input",11),t.YNc(39,$,2,1,"mat-error",5),t.qZA(),t.TgZ(40,"mat-form-field",3)(41,"mat-label"),t._uU(42,"Departamento"),t.qZA(),t.TgZ(43,"mat-select",12),t.YNc(44,H,2,2,"mat-option",13),t.ALo(45,"async"),t.qZA(),t.YNc(46,G,2,1,"mat-error",5),t.qZA(),t.TgZ(47,"mat-form-field",3)(48,"mat-label"),t._uU(49,"Rol"),t.qZA(),t.TgZ(50,"mat-select",14),t.YNc(51,K,2,2,"mat-option",13),t.qZA(),t.YNc(52,X,2,1,"mat-error",5),t.qZA(),t.YNc(53,tt,6,0,"mat-form-field",15),t.qZA()(),t.TgZ(54,"mat-dialog-actions",16)(55,"button",17),t.NdJ("click",function(){return o.onCancel()}),t._uU(56,"Cancelar"),t.qZA(),t.TgZ(57,"button",18),t.NdJ("click",function(){return o.onSubmit()}),t._uU(58),t.qZA()()()),2&r&&(t.xp6(3),t.Oqu(o.isEdit?"edit":"person_add"),t.xp6(1),t.hij(" ",o.isEdit?"Editar Trabajador":"Nuevo Trabajador"," "),t.xp6(2),t.Q6J("formGroup",o.trabajadorForm),t.xp6(5),t.Q6J("ngIf",(null==o.nombre?null:o.nombre.invalid)&&(null==o.nombre?null:o.nombre.touched)),t.xp6(5),t.Q6J("ngIf",(null==o.apellido?null:o.apellido.invalid)&&(null==o.apellido?null:o.apellido.touched)),t.xp6(5),t.Q6J("ngIf",(null==o.usuario?null:o.usuario.invalid)&&(null==o.usuario?null:o.usuario.touched)),t.xp6(5),t.Q6J("ngIf",(null==o.email?null:o.email.invalid)&&(null==o.email?null:o.email.touched)),t.xp6(13),t.Q6J("ngIf",(null==o.cargo?null:o.cargo.invalid)&&(null==o.cargo?null:o.cargo.touched)),t.xp6(5),t.Q6J("ngForOf",t.lcZ(45,15,o.departamentos$)),t.xp6(2),t.Q6J("ngIf",(null==o.departamento_id?null:o.departamento_id.invalid)&&(null==o.departamento_id?null:o.departamento_id.touched)),t.xp6(5),t.Q6J("ngForOf",o.roles),t.xp6(1),t.Q6J("ngIf",(null==o.rol?null:o.rol.invalid)&&(null==o.rol?null:o.rol.touched)),t.xp6(1),t.Q6J("ngIf",!o.isEdit),t.xp6(4),t.Q6J("disabled",o.trabajadorForm.invalid),t.xp6(1),t.hij(" ",o.isEdit?"Actualizar":"Crear"," "))},dependencies:[m.ez,m.sg,m.O5,m.Ov,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,p.Is,p.uh,p.H8,p.xY,u.ot,u.lW,d.lN,d.KE,d.hX,d.bx,d.TO,b.c,b.Nt,Z.LD,Z.gD,E.ey,_.Ps,_.Hw,U,w],styles:[".trabajador-form-dialog[_ngcontent-%COMP%]{min-width:500px}.trabajador-form-dialog[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem}.trabajador-form-dialog[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem}.trabajador-form-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{padding:1rem 0}.trabajador-form-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{min-width:400px}.trabajador-form-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{padding:1rem 0;gap:.5rem}"]})}return n})();var g=c(7988),y=c(5986);const et=["columnMenu"];function ot(n,i){1&n&&(t.TgZ(0,"div",36),t._UZ(1,"mat-progress-bar",37),t.qZA()),2&n&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function nt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",38),t.NdJ("click",function(o){return o.stopPropagation()}),t.TgZ(1,"mat-checkbox",39),t.NdJ("change",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleColumn(a.key))})("click",function(o){return o.stopPropagation()}),t._uU(2),t.qZA()()}if(2&n){const e=i.$implicit;t.xp6(1),t.Q6J("checked",e.visible)("color","primary"),t.xp6(1),t.hij(" ",e.label," ")}}function rt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",38),t.NdJ("click",function(o){return o.stopPropagation()}),t.TgZ(1,"mat-checkbox",39),t.NdJ("change",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleColumn(a.key))})("click",function(o){return o.stopPropagation()}),t._uU(2),t.qZA()()}if(2&n){const e=i.$implicit;t.xp6(1),t.Q6J("checked",e.visible)("color","primary"),t.xp6(1),t.hij(" ",e.label," ")}}function at(n,i){if(1&n&&(t.TgZ(0,"div",49)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=i.$implicit;t.Q6J("matTooltip",e.tooltip),t.xp6(2),t.Oqu(e.label)}}function it(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"span",57),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit,r=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngClass","admin"===o.getColumnValue(r,e.key)?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"),t.xp6(1),t.hij(" ",o.getColumnValue(r,e.key)||"N/A"," ")}}function lt(n,i){if(1&n&&t._uU(0),2&n){const e=t.oxw().$implicit,r=t.oxw().$implicit,o=t.oxw(2);t.hij(" ",o.getColumnValue(r,e.key)||"N/A"," ")}}function st(n,i){if(1&n&&(t.TgZ(0,"div",55),t.YNc(1,it,3,2,"ng-container",34)(2,lt,1,1,"ng-template",null,56,t.W1O),t.qZA()),2&n){const e=i.$implicit,r=t.MAs(3),o=t.oxw().$implicit,a=t.oxw(2);t.Q6J("matTooltip",a.getColumnValue(o,e.key)),t.xp6(1),t.Q6J("ngIf","rol"===e.key)("ngIfElse",r)}}function ct(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",50),t.YNc(2,st,4,3,"div",51),t.TgZ(3,"div",52)(4,"button",53),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a))}),t._UZ(5,"mat-icon",54),t.qZA(),t.TgZ(6,"button",53),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onDelete(a))}),t._UZ(7,"mat-icon",54),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Udp("grid-template-columns",e.getGridColumns()),t.xp6(1),t.Q6J("ngForOf",e.getVisibleColumns()),t.xp6(2),t.Q6J("color","primary")("matTooltip","Editar"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:pencil"),t.xp6(1),t.Q6J("color","warn")("matTooltip","Eliminar"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:trash")}}function mt(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",58)(2,"div",59)(3,"h3",60),t._uU(4),t.qZA(),t.TgZ(5,"span",57),t._uU(6),t.qZA()(),t.TgZ(7,"div",61)(8,"div")(9,"span",62),t._uU(10,"Cargo:"),t.qZA(),t._uU(11),t.qZA(),t.TgZ(12,"div")(13,"span",62),t._uU(14,"Email:"),t.qZA(),t._uU(15),t.qZA(),t.TgZ(16,"div")(17,"span",62),t._uU(18,"Departamento:"),t.qZA(),t._uU(19),t.qZA(),t.TgZ(20,"div")(21,"span",62),t._uU(22,"Tel\xe9fono:"),t.qZA(),t._uU(23),t.qZA()(),t.TgZ(24,"div",63)(25,"button",64),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a))}),t._UZ(26,"mat-icon",15),t._uU(27," Editar "),t.qZA(),t.TgZ(28,"button",64),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onDelete(a))}),t._UZ(29,"mat-icon",15),t._uU(30," Eliminar "),t.qZA()()(),t.BQk()}if(2&n){const e=i.$implicit,r=t.oxw(2);t.xp6(4),t.AsE(" ",e.nombre," ",e.apellido," "),t.xp6(1),t.Q6J("ngClass","admin"===e.rol?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"),t.xp6(1),t.hij(" ",e.rol||"--"," "),t.xp6(5),t.hij(" ",e.cargo||"--",""),t.xp6(4),t.hij(" ",e.email||"--",""),t.xp6(4),t.hij(" ",r.getDepartamentoNombre(e.departamento)||"--",""),t.xp6(4),t.hij(" ",e.telefono||"--",""),t.xp6(2),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:pencil"),t.xp6(2),t.Q6J("color","warn"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:trash")}}const dt=n=>({"pointer-events-none":n}),pt=()=>[5,10,25,100];function ut(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",40)(2,"div",41)(3,"div",42)(4,"div",43),t.YNc(5,at,3,2,"div",44),t.TgZ(6,"div",45)(7,"span"),t._uU(8,"Acciones"),t.qZA()()(),t.YNc(9,ct,8,9,"ng-container",46),t.qZA()()(),t.TgZ(10,"div",47),t.YNc(11,mt,31,12,"ng-container",46),t.qZA(),t._UZ(12,"mat-paginator",48),t.BQk()),2&n){const e=t.oxw();t.xp6(4),t.Udp("grid-template-columns",e.getGridColumns()),t.xp6(1),t.Q6J("ngForOf",e.getVisibleColumns()),t.xp6(4),t.Q6J("ngForOf",e.dataSource.data)("ngForTrackBy",e.trackByFn),t.xp6(2),t.Q6J("ngForOf",e.dataSource.data)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngClass",t.VKq(12,dt,e.isLoading))("length",e.dataSource.data.length)("pageSize",10)("pageSizeOptions",t.DdM(14,pt))("showFirstLastButtons",!0)}}function gt(n,i){1&n&&(t.TgZ(0,"div",65),t._uU(1," \xa1No hay trabajadores! "),t.qZA())}let _t=(()=>{class n{constructor(e,r,o){this.trabajadoresService=e,this.dialog=r,this.cdr=o,this.columnSettings=[{key:"nombre",label:"Nombre",visible:!0,tooltip:"Nombre del trabajador"},{key:"apellido",label:"Apellido",visible:!0,tooltip:"Apellido del trabajador"},{key:"email",label:"Email",visible:!0,tooltip:"Email del trabajador"},{key:"cargo",label:"Cargo",visible:!0,tooltip:"Cargo del trabajador"},{key:"departamento",label:"Departamento",visible:!0,tooltip:"Departamento del trabajador"},{key:"rol",label:"Rol",visible:!0,tooltip:"Rol del trabajador"},{key:"representante",label:"Representante",visible:!1,tooltip:"Representante asignado"},{key:"representante_legal",label:"Representante Legal",visible:!1,tooltip:"Representante legal"},{key:"representante_id",label:"ID Representante",visible:!1,tooltip:"ID del representante"}],this.displayedColumns=["nombre","apellido","email","cargo","departamento","rol","acciones"],this.isLoading=!1,this.searchInputControl=new s.NI(""),this.destroy$=new A.x,this.dataSource=new x.by([])}getGridColumns(){return this.columnSettings.filter(o=>o.visible),`${this.columnSettings.filter(o=>o.visible).map(()=>"minmax(150px, 1fr)").join(" ")} minmax(100px, 100px)`}getVisibleColumns(){return this.columnSettings.filter(e=>e.visible)}closeColumnMenu(){this.columnMenuTrigger&&this.columnMenuTrigger.closeMenu()}print(){window.print()}ngOnInit(){this.loadTrabajadores(),this.setupSearch()}ngAfterViewInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupSearch(){this.searchInputControl.valueChanges.pipe((0,I.b)(300),(0,q.x)(),(0,F.R)(this.destroy$)).subscribe(e=>{this.onSearch(e||"")})}loadTrabajadores(){this.isLoading=!0,this.trabajadoresService.getTrabajadores().subscribe({next:e=>{console.log(e),this.dataSource.data=e,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.isLoading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error al cargar trabajadores:",e),this.isLoading=!1,this.cdr.detectChanges()}})}onSearch(e){e.trim()?(this.isLoading=!0,this.trabajadoresService.searchTrabajadores(e).subscribe({next:r=>{this.dataSource.data=r,this.isLoading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error en b\xfasqueda:",r),this.isLoading=!1,this.cdr.detectChanges()}})):this.loadTrabajadores()}openNewTrabajadorDialog(){this.dialog.open(k,{width:"600px",data:{isEdit:!1}}).afterClosed().subscribe(o=>{o&&this.loadTrabajadores()})}onEdit(e){this.dialog.open(k,{width:"600px",data:{trabajador:e,isEdit:!0}}).afterClosed().subscribe(a=>{a&&this.loadTrabajadores()})}onDelete(e){e.id&&confirm(`\xbfEliminar a ${e.nombre} ${e.apellido}?`)&&(this.isLoading=!0,this.trabajadoresService.deleteTrabajador(e.id).subscribe({next:()=>{this.loadTrabajadores()},error:r=>{console.error("Error al eliminar trabajador:",r),this.isLoading=!1,this.cdr.detectChanges()}}))}exportToExcel(){this.trabajadoresService.exportToExcel().subscribe({next:e=>{this.downloadFile(e,"trabajadores.xlsx")},error:e=>{console.error("Error al exportar a Excel:",e)}})}exportToPdf(){this.trabajadoresService.exportToPdf().subscribe({next:e=>{this.downloadFile(e,"trabajadores.pdf")},error:e=>{console.error("Error al exportar a PDF:",e)}})}exportToCSV(){const e=this.convertToCSV(this.dataSource.data),r=new Blob([e],{type:"text/csv;charset=utf-8;"});this.downloadFile(r,"trabajadores.csv")}convertToCSV(e){return[["Nombre","Apellido","Email","Cargo","Tel\xe9fono","Rol"].join(","),...e.map(a=>[a.nombre,a.apellido,a.email,a.cargo,a.telefono||"",a.rol].join(","))].join("\n")}downloadFile(e,r){const o=window.URL.createObjectURL(e),a=document.createElement("a");a.href=o,a.download=r,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(o)}getDepartamentoNombre(e){return{1:"Recursos Humanos",2:"Tecnolog\xeda",3:"Finanzas",4:"Operaciones",5:"Marketing",6:"Ventas"}[e]||"Sin asignar"}trackByFn(e,r){return r.id||e}quitarColumnasRepresentante(){this.columnSettings.forEach(e=>{e.key.includes("representante")&&(e.visible=!1)}),this.updateDisplayedColumns()}ponerColumnasRepresentante(){this.columnSettings.forEach(e=>{e.key.includes("representante")&&(e.visible=!0)}),this.updateDisplayedColumns()}updateDisplayedColumns(){this.displayedColumns=[...this.columnSettings.filter(e=>e.visible).map(e=>e.key),"acciones"]}toggleColumn(e){const r=this.columnSettings.find(o=>o.key===e);r&&(r.visible=!r.visible,this.updateDisplayedColumns())}getColumnValue(e,r){switch(r){case"nombre":return e.nombre;case"apellido":return e.apellido;case"email":return e.email;case"cargo":return e.cargo;case"rol":return e.rol;default:return"N/A"}}static#t=this.\u0275fac=function(r){return new(r||n)(t.Y36(j.r),t.Y36(p.uw),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-trabajadores"]],viewQuery:function(r,o){if(1&r&&(t.Gf(f.NW,5),t.Gf(v.YE,5),t.Gf(et,5,g.p6)),2&r){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first),t.iGM(a=t.CRH())&&(o.sort=a.first),t.iGM(a=t.CRH())&&(o.columnMenuTrigger=a.first)}},standalone:!0,features:[t.jDz],decls:66,vars:20,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"absolute","bottom-0","right-0","w-24","h-24","-m-6"],[1,"icon-size-24","opacity-25","text-blue-500","dark:text-blue-400",3,"svgIcon"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex","flex-col","sm:flex-row","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","mt-4","sm:mt-0","w-55","text-lg",3,"color","click"],[3,"svgIcon"],[1,"ml-2","hidden","sm:inline"],[1,"ml-2","sm:hidden"],["mat-icon-button","","matTooltip","Configurar columnas",1,"ml-2","mt-4","sm:mt-0",3,"matMenuTriggerFor","color"],["columnMenuTrigger","matMenuTrigger"],[1,"column-menu"],["columnMenu","matMenu"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-300","border-b"],[1,"p-2",3,"click"],["class","flex items-center py-1 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",3,"click",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Exportar tabla","aria-label","Exportar tabla",1,"ml-4","mt-4","sm:mt-0",3,"matMenuTriggerFor","color"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","","color","primary","matTooltip","Imprimir","aria-label","Imprimir",1,"ml-2","mt-4","sm:mt-0",3,"click"],[1,"column-menu",3,"hasBackdrop"],[1,"px-4","py-2","border-t"],["mat-stroked-button","","color","primary",1,"w-full",3,"click"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden"],[4,"ngIf","ngIfElse"],["noTrabajadores",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"flex","items-center","py-1","px-2","hover:bg-gray-100","dark:hover:bg-gray-700","rounded",3,"click"],[3,"checked","color","change","click"],[1,"hidden","lg:block","w-full"],[1,"relative","overflow-x-auto","overflow-y-hidden","max-w-full"],[1,"min-w-max"],[1,"sticky","top-0","z-20","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5","border-b"],["class","truncate flex items-center","matTooltipPosition","above",3,"matTooltip",4,"ngFor","ngForOf"],[1,"sticky","right-0","bg-gray-50","dark:bg-black","dark:bg-opacity-5","z-30","flex","items-center","justify-center","border-l"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"lg:hidden"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageSize","pageSizeOptions","showFirstLastButtons"],["matTooltipPosition","above",1,"truncate","flex","items-center",3,"matTooltip"],[1,"grid","items-center","gap-4","py-3","px-6","md:px-8","border-b","hover:bg-gray-50","dark:hover:bg-gray-800","transition-colors","duration-200"],["class","truncate","matTooltipPosition","above",3,"matTooltip",4,"ngFor","ngForOf"],[1,"sticky","right-0","bg-white","dark:bg-gray-900","z-30","flex","items-center","justify-center","gap-2","border-l","pl-4"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"color","matTooltip","click"],[1,"icon-size-5",3,"svgIcon"],["matTooltipPosition","above",1,"truncate",3,"matTooltip"],["normalColumn",""],[1,"px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-sm","border","border-gray-200","dark:border-gray-700","p-4","mb-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"grid","grid-cols-1","gap-2","text-sm"],[1,"font-medium"],[1,"flex","justify-end","mt-4","gap-2"],["mat-stroked-button","",3,"color","click"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(r,o){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"mat-icon",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5),t.YNc(6,ot,2,1,"div",6),t.TgZ(7,"div",7)(8,"div",8)(9,"h2",9),t._uU(10," Trabajadores "),t.qZA()()(),t.TgZ(11,"div",10)(12,"mat-form-field",11),t._UZ(13,"mat-icon",12)(14,"input",13),t.qZA(),t.TgZ(15,"button",14),t.NdJ("click",function(){return o.openNewTrabajadorDialog()}),t._UZ(16,"mat-icon",15),t.TgZ(17,"span",16),t._uU(18,"Agregar Trabajador"),t.qZA(),t.TgZ(19,"span",17),t._uU(20,"Agregar"),t.qZA()(),t.TgZ(21,"button",18,19),t._UZ(23,"mat-icon",15),t.qZA(),t.TgZ(24,"mat-menu",20,21)(26,"div",22),t._uU(27," Mostrar Columnas "),t.qZA(),t.TgZ(28,"div",23),t.NdJ("click",function(l){return l.stopPropagation()}),t.YNc(29,nt,3,3,"div",24),t.qZA()(),t.TgZ(30,"button",25),t._UZ(31,"mat-icon",15),t.qZA(),t.TgZ(32,"mat-menu",null,26)(34,"button",27),t.NdJ("click",function(){return o.exportToCSV()}),t.TgZ(35,"mat-icon"),t._uU(36,"description"),t.qZA(),t.TgZ(37,"span"),t._uU(38,"Exportar a CSV"),t.qZA()(),t.TgZ(39,"button",27),t.NdJ("click",function(){return o.exportToPdf()}),t.TgZ(40,"mat-icon"),t._uU(41,"picture_as_pdf"),t.qZA(),t.TgZ(42,"span"),t._uU(43,"Exportar a PDF"),t.qZA()(),t.TgZ(44,"button",27),t.NdJ("click",function(){return o.exportToExcel()}),t.TgZ(45,"mat-icon"),t._uU(46,"table_chart"),t.qZA(),t.TgZ(47,"span"),t._uU(48,"Exportar a Excel"),t.qZA()()(),t.TgZ(49,"button",28),t.NdJ("click",function(){return o.print()}),t.TgZ(50,"mat-icon"),t._uU(51,"print"),t.qZA()()()(),t.TgZ(52,"mat-menu",29,21)(54,"div",22),t._uU(55," Mostrar Columnas "),t.qZA(),t.TgZ(56,"div",23),t.NdJ("click",function(l){return l.stopPropagation()}),t.YNc(57,rt,3,3,"div",24),t.qZA(),t.TgZ(58,"div",30)(59,"button",31),t.NdJ("click",function(){return o.closeColumnMenu()}),t._uU(60," Cerrar "),t.qZA()()(),t.TgZ(61,"div",32)(62,"div",33),t.YNc(63,ut,13,15,"ng-container",34)(64,gt,2,0,"ng-template",null,35,t.W1O),t.qZA()()()()()),2&r){const a=t.MAs(25),l=t.MAs(33),bt=t.MAs(65);t.xp6(3),t.Q6J("svgIcon","heroicons_outline:users"),t.xp6(3),t.Q6J("ngIf",o.isLoading),t.xp6(6),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",o.searchInputControl)("autocomplete","off")("placeholder","Buscar trabajadores"),t.xp6(1),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(5),t.Q6J("matMenuTriggerFor",a)("color","primary"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:view-columns"),t.xp6(6),t.Q6J("ngForOf",o.columnSettings),t.xp6(1),t.Q6J("matMenuTriggerFor",l)("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:arrow-up-tray"),t.xp6(21),t.Q6J("hasBackdrop",!1),t.xp6(5),t.Q6J("ngForOf",o.columnSettings),t.xp6(6),t.Q6J("ngIf",(null==o.dataSource||null==o.dataSource.data?null:o.dataSource.data.length)>0)("ngIfElse",bt)}},dependencies:[m.ez,m.mk,m.sg,m.O5,u.ot,u.lW,u.RK,_.Ps,_.Hw,x.p0,d.lN,d.KE,d.qo,b.c,b.Nt,T.Cv,T.pW,f.TU,f.NW,v.JX,C.AV,C.gM,s.UX,s.Fj,s.JJ,s.oH,g.Tx,g.VK,g.OP,g.p6,y.p9,y.oG],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.mat-table[_ngcontent-%COMP%]{overflow:auto}.filter-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,minmax(100px,1fr));gap:16px;padding:8px 16px;border-bottom:1px solid #ccc;background-color:#f9f9f9}.details-panel[_ngcontent-%COMP%]{padding:16px;background-color:#fff;border-top:1px solid #ccc}.sticky-end[_ngcontent-%COMP%]{position:sticky;right:0;background:inherit;z-index:1}.mat-form-field[_ngcontent-%COMP%]{width:100%}.inventory-grid[_ngcontent-%COMP%]{grid-template-columns:120px 120px 200px 150px 120px 100px 120px}@media (min-width: 640px){.inventory-grid[_ngcontent-%COMP%]{grid-template-columns:120px 120px 200px 150px 120px 100px 120px}}@media (min-width: 768px){.inventory-grid[_ngcontent-%COMP%]{grid-template-columns:140px 140px 220px 180px 140px 120px 140px}}@media (min-width: 1024px){.inventory-grid[_ngcontent-%COMP%]{grid-template-columns:160px 160px 240px 200px 160px 140px 160px}}@media (max-width: 1023px){.inventory-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none;opacity:.6}.bg-green-100[_ngcontent-%COMP%]{background-color:#dcfce7}.text-green-800[_ngcontent-%COMP%]{color:#166534}.bg-blue-100[_ngcontent-%COMP%]{background-color:#dbeafe}.text-blue-800[_ngcontent-%COMP%]{color:#1e40af}.bg-yellow-100[_ngcontent-%COMP%]{background-color:#fef3c7}.text-yellow-800[_ngcontent-%COMP%]{color:#92400e}.bg-gray-100[_ngcontent-%COMP%]{background-color:#f3f4f6}.text-gray-800[_ngcontent-%COMP%]{color:#1f2937}.trabajadores-table[_ngcontent-%COMP%]{width:100%}.mat-mdc-table[_ngcontent-%COMP%]{background:transparent}.mat-mdc-header-row[_ngcontent-%COMP%]{background-color:#f9fafb}.mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.search-field[_ngcontent-%COMP%]{width:300px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:40px}"]})}return n})()}}]);