"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[117],{6117:(Rt,E,c)=>{c.d(E,{M:()=>$t});var U=c(3566),k=c(1476),D=c(5313),l=c(6223),I=c(9773),q=c(3620),V=c(5228),v=c(6814),F=c(2296),S=c(6007),N=c(617),w=c(4170),L=c(4516),J=c(8525),T=c(7988),O=c(6385),Q=c(2246),j=c(8645),P=c(2596),M=(c(5520),c(5986)),t=c(9212),$=c(5170),R=c(5300),Z=c(6306),A=c(2096),y=c(2022),Y=c(9862);let z=(()=>{class o{constructor(e){this.http=e,this.departamentos=[],this.departamentos=Q.iy||[]}getDepartamentos(){return this.http.get(y.P.DEPARTAMENTOS).pipe((0,Z.K)(e=>(console.error("Error fetching departamentos:",e),(0,A.of)([...this.departamentos]))))}getDepartamentoById(e){return this.http.get(`${y.P.DEPARTAMENTOS}/${e}`).pipe((0,Z.K)(n=>{console.error("Error fetching departamento by id:",n);const i=this.departamentos.find(s=>s.id===e);if(i)return(0,A.of)(i);throw n}))}createDepartamento(e){return this.http.post(y.P.DEPARTAMENTOS,e).pipe((0,Z.K)(n=>{console.error("Error creating departamento:",n);const i={...e,id:this.departamentos.length+1};return this.departamentos.push(i),(0,A.of)(i)}))}updateDepartamento(e,n){return this.http.put(`${y.P.DEPARTAMENTOS}/${e}`,n).pipe((0,Z.K)(i=>{console.error("Error updating departamento:",i);const s=this.departamentos.findIndex(a=>a.id===e);if(-1!==s)return this.departamentos[s]={...n,id:e},(0,A.of)(this.departamentos[s]);throw i}))}deleteDepartamento(e){return this.http.delete(`${y.P.DEPARTAMENTOS}/${e}`).pipe((0,Z.K)(n=>{console.error("Error deleting departamento:",n);const i=this.departamentos.findIndex(s=>s.id===e);if(-1!==i)return this.departamentos.splice(i,1),(0,A.of)(void 0);throw n}))}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(Y.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var G=c(3018),B=c(7700),K=c(1892),H=c(3680);const W=["columnMenuTrigger"];function X(o,r){1&o&&(t.TgZ(0,"div",36),t._UZ(1,"mat-progress-bar",37),t.qZA()),2&o&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function tt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",38),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-checkbox",39),t.NdJ("change",function(){const s=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.toggleColumn(s.key))})("click",function(i){return i.stopPropagation()}),t._uU(2),t.qZA()()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("checked",e.visible)("color","primary"),t.xp6(1),t.hij(" ",e.label," ")}}function et(o,r){if(1&o&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("mat-sort-header",e.key)("matTooltip",e.tooltip),t.xp6(1),t.hij(" ",e.label," ")}}function ot(o,r){1&o&&(t.TgZ(0,"mat-form-field",53),t._UZ(1,"input",54),t.qZA())}function nt(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.nombre)}}function it(o,r){if(1&o&&(t.TgZ(0,"mat-form-field",53)(1,"mat-select",55)(2,"mat-option",56),t._uU(3,"Todos"),t.qZA(),t.YNc(4,nt,2,2,"mat-option",57),t.qZA()()),2&o){const e=t.oxw(4);t.xp6(4),t.Q6J("ngForOf",e.proveedores)}}function at(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.nombre_tipo_contrato)}}function rt(o,r){if(1&o&&(t.TgZ(0,"mat-form-field",53)(1,"mat-select",59)(2,"mat-option",56),t._uU(3,"Todos"),t.qZA(),t.YNc(4,at,2,2,"mat-option",57),t.qZA()()),2&o){const e=t.oxw(4);t.xp6(4),t.Q6J("ngForOf",e.tiposContrato)}}function st(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.nombre_departamento)}}function lt(o,r){if(1&o&&(t.TgZ(0,"mat-form-field",53)(1,"mat-select",60)(2,"mat-option",56),t._uU(3,"Todos"),t.qZA(),t.YNc(4,st,2,2,"mat-option",57),t.qZA()()),2&o){const e=t.oxw(4);t.xp6(4),t.Q6J("ngForOf",e.departamentos)}}function ct(o,r){1&o&&(t.TgZ(0,"mat-form-field",53),t._UZ(1,"input",61),t.qZA())}function dt(o,r){1&o&&(t.TgZ(0,"mat-form-field",53),t._UZ(1,"input",62),t.qZA())}function mt(o,r){1&o&&(t.TgZ(0,"mat-form-field",53),t._UZ(1,"input",63),t.qZA())}function pt(o,r){1&o&&(t.TgZ(0,"mat-form-field",53),t._UZ(1,"input",64),t.qZA())}function _t(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.vigencia)}}function ut(o,r){if(1&o&&(t.TgZ(0,"mat-form-field",53)(1,"mat-select",65)(2,"mat-option",56),t._uU(3,"Todos"),t.qZA(),t.YNc(4,_t,2,2,"mat-option",57),t.qZA()()),2&o){const e=t.oxw(4);t.xp6(4),t.Q6J("ngForOf",e.vigencias)}}function ft(o,r){1&o&&(t.TgZ(0,"mat-form-field",53)(1,"mat-select",66)(2,"mat-option",56),t._uU(3,"Todos"),t.qZA(),t.TgZ(4,"mat-option",67),t._uU(5,"Activo"),t.qZA(),t.TgZ(6,"mat-option",68),t._uU(7,"Casi a vencer"),t.qZA(),t.TgZ(8,"mat-option",69),t._uU(9,"Vencido"),t.qZA()()())}function gt(o,r){1&o&&t._UZ(0,"div")}function vt(o,r){if(1&o&&(t.TgZ(0,"div"),t.ynx(1,50),t.YNc(2,ot,2,0,"mat-form-field",51)(3,it,5,1,"mat-form-field",51)(4,rt,5,1,"mat-form-field",51)(5,lt,5,1,"mat-form-field",51)(6,ct,2,0,"mat-form-field",51)(7,dt,2,0,"mat-form-field",51)(8,mt,2,0,"mat-form-field",51)(9,pt,2,0,"mat-form-field",51)(10,ut,5,1,"mat-form-field",51)(11,ft,10,0,"mat-form-field",51)(12,gt,1,0,"div",52),t.BQk(),t.qZA()),2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngSwitch",e.key),t.xp6(1),t.Q6J("ngSwitchCase","no_contrato"),t.xp6(1),t.Q6J("ngSwitchCase","proveedor"),t.xp6(1),t.Q6J("ngSwitchCase","tipo_contrato"),t.xp6(1),t.Q6J("ngSwitchCase","departamento"),t.xp6(1),t.Q6J("ngSwitchCase","valor_cup"),t.xp6(1),t.Q6J("ngSwitchCase","valor_usd"),t.xp6(1),t.Q6J("ngSwitchCase","fecha_entrada"),t.xp6(1),t.Q6J("ngSwitchCase","fecha_firmado"),t.xp6(1),t.Q6J("ngSwitchCase","vigencia"),t.xp6(1),t.Q6J("ngSwitchCase","estado")}}function ht(o,r){if(1&o&&(t.TgZ(0,"div",48),t._UZ(1,"div"),t.YNc(2,vt,13,11,"div",49),t.qZA()),2&o){const e=t.oxw(2);t.Udp("grid-template-columns",e.getGridColumns()),t.Q6J("formGroup",e.filterForm),t.xp6(2),t.Q6J("ngForOf",e.getVisibleColumns())}}const Ct=(o,r,e)=>({"bg-green-500":o,"bg-orange-500":r,"bg-red-500":e});function xt(o,r){if(1&o&&(t.TgZ(0,"div"),t._UZ(1,"span",79),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngClass",t.kEZ(1,Ct,"vigente"===e.estado,"casi al vencer"===e.estado,"vencido"===e.estado))}}function bt(o,r){if(1&o&&(t.TgZ(0,"div",80),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.no_contrato," ")}}function Tt(o,r){if(1&o&&(t.TgZ(0,"div",81),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("matTooltip",null==e.proveedor?null:e.proveedor.nombre),t.xp6(1),t.hij(" ",(null==e.proveedor?null:e.proveedor.nombre)||"N/A"," ")}}function Zt(o,r){if(1&o&&(t.TgZ(0,"div",81),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("matTooltip",null==e.tipo_contrato?null:e.tipo_contrato.nombre_tipo_contrato),t.xp6(1),t.hij(" ",(null==e.tipo_contrato?null:e.tipo_contrato.nombre_tipo_contrato)||"N/A"," ")}}function At(o,r){if(1&o&&(t.TgZ(0,"div",81),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("matTooltip",null==e.departamento?null:e.departamento.nombre_departamento),t.xp6(1),t.hij(" ",(null==e.departamento?null:e.departamento.nombre_departamento)||"N/A"," ")}}function yt(o,r){if(1&o&&(t.TgZ(0,"div",80),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.gM2(2,1,e.valor_cup,"CUP","symbol","1.0-0")," ")}}function Ut(o,r){if(1&o&&(t.TgZ(0,"div",80),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.gM2(2,1,e.valor_usd,"USD","symbol","1.0-0")," ")}}function wt(o,r){if(1&o&&(t.TgZ(0,"div",80),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.fecha_inicio,"d/M/yy")," ")}}function kt(o,r){if(1&o&&(t.TgZ(0,"div",80),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.fecha_fin,"d/M/yy")," ")}}function Dt(o,r){if(1&o&&(t.TgZ(0,"div",80),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",null==e.vigencia?null:e.vigencia.vigencia," ")}}function Ft(o,r){if(1&o&&(t.TgZ(0,"div",82),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.tiempoRestante," ")}}function It(o,r){1&o&&t.GkF(0)}const qt=o=>({$implicit:o});function St(o,r){if(1&o&&(t.TgZ(0,"div",83),t.YNc(1,It,1,0,"ng-container",84),t.qZA()),2&o){const e=t.oxw().$implicit;t.oxw(2);const n=t.MAs(82);t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(2,qt,e))}}function Nt(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",70),t.YNc(2,xt,2,5,"div",71)(3,bt,2,1,"div",72)(4,Tt,2,2,"div",73)(5,Zt,2,2,"div",73)(6,At,2,2,"div",73)(7,yt,3,6,"div",72)(8,Ut,3,6,"div",72)(9,wt,3,4,"div",72)(10,kt,3,4,"div",72)(11,Dt,2,1,"div",72)(12,Ft,2,1,"div",74),t.TgZ(13,"div",75)(14,"button",76),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.toggleDetails(s.id))}),t._UZ(15,"mat-icon",77),t.qZA()()(),t.YNc(16,St,2,4,"div",78),t.BQk()}if(2&o){const e=r.$implicit,n=t.oxw(2);t.xp6(1),t.Udp("grid-template-columns",n.getGridColumns()),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("estado")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("no_contrato")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("proveedor")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("tipo_contrato")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("departamento")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("valor_cup")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("valor_usd")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("fecha_inicio")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("fecha_fin")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("vigencia")),t.xp6(1),t.Q6J("ngIf",n.isColumnVisible("tiempo_restante")),t.xp6(3),t.Q6J("svgIcon",(null==n.selectedContrato?null:n.selectedContrato.id)===e.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),t.xp6(1),t.Q6J("ngIf",(null==n.selectedContrato?null:n.selectedContrato.id)===e.id)}}const Lt=o=>({"pointer-events-none":o}),Jt=()=>[5,10,25,100];function Qt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",40)(2,"div",41),t._UZ(3,"div"),t.YNc(4,et,2,3,"div",42),t.TgZ(5,"div",43),t._uU(6," Detalles "),t.qZA()(),t.YNc(7,ht,3,4,"div",44)(8,Nt,17,15,"ng-container",45),t.qZA(),t._UZ(9,"mat-paginator",46),t.BQk()),2&o){const e=t.oxw();t.xp6(2),t.Udp("grid-template-columns",e.getGridColumns()),t.xp6(2),t.Q6J("ngForOf",e.getVisibleColumns()),t.xp6(3),t.Q6J("ngIf",e.showFilters),t.xp6(1),t.Q6J("ngForOf",e.dataSource.filteredData)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngClass",t.VKq(12,Lt,e.isLoading))("length",e.pagination.length)("pageIndex",e.pagination.page)("pageSize",e.pagination.size)("pageSizeOptions",t.DdM(14,Jt))("showFirstLastButtons",!0)}}function Pt(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.nombre," ")}}function Mt(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.nombre_tipo_contrato," ")}}function Et(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.nombre," ")}}function Vt(o,r){if(1&o&&(t.TgZ(0,"mat-option",58),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.vigencia," ")}}function Ot(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",85)(1,"div",86)(2,"form",87)(3,"div",88)(4,"div",89)(5,"mat-form-field",90)(6,"mat-label"),t._uU(7,"No. Contrato"),t.qZA(),t._UZ(8,"input",91),t.qZA(),t.TgZ(9,"mat-form-field",90)(10,"mat-label"),t._uU(11,"Proveedor"),t.qZA(),t.TgZ(12,"mat-select",92),t.YNc(13,Pt,2,2,"mat-option",93),t.qZA()(),t.TgZ(14,"mat-form-field",90)(15,"mat-label"),t._uU(16,"Tipo de Contrato"),t.qZA(),t.TgZ(17,"mat-select",94),t.YNc(18,Mt,2,2,"mat-option",93),t.qZA()(),t.TgZ(19,"mat-form-field",90)(20,"mat-label"),t._uU(21,"Departamento"),t.qZA(),t.TgZ(22,"mat-select",95),t.YNc(23,Et,2,2,"mat-option",93),t.qZA()(),t.TgZ(24,"mat-form-field",90)(25,"mat-label"),t._uU(26,"No. Comit\xe9 Contrataci\xf3n"),t.qZA(),t._UZ(27,"input",96),t.qZA(),t.TgZ(28,"mat-form-field",90)(29,"mat-label"),t._uU(30,"Fecha Acuerdo Comit\xe9 Contrataci\xf3n"),t.qZA(),t._UZ(31,"input",97),t.qZA()(),t.TgZ(32,"div",89)(33,"mat-form-field",90)(34,"mat-label"),t._uU(35,"Valor (CUP)"),t.qZA(),t.TgZ(36,"span",98),t._uU(37,"CUP"),t.qZA(),t._UZ(38,"input",99),t.qZA(),t.TgZ(39,"mat-form-field",90)(40,"mat-label"),t._uU(41,"Valor (USD)"),t.qZA(),t.TgZ(42,"span",98),t._uU(43,"$"),t.qZA(),t._UZ(44,"input",100),t.qZA(),t.TgZ(45,"mat-form-field",90)(46,"mat-label"),t._uU(47,"Fecha Firmado"),t.qZA(),t._UZ(48,"input",101),t.qZA(),t.TgZ(49,"mat-form-field",90)(50,"mat-label"),t._uU(51,"Fecha Comit\xe9 Contrataci\xf3n"),t.qZA(),t._UZ(52,"input",102),t.qZA(),t.TgZ(53,"mat-form-field",90)(54,"mat-label"),t._uU(55,"No. Acuerdo Comit\xe9 Contrataci\xf3n"),t.qZA(),t._UZ(56,"input",103),t.qZA(),t.TgZ(57,"mat-form-field",90)(58,"mat-label"),t._uU(59,"Fecha Comit\xe9 Administraci\xf3n"),t.qZA(),t._UZ(60,"input",104),t.qZA()(),t.TgZ(61,"div",89)(62,"mat-form-field",90)(63,"mat-label"),t._uU(64,"Vigencia"),t.qZA(),t.TgZ(65,"mat-select",105),t.YNc(66,Vt,2,2,"mat-option",57),t.qZA()(),t.TgZ(67,"mat-form-field",90)(68,"mat-label"),t._uU(69,"Observaciones"),t.qZA(),t._UZ(70,"textarea",106),t.qZA(),t.TgZ(71,"mat-form-field",90)(72,"mat-label"),t._uU(73,"Fecha Entrada"),t.qZA(),t._UZ(74,"input",107),t.qZA(),t.TgZ(75,"mat-form-field",90)(76,"mat-label"),t._uU(77,"Estado"),t.qZA(),t.TgZ(78,"mat-select",108)(79,"mat-option",67),t._uU(80,"Activo"),t.qZA(),t.TgZ(81,"mat-option",68),t._uU(82,"Casi a vencer"),t.qZA(),t.TgZ(83,"mat-option",69),t._uU(84,"Vencido"),t.qZA()()(),t.TgZ(85,"mat-form-field",90)(86,"mat-label"),t._uU(87,"No. Comit\xe9 Administraci\xf3n"),t.qZA(),t._UZ(88,"input",109),t.qZA()()(),t.TgZ(89,"div",110)(90,"button",111),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateSelectedContrato())}),t._uU(91," Actualizar "),t.qZA(),t.TgZ(92,"button",111),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteSelectedContrato())}),t._uU(93," Eliminar "),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.selectedContratoForm),t.xp6(11),t.Q6J("ngForOf",e.proveedores)("ngForTrackBy",e.trackByProveedor),t.xp6(5),t.Q6J("ngForOf",e.tiposContrato)("ngForTrackBy",e.trackByTipoContrato),t.xp6(5),t.Q6J("ngForOf",e.departamentos)("ngForTrackBy",e.trackByDepartamento),t.xp6(43),t.Q6J("ngForOf",e.vigencias),t.xp6(24),t.Q6J("color","primary"),t.xp6(2),t.Q6J("color","warn")}}function jt(o,r){1&o&&(t.TgZ(0,"div",112),t._uU(1," \xa1No hay contratos! "),t.qZA(),t.TgZ(2,"p",113),t._uU(3," Comienza agregando tu primer contrato al sistema "),t.qZA())}let $t=(()=>{class o{toggleFilters(){this.showFilters=!this.showFilters,this.cdr.detectChanges()}isColumnVisible(e){const n=this.columnSettings.find(i=>i.key===e);return!!n&&n.visible}isDepartamentosArray(){return Array.isArray(this.departamentos)}getVisibleColumns(){return this.columnSettings.filter(e=>e.visible)}updateDisplayedColumns(){this.displayedColumns=[...this.columnSettings.filter(e=>e.visible).map(e=>e.key),"details"]}getGridColumns(){return`${this.getVisibleColumns().map(()=>"minmax(120px, 1fr)").join(" ")} 100px`}getColumnValue(e,n){switch(n){case"estado":return e.estado||"";case"no_contrato":return e.no_contrato||"";case"proveedor":return e.proveedor?.nombre||"";case"tipo_contrato":return e.tipo_contrato?.nombre_tipo_contrato||"";case"departamento":return e.departamento?.nombre_departamento||"";case"valor_cup":return null!=e.valor_cup?`${e.valor_cup}`:"";case"valor_usd":return null!=e.valor_usd?`${e.valor_usd}`:"";case"fecha_entrada":return e.fecha_entrada?new Date(e.fecha_entrada).toLocaleDateString():"";case"fecha_firmado":return e.fecha_firmado?new Date(e.fecha_firmado).toLocaleDateString():"";case"vigencia":return e.vigencia?.vigencia?e.vigencia.vigencia.toString():"";case"tiempoRestante":return e.tiempoRestante||"";default:return""}}constructor(e,n,i,s,a,_,m,h){this.contratoService=e,this.tipocontratoervice=n,this.departamentoService=i,this.proveedorService=s,this.dialog=a,this.cdr=_,this.fb=m,this.exportService=h,this.data=[],this.proveedores=[],this.tiposContrato=[],this.vigencias=[],this.departamentos=[],this.showFilters=!1,this.estados=[{label:"Activo",color:"green"},{label:"Casi a vencer",color:"orange"},{label:"Vencido",color:"red"}],this.montoInicialCup=8e3,this.totalEjecutadoCup=6e3,this.montoRestanteCup=2e3,this.montoInicialUsd="-",this.totalEjecutadoUsd="-",this.montoRestanteUsd="-",this._unsubscribeAll=new j.x,this.columnSettings=[{key:"estado",label:"Estado",visible:!0,tooltip:"Estado del contrato"},{key:"no_contrato",label:"No. Contrato",visible:!0,tooltip:"N\xfamero del contrato"},{key:"proveedor",label:"Proveedor",visible:!0,tooltip:"Nombre del proveedor"},{key:"tipo_contrato",label:"Tipo de Contrato",visible:!0,tooltip:"Tipo de contrato"},{key:"departamento",label:"Departamento",visible:!0,tooltip:"Departamento asociado"},{key:"valor_cup",label:"Valor (CUP)",visible:!0,tooltip:"Valor en CUP"},{key:"valor_usd",label:"Valor (USD)",visible:!0,tooltip:"Valor en USD"},{key:"fecha_entrada",label:"Fecha Entrada",visible:!0,tooltip:"Fecha de entrada"},{key:"fecha_firmado",label:"Fecha Firmado",visible:!0,tooltip:"Fecha de firmado"},{key:"vigencia",label:"Vigencia",visible:!0,tooltip:"Vigencia del contrato"},{key:"tiempoRestante",label:"Tiempo Restante",visible:!0,tooltip:"Tiempo restante del contrato"}],this.showAddForm=!1,this.isAdding=!1,this.isLoading=!1,this.searchInputControl=new l.p4,this.dataSource=new D.by([]),this.noContracts=null,this.displayedColumns=["estado","no_contrato","proveedor","tipo_contrato","departamento","valor_cup","valor_usd","fecha_entrada","fecha_firmado","vigencia","details"],this.title="Contratos",this.addButtonText="Agregar Contrato",this.selectedContrato=null,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.showAdvancedFilters=!1,this.dataSource=new D.by([]),this.initSelectedContratoForm(),this.initNewContratoForm(),this.filterForm=this.fb.group({vigencia_id:[""],proveedor_id:[""],tipo_contrato_id:[""],departamento_id:[""],estado:[""],fecha_entrada:[""],fecha_firmado:[""],valor_minimo:[""],valor_maximo:[""],no_contrato_filter:[""],valor_cup_filter:[""],valor_usd_filter:[""],fecha_entrada_filter:[""],fecha_firmado_filter:[""]})}toggleAdvancedFilters(){this.showAdvancedFilters=!this.showAdvancedFilters}convertToArray(e){return e?Array.isArray(e)?e:"object"==typeof e?e.data&&Array.isArray(e.data)?e.data:e.items&&Array.isArray(e.items)?e.items:e.results&&Array.isArray(e.results)?e.results:e.list&&Array.isArray(e.list)?e.list:e.content&&Array.isArray(e.content)?e.content:Object.values(e):[]:[]}ngOnInit(){this.tiposContrato=[],this.vigencias=[],this.departamentos=[],this.proveedores=[],this.loadContratos(),this.tipocontratoervice.getTiposContrato().subscribe({next:e=>{console.log("Tipos de contrato raw:",e),this.tiposContrato=this.convertToArray(e),console.log("Tipos de contrato converted:",this.tiposContrato),this.cdr.detectChanges()},error:e=>{console.error("Error loading tipos contrato:",e),this.tiposContrato=[]}}),this.departamentoService.getDepartamentos().subscribe({next:e=>{console.log("Departamentos raw:",e),this.departamentos=this.convertToArray(e),console.log("Departamentos converted:",this.departamentos),this.cdr.detectChanges()},error:e=>{console.error("Error loading departamentos:",e),this.departamentos=[]}}),this.proveedorService.getProveedores().subscribe({next:e=>{console.log("Proveedores raw:",e);const n=this.convertToArray(e);this.proveedores=n.map(i=>({...i,municipio_id:i.municipio_id||null,ministerio_id:i.ministerio_id||null,fechaCreacion:i.fechaCreacion?new Date(i.fechaCreacion):null})),console.log("Proveedores converted:",this.proveedores),this.cdr.detectChanges()},error:e=>{console.error("Error loading proveedores:",e),this.proveedores=[]}}),this.contratoService.getDashboard().subscribe(e=>{console.log(e)}),this.contratoService.getDashboardcontrato().subscribe(e=>{console.log(e)}),this.dataSource.sortingDataAccessor=(e,n)=>{switch(n){case"proveedor":return e.proveedor?.nombre;case"tipo_contrato":return e.tipo_contrato?.nombre_tipo_contrato;case"departamento":return e.departamento?.nombre_departamento;case"vigencia":return e.vigencia?.vigencia;case"valor_cup":return e.valor_cup||0;case"valor_usd":return e.valor_usd||0;case"fecha_entrada":return e.fecha_entrada||"";case"fecha_firmado":return e.fecha_firmado||"";default:return e[n]}},this.dataSource.filterPredicate=(e,n)=>{if(!n)return!0;const i=n.toLowerCase().trim();return[e.no_contrato?.toString()||"",e.proveedor?.nombre?.toLowerCase()||"",e.tipo_contrato?.nombre_tipo_contrato?.toLowerCase()||"",e.departamento?.nombre_departamento?.toLowerCase()||"",e.estado?.toLowerCase()||"",e.valor_cup?.toString()||"",e.valor_usd?.toString()||"",e.fecha_entrada||"",e.fecha_firmado||"",void 0!==e.vigencia?.vigencia?e.vigencia.vigencia.toString():"",e.observaciones?.toLowerCase()||"","string"==typeof e.tiempoRestante?e.tiempoRestante.toLowerCase():""].join(" ").includes(i)},this.searchInputControl.valueChanges.pipe((0,I.R)(this._unsubscribeAll),(0,q.b)(300)).subscribe(e=>{this.closeDetails(),this.dataSource.filter=e?e.trim().toLowerCase():"",this.cdr.detectChanges()}),this.filterForm.valueChanges.pipe((0,I.R)(this._unsubscribeAll),(0,q.b)(300)).subscribe(()=>{this.applyFilters()})}loadContratos(){this.isLoading=!0,this.errorMessage="",this.contratoService.getContratos().subscribe({next:e=>{const n=Array.isArray(e)?e:e.data||[];if(console.log(n),!Array.isArray(n))return this.errorMessage="Error: contratos data is not an array.",this.isLoading=!1,void this.cdr.detectChanges();const s=n.map(a=>({...a,proveedor:a.Proveedor?{id:a.Proveedor.id,nombre:a.Proveedor.nombre,codigo:a.Proveedor.codigo,estado:a.Proveedor.estado,ministerio:a.Proveedor.ministerio,municipio:a.Proveedor.municipio,municipio_id:a.Proveedor.municipio_id||null,ministerio_id:a.Proveedor.ministerio_id||null,domicilio:a.Proveedor.domicilio||null,fechaCreacion:a.Proveedor.fechaCreacion?new Date(a.Proveedor.fechaCreacion):null,prefijo_provincia:a.Proveedor.prefijo_provincia,provincia:a.Proveedor.provincia,telefonos:a.Proveedor.telefonos,tipo_empresa:a.Proveedor.tipo_empresa,representante_legal_id:a.Proveedor.representante_legal_id,updatedAt:a.Proveedor.updatedAt?new Date(a.Proveedor.updatedAt):null,createdAt:a.Proveedor.createdAt?new Date(a.Proveedor.createdAt):null}:null,departamento:a.Departamento?{id:a.Departamento.id,nombre_departamento:a.Departamento.nombre,codigo:a.Departamento.codigo,descripcion:a.Departamento.descripcion,director:a.Departamento.director,email:a.Departamento.email,entidad_id:a.Departamento.entidad_id,estado:a.Departamento.estado,fecha_creacion:a.Departamento.fecha_creacion?new Date(a.Departamento.fecha_creacion):null,ministerio:a.Departamento.ministerio,presupuesto_anual:a.Departamento.presupuesto_anual,telefono:a.Departamento.telefono,updatedAt:a.Departamento.updatedAt?new Date(a.Departamento.updatedAt):null,createdAt:a.Departamento.createdAt?new Date(a.Departamento.createdAt):null}:null,tipo_contrato:a.TipoContrato?{id:a.TipoContrato.id,codigo:a.TipoContrato.codigo,descripcion:a.TipoContrato.descripcion,documentos_requeridos:a.TipoContrato.documentos_requeridos,duracion_maxima:a.TipoContrato.duracion_maxima,estado:a.TipoContrato.estado,nivel_aprobacion:a.TipoContrato.nivel_aprobacion,nombre_tipo_contrato:a.TipoContrato.nombre,observaciones:a.TipoContrato.observaciones,requiere_aprobacion:a.TipoContrato.requiere_aprobacion,updatedAt:a.TipoContrato.updatedAt?new Date(a.TipoContrato.updatedAt):null,createdAt:a.TipoContrato.createdAt?new Date(a.TipoContrato.createdAt):null}:null,vigencia:a.vigencia?{vigencia:a.vigencia}:a.TipoContrato&&a.TipoContrato.nombre?{vigencia:a.TipoContrato.nombre}:null,tiempoRestante:this.calcularTiempoRestante(a),estado:a.estado,no_contrato:a.no_contrato,valor_cup:a.valor?parseFloat(a.valor):0,valor_usd:a.valor_usd||0,fecha_entrada:a.fecha_inicio?new Date(a.fecha_inicio):null,fecha_firmado:a.fecha_firmado?new Date(a.fecha_firmado):null,observaciones:a.observaciones||"",id:a.id})).filter(a=>"Vencido"!==a.estado);this.data=s,this.dataSource.data=s,this.pagination.length=s.length,this.isLoading=!1,this.cdr.detectChanges()},error:e=>{this.errorMessage="Error al cargar los contratos. Por favor, intente nuevamente.",this.isLoading=!1,this.cdr.detectChanges()}})}onRightClick(e){e.preventDefault(),window.print()}print(){window.print()}applyFilters(){const e=this.filterForm.value;let n=this.dataSource.data;e.proveedor_id&&(n=n.filter(i=>i.proveedor.id===e.proveedor_id)),e.tipo_contrato_id&&(n=n.filter(i=>i.tipo_contrato?.id===e.tipo_contrato_id)),e.departamento_id&&(n=n.filter(i=>i.departamento?.id===e.departamento_id)),e.valor_cup_filter&&(n=n.filter(i=>i.valor_cup>=e.valor_cup_filter)),e.valor_usd_filter&&(n=n.filter(i=>i.valor_usd>=e.valor_usd_filter)),e.fecha_entrada_filter&&(n=n.filter(i=>new Date(i.fecha_entrada)>=new Date(e.fecha_entrada_filter))),e.fecha_firmado_filter&&(n=n.filter(i=>new Date(i.fecha_firmado)>=new Date(e.fecha_firmado_filter))),e.vigencia_id&&(n=n.filter(i=>i.vigencia.id===e.vigencia_id)),e.estado&&(n=n.filter(i=>i.estado===e.estado)),this.dataSource.filteredData=n}clearFilters(){this.filterForm.reset(),this.dataSource.filteredData=this.dataSource.data}toggleColumn(e){const n=this.columnSettings.find(i=>i.key===e);n&&(n.visible=!n.visible,this.updateDisplayedColumns(),this.cdr.detectChanges())}initSelectedContratoForm(){this.selectedContratoForm=this.fb.group({no_contrato:["",l.kI.required],proveedor:[null,l.kI.required],tipo_contrato:[null,l.kI.required],departamento:[null,l.kI.required],no_comite_contratacion:["",l.kI.required],fecha_comite_contratacion:["",l.kI.required],no_acuerdo_comite_contratacion:["",l.kI.required],fecha_acuerdo_comite_contratacion:["",l.kI.required],no_comite_administracion:["",l.kI.required],fecha_comite_administracion:["",l.kI.required],estado:["",l.kI.required],valor_cup:[0,[l.kI.required,l.kI.min(0)]],valor_usd:[0,[l.kI.min(0)]],fecha_firmado:["",l.kI.required],vigencia:[null,l.kI.required],observaciones:[""],fecha_vencido:[""]})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.paginator&&(this.paginator.pageSize=10,this.paginator.pageSizeOptions=[5,10,25,50]),this.dataSource.sort=this.sort,this.sort&&(this.sort.active="no_contrato",this.sort.direction="asc"),this.cdr.detectChanges()}calcularTiempoRestante(e){const n=new Date;let i=e.fecha_inicio?new Date(e.fecha_inicio):null,s=e.fecha_fin?new Date(e.fecha_fin):null;if(i&&s){const a=s.getTime()-n.getTime();if(a<0)return"Vencido";let _=a;const m=31536e6,h=2592e6,C=6048e5,b=864e5,x=Math.floor(_/m);_-=x*m;const u=Math.floor(_/h);_-=u*h;const f=Math.floor(_/C);_-=f*C;const g=Math.floor(_/b);let p="";return x>0&&(p+=x+(1===x?" a\xf1o":" a\xf1os")),u>0&&(p.length>0&&(p+=", "),p+=u+(1===u?" mes":" meses")),f>0&&(p.length>0&&(p+=", "),p+=f+(1===f?" semana":" semanas")),g>0&&(p.length>0&&(p+=" y "),p+=g+(1===g?" d\xeda":" d\xedas")),p||"Menos de un d\xeda"}if(e.fecha_vencido){const _=new Date(e.fecha_vencido).getTime()-n.getTime();if(_<0)return"Vencido";let m=_;const h=31536e6,C=2592e6,b=6048e5,x=864e5,u=Math.floor(m/h);m-=u*h;const f=Math.floor(m/C);m-=f*C;const g=Math.floor(m/b);m-=g*b;const p=Math.floor(m/x);let d="";return u>0&&(d+=u+(1===u?" a\xf1o":" a\xf1os")),f>0&&(d.length>0&&(d+=", "),d+=f+(1===f?" mes":" meses")),g>0&&(d.length>0&&(d+=", "),d+=g+(1===g?" semana":" semanas")),p>0&&(d.length>0&&(d+=" y "),d+=p+(1===p?" d\xeda":" d\xedas")),d||"Menos de un d\xeda"}if(e.fecha_firmado&&e.vigencia&&e.vigencia.vigencia){const a=new Date(e.fecha_firmado);a.setDate(a.getDate()+e.vigencia.vigencia);const _=a.getTime()-n.getTime();if(_<0)return"Vencido";let m=_;const h=31536e6,C=2592e6,b=6048e5,x=864e5,u=Math.floor(m/h);m-=u*h;const f=Math.floor(m/C);m-=f*C;const g=Math.floor(m/b);m-=g*b;const p=Math.floor(m/x);let d="";return u>0&&(d+=u+(1===u?" a\xf1o":" a\xf1os")),f>0&&(d.length>0&&(d+=", "),d+=f+(1===f?" mes":" meses")),g>0&&(d.length>0&&(d+=", "),d+=g+(1===g?" semana":" semanas")),p>0&&(d.length>0&&(d+=" y "),d+=p+(1===p?" d\xeda":" d\xedas")),d||"Menos de un d\xeda"}return"N/A"}trackByFn(e,n){return n.id}getNestedValue(e,n,i){return i&&e[n]?e[n][i]:e[n]||""}toggleDetails(e){this.selectedContrato?.id===e?this.selectedContrato=null:(this.selectedContrato=this.data.find(n=>n.id===e)||null,this.selectedContrato&&(this.selectedContratoForm||this.initSelectedContratoForm(),this.selectedContratoForm.patchValue({no_contrato:this.selectedContrato.no_contrato||"",proveedor:this.selectedContrato.proveedor||null,tipo_contrato:this.selectedContrato.tipo_contrato||null,departamento:this.selectedContrato.departamento||null,valor_cup:this.selectedContrato.valor_cup||0,valor_usd:this.selectedContrato.valor_usd||0,fecha_firmado:this.selectedContrato.fecha_firmado||"",vigencia:this.selectedContrato.vigencia||null,observaciones:this.selectedContrato.observaciones||"",fecha_vencido:this.selectedContrato.fecha_vencido||""}))),this.cdr.detectChanges()}closeDetails(){this.selectedContrato=null}openNewContratoDialog(){const e=window.innerWidth<=768;this.dialog.open(V._,{width:e?"90vw":"750px",maxWidth:e?"100vw":"90vw",height:e?"100vh":"90vh",maxHeight:"100vh",panelClass:"full-screen-dialog",disableClose:!1,autoFocus:!1,hasBackdrop:!e,position:e?{top:"0"}:{}}).afterClosed().subscribe(i=>{i&&this.loadContratos()})}initNewContratoForm(){this.newContratoForm=this.fb.group({no_contrato:["",l.kI.required],proveedor:[null,l.kI.required],tipo_contrato:[null,l.kI.required],valor_cup:[0,[l.kI.required,l.kI.min(0)]],valor_usd:[0,[l.kI.min(0)]],fecha_firmado:["",l.kI.required],vigencia:[null,l.kI.required],observaciones:[""],fecha_entrada:[(new Date).toISOString().split("T")[0]]})}toggleAddForm(){this.showAddForm=!this.showAddForm,this.showAddForm||(this.newContratoForm.reset(),this.initNewContratoForm()),this.cdr.markForCheck()}cancelAdd(){this.showAddForm=!1,this.newContratoForm.reset(),this.initNewContratoForm()}addNewContrato(){if(this.newContratoForm.invalid)return void this.newContratoForm.markAllAsTouched();this.isAdding=!0;const e=this.newContratoForm.value,n={...e,id:0,estado:"Activo",departamento:Q.iy[0],fecha_entrada:(new Date).toISOString().split("T")[0],fecha_vencido:this.calculateExpirationDate(e.fecha_firmado,e.vigencia.vigencia)};this.contratoService.createContrato(n).subscribe({next:()=>{this.isAdding=!1,this.showAddForm=!1,this.loadContratos(),this.newContratoForm.reset(),this.initNewContratoForm()},error:i=>{console.error("Error al crear el contrato:",i),this.isAdding=!1}})}calculateExpirationDate(e,n){if(!e||!n)return"";const i=new Date(e);return i.setDate(i.getDate()+n),i.toISOString().split("T")[0]}exportToPDF(){const n=this.dataSource.filteredData.map(i=>({no_contrato:i.no_contrato||"",proveedor:this.truncateText(i.proveedor?.nombre||"",20),tipo_contrato:this.truncateText(i.tipo_contrato?.nombre_tipo_contrato||"",15),departamento:this.truncateText(i.departamento?.nombre_departamento||"",15),valor_cup:this.formatNumber(i.valor_cup||0),valor_usd:this.formatNumber(i.valor_usd||0),fecha_entrada:this.formatDateForPDF(i.fecha_entrada),estado:i.estado||""}));this.exportService.exportToPDF(n,[{key:"no_contrato",label:"No. Contrato"},{key:"proveedor",label:"Proveedor"},{key:"tipo_contrato",label:"Tipo"},{key:"departamento",label:"Departamento"},{key:"valor_cup",label:"Valor CUP"},{key:"valor_usd",label:"Valor USD"},{key:"fecha_entrada",label:"F. Entrada"},{key:"estado",label:"Estado"}],"Reporte de Contratos","assets/images/logo/logo.jpg")}formatNumber(e){return e&&0!==e?new Intl.NumberFormat("es-ES",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"0"}formatCurrencyForPDF(e,n){return e&&0!==e?`${n} ${new Intl.NumberFormat("es-ES",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}`:`${n} 0`}formatDateForPDF(e){if(!e)return"";try{let n;if(e instanceof Date)n=e;else{if("string"!=typeof e)return"";n=new Date(e)}return isNaN(n.getTime())?"":n.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit"})}catch{return""}}formatDateForCSV(e){if(!e)return"";try{let n;if(e instanceof Date)n=e;else{if("string"!=typeof e)return"";n=new Date(e)}return isNaN(n.getTime())?"":n.toLocaleDateString("es-ES")}catch{return""}}truncateText(e,n){return e?e.length<=n?e:e.substring(0,n-3)+"...":""}exportToCSV(){const n=this.dataSource.filteredData.map(i=>({no_contrato:i.no_contrato,proveedor:i.proveedor?.nombre||"",tipo_contrato:i.tipo_contrato?.nombre_tipo_contrato||"",departamento:i.departamento?.nombre_departamento||"",valor_cup:i.valor_cup,valor_usd:i.valor_usd,fecha_entrada:i.fecha_entrada,fecha_firmado:i.fecha_firmado,vigencia:i.vigencia?.vigencia,tiempoRestante:i.tiempoRestante||"",estado:i.estado||"",observaciones:i.observaciones||""}));this.exportService.exportToExcel(n,[{key:"no_contrato",label:"No. Contrato"},{key:"proveedor",label:"Proveedor"},{key:"tipo_contrato",label:"Tipo de Contrato"},{key:"departamento",label:"Departamento"},{key:"valor_cup",label:"Valor (CUP)"},{key:"valor_usd",label:"Valor (USD)"},{key:"fecha_entrada",label:"Fecha Entrada"},{key:"fecha_firmado",label:"Fecha Firmado"},{key:"vigencia",label:"Vigencia"},{key:"tiempoRestante",label:"Tiempo Restante"},{key:"estado",label:"Estado"},{key:"observaciones",label:"Observaciones"}],"contratos_export.csv")}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36($.d),t.Y36(R.u),t.Y36(z),t.Y36(G.z),t.Y36(B.uw),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(K.T))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-contrato-list"]],viewQuery:function(n,i){if(1&n&&(t.Gf(W,5,T.p6),t.Gf(U.YE,5),t.Gf(k.NW,5)),2&n){let s;t.iGM(s=t.CRH())&&(i.columnMenuTrigger=s.first),t.iGM(s=t.CRH())&&(i.sort=s.first),t.iGM(s=t.CRH())&&(i.paginator=s.first)}},standalone:!0,features:[t.jDz],decls:85,vars:33,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"absolute","bottom-0","right-0","w-24","h-24","-m-6"],[1,"icon-size-24","opacity-25","text-green-500","dark:text-green-400",3,"svgIcon"],[1,"flex","flex-row","flex-wrap","mt-4","-mx-6"],[1,"flex","flex-col","mx-6","my-3"],[1,"text-sm","font-medium","leading-none","text-secondary"],[1,"mt-2","font-medium","text-3xl","leading-none"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-col","sm:flex-row","shrink-0","items-center","justify-between","py-4","px-6","md:px-8","border-b"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","items-center","gap-4","mt-4","sm:mt-0"],["mat-flat-button","",1,"text-lg",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-icon-button","","matTooltip","Configurar columnas",1,"ml-2","mt-4","sm:mt-0",3,"matMenuTriggerFor","color"],["columnMenuTrigger","matMenuTrigger"],[1,"column-menu"],["columnMenu","matMenu"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-300","border-b"],[1,"p-2",3,"click"],["class","flex items-center py-1 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",3,"click",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Exportar tabla","aria-label","Exportar tabla",1,"ml-4","mt-4","sm:mt-0",3,"matMenuTriggerFor","color"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","","color","primary","matTooltip","Imprimir","aria-label","Imprimir",1,"ml-2","mt-4","sm:mt-0",3,"click"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto",2,"cursor","context-menu",3,"contextmenu"],[4,"ngIf","ngIfElse"],["rowDetailsTemplate",""],["noContracts",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"flex","items-center","py-1","px-2","hover:bg-gray-100","dark:hover:bg-gray-700","rounded",3,"click"],[3,"checked","color","change","click"],[1,"flex","flex-col","h-full","overflow-y-auto"],["matSort","","matSortDisableClear","",1,"inventory-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],["sticky","",3,"mat-sort-header","matTooltip",4,"ngFor","ngForOf"],["sticky","",2,"position","sticky","right","0","background","inherit","z-index","10","min-width","100px","max-width","100px"],["class","inventory-grid grid gap-4 py-3 px-6 md:px-8 border-b bg-gray-50 dark:bg-gray-800",3,"grid-template-columns","formGroup",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["sticky","",3,"mat-sort-header","matTooltip"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","bg-gray-50","dark:bg-gray-800",3,"formGroup"],[4,"ngFor","ngForOf"],[3,"ngSwitch"],["appearance","outline","class","w-full","subscriptSizing","dynamic",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","No. Contrato","formControlName","no_contrato_filter"],["formControlName","proveedor_id","placeholder","Proveedor"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","tipo_contrato_id","placeholder","Tipo"],["formControlName","departamento_id","placeholder","Departamento"],["matInput","","type","number","placeholder","Valor CUP","formControlName","valor_cup_filter"],["matInput","","type","number","placeholder","Valor USD","formControlName","valor_usd_filter"],["matInput","","type","date","formControlName","fecha_entrada_filter"],["matInput","","type","date","formControlName","fecha_firmado_filter"],["formControlName","vigencia_id","placeholder","Vigencia"],["formControlName","estado","placeholder","Estado"],["value","Activo"],["value","Casi a vencer"],["value","Vencido"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","items-center","text-m"],[4,"ngIf"],["class","truncate",4,"ngIf"],["class","truncate","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],["class","truncate text-red-600 dark:text-sky-400",4,"ngIf"],[1,"flex","items-center","justify-center","sticky-end"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","whitespace-nowrap",3,"click"],[1,"icon-size-5",3,"svgIcon"],["class","grid",4,"ngIf"],[1,"w-3","h-3","rounded-full","inline-block",3,"ngClass"],[1,"truncate"],["matTooltipPosition","above",1,"truncate",3,"matTooltip"],[1,"truncate","text-red-600","dark:text-sky-400"],[1,"grid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"responsive-form","flex","flex-col","w-full","mx-auto","p-8",3,"formGroup"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-1/3","sm:pl-8"],[1,"w-full"],["matInput","","formControlName","no_contrato"],["formControlName","proveedor"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["formControlName","tipo_contrato"],["formControlName","departamento"],["matInput","","formControlName","no_comite_contratacion"],["matInput","","type","date","formControlName","fecha_acuerdo_comite_contratacion"],["matPrefix",""],["matInput","","type","number","formControlName","valor_cup"],["matInput","","type","number","formControlName","valor_usd"],["matInput","","type","date","formControlName","fecha_firmado"],["matInput","","type","date","formControlName","fecha_comite_contratacion"],["matInput","","formControlName","no_acuerdo_comite_contratacion"],["matInput","","type","date","formControlName","fecha_comite_administracion"],["formControlName","vigencia"],["matInput","","formControlName","observaciones"],["matInput","","type","date","formControlName","fecha_entrada"],["formControlName","estado"],["matInput","","formControlName","no_comite_administracion"],[1,"flex","flex-col","sm:flex-row","items-center","justify-end","w-full","border-t","px-4","py-4","gap-3"],["mat-stroked-button","",1,"w-full","sm:w-auto","px-6",3,"color","click"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"],[1,"text-gray-500","mb-6","text-center"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"mat-icon",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6),t._uU(7," Monto Inicial CUP "),t.qZA(),t.TgZ(8,"div",7),t._uU(9),t.ALo(10,"currency"),t.qZA()(),t.TgZ(11,"div",5)(12,"div",6),t._uU(13," Total Ejecutado CUP "),t.qZA(),t.TgZ(14,"div",7),t._uU(15),t.ALo(16,"currency"),t.qZA()(),t.TgZ(17,"div",5)(18,"div",6),t._uU(19," Monto Restante CUP "),t.qZA(),t.TgZ(20,"div",7),t._uU(21),t.ALo(22,"currency"),t.qZA()(),t.TgZ(23,"div",5)(24,"div",6),t._uU(25," Monto Inicial USD "),t.qZA(),t.TgZ(26,"div",7),t._uU(27),t.qZA()(),t.TgZ(28,"div",5)(29,"div",6),t._uU(30," Total Ejecutado USD "),t.qZA(),t.TgZ(31,"div",7),t._uU(32),t.qZA()(),t.TgZ(33,"div",5)(34,"div",6),t._uU(35," Monto Restante USD "),t.qZA(),t.TgZ(36,"div",7),t._uU(37),t.qZA()()()(),t.TgZ(38,"div",8)(39,"div",9),t.YNc(40,X,2,1,"div",10),t.TgZ(41,"div",11),t._uU(42,"Contratos"),t.qZA()(),t.TgZ(43,"div",12)(44,"mat-form-field",13),t._UZ(45,"mat-icon",14)(46,"input",15),t.qZA(),t.TgZ(47,"div",16)(48,"button",17),t.NdJ("click",function(){return i.openNewContratoDialog()}),t._UZ(49,"mat-icon",18),t.TgZ(50,"span",19),t._uU(51,"Agregar"),t.qZA()(),t.TgZ(52,"button",20,21),t._UZ(54,"mat-icon",18),t.qZA(),t.TgZ(55,"mat-menu",22,23)(57,"div",24),t._uU(58," Mostrar Columnas "),t.qZA(),t.TgZ(59,"div",25),t.NdJ("click",function(a){return a.stopPropagation()}),t.YNc(60,tt,3,3,"div",26),t.qZA()(),t.TgZ(61,"button",27),t._UZ(62,"mat-icon",18),t.qZA(),t.TgZ(63,"mat-menu",null,28)(65,"button",29),t.NdJ("click",function(){return i.exportToCSV()}),t.TgZ(66,"mat-icon"),t._uU(67,"description"),t.qZA(),t.TgZ(68,"span"),t._uU(69,"Exportar a CSV"),t.qZA()(),t.TgZ(70,"button",29),t.NdJ("click",function(){return i.exportToPDF()}),t.TgZ(71,"mat-icon"),t._uU(72,"table_chart"),t.qZA(),t.TgZ(73,"span"),t._uU(74,"Exportar a PDF"),t.qZA()()(),t.TgZ(75,"button",30),t.NdJ("click",function(){return i.print()}),t.TgZ(76,"mat-icon"),t._uU(77,"print"),t.qZA()()()(),t.TgZ(78,"div",31)(79,"div",32),t.NdJ("contextmenu",function(a){return i.onRightClick(a)}),t.YNc(80,Qt,10,15,"ng-container",33)(81,Ot,94,10,"ng-template",null,34,t.W1O)(83,jt,4,0,"ng-template",null,35,t.W1O),t.qZA()()()()),2&n){const s=t.MAs(56),a=t.MAs(64),_=t.MAs(84);t.xp6(3),t.Q6J("svgIcon","heroicons_outline:check-circle"),t.xp6(6),t.hij(" ",t.xi3(10,24,i.montoInicialCup,"CUP")," "),t.xp6(6),t.hij(" ",t.xi3(16,27,i.totalEjecutadoCup,"CUP")," "),t.xp6(6),t.hij(" ",t.xi3(22,30,i.montoRestanteCup,"CUP")," "),t.xp6(6),t.hij(" ",i.montoInicialUsd," "),t.xp6(5),t.hij(" ",i.totalEjecutadoUsd," "),t.xp6(5),t.hij(" ",i.montoRestanteUsd," "),t.xp6(3),t.Q6J("ngIf",i.isLoading),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar contratos"),t.xp6(2),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(3),t.Q6J("matMenuTriggerFor",s)("color","primary"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:view-columns"),t.xp6(6),t.Q6J("ngForOf",i.columnSettings),t.xp6(1),t.Q6J("matMenuTriggerFor",a)("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:arrow-up-tray"),t.xp6(18),t.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",_)}},dependencies:[v.ez,v.mk,v.sg,v.O5,v.tP,v.RF,v.n9,v.ED,v.H9,v.uU,F.ot,F.lW,F.RK,S.Cv,S.pW,U.JX,U.YE,U.nU,D.p0,N.Ps,N.Hw,l.UX,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.oH,l.sg,l.u,k.TU,k.NW,w.lN,w.KE,w.hX,w.qo,L.c,L.Nt,J.LD,J.gD,H.ey,T.Tx,T.VK,T.OP,T.p6,P.AV,P.gM,O.t,M.p9,M.oG],styles:['@charset "UTF-8";.inventory-grid>.sticky-end{position:sticky;right:0;background:inherit;z-index:20;min-width:100px;max-width:100px;display:flex;justify-content:center;align-items:center}.inventory-grid.z-10>.sticky-end{z-index:30;background:inherit}.flex-auto.overflow-x-auto{position:relative}.inventory-grid>.sticky-end>button{position:relative;z-index:40}.toggle-filters-button{margin-bottom:1rem}\n'],encapsulation:2,changeDetection:0})}return o})()}}]);