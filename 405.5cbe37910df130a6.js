"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[405],{5405:(le,U,c)=>{c.r(U),c.d(U,{ContratosRoutingModule:()=>se});var A=c(1896),F=c(6117),m=c(3566),f=c(1476),d=c(5313),s=c(6223),x=c(6306),I=c(7398),q=c(3620),Q=c(3997),N=c(9773),p=c(6814),C=c(2296),b=c(6007),y=c(617),_=c(4170),Z=c(4516),E=c(8525),T=c(7988),D=c(6385),S=c(5986),R=c(8645),w=c(9315),v=c(2096),M=c(7668),t=c(9212),j=c(2022),L=c(9862);let O=(()=>{class o{constructor(e){this.http=e}getEjecuciones(){return this.http.get(j.P.EJECUCIONES_CONTRATO).pipe((0,I.U)(e=>e.data||[]),(0,x.K)(e=>(console.error("Error fetching ejecuciones:",e),(0,v.of)([]))))}addEjecucion(e){return this.http.post(j.P.EJECUCIONES_CONTRATO,e).pipe((0,x.K)(n=>{throw console.error("Error adding ejecucion:",n),n}))}updateEjecucion(e){return this.http.put(`${j.P.EJECUCIONES_CONTRATO}/${e.id}`,e).pipe((0,x.K)(n=>{throw console.error("Error updating ejecucion:",n),n}))}deleteEjecucion(e){return this.http.delete(`${j.P.EJECUCIONES_CONTRATO}/${e}`).pipe((0,x.K)(n=>{throw console.error("Error deleting ejecucion:",n),n}))}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(L.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var P=c(7700),k=c(5170),V=c(3018);function z(o,r){1&o&&(t.TgZ(0,"div",27),t._UZ(1,"mat-progress-bar",28),t.qZA()),2&o&&(t.xp6(1),t.Q6J("mode","indeterminate"))}function B(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleColumn(a.key))}),t.TgZ(1,"mat-checkbox",30),t.NdJ("click",function(i){return i.stopPropagation()})("change",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleColumn(a.key))}),t._uU(2),t.qZA()()}if(2&o){const e=r.$implicit,n=t.oxw();t.xp6(1),t.Q6J("checked",n.selectedColumns.includes(e.key)),t.xp6(1),t.hij(" ",e.label," ")}}function Y(o,r){1&o&&(t.TgZ(0,"div",37),t._uU(1,"Proveedor"),t.qZA()),2&o&&t.Q6J("mat-sort-header","proveedor")}function $(o,r){1&o&&(t.TgZ(0,"div",37),t._uU(1,"Contrato"),t.qZA()),2&o&&t.Q6J("mat-sort-header","contrato")}function H(o,r){1&o&&(t.TgZ(0,"div",37),t._uU(1,"Costo (CUP)"),t.qZA()),2&o&&t.Q6J("mat-sort-header","costo_cup")}function G(o,r){1&o&&(t.TgZ(0,"div",37),t._uU(1,"Costo (USD)"),t.qZA()),2&o&&t.Q6J("mat-sort-header","costo_usd")}function K(o,r){1&o&&(t.TgZ(0,"div",37),t._uU(1,"Trabajo Ejecutado"),t.qZA()),2&o&&t.Q6J("mat-sort-header","trabajo_ejecutado")}function W(o,r){1&o&&(t.TgZ(0,"div",37),t._uU(1,"Fecha Ejecuci\xf3n"),t.qZA()),2&o&&t.Q6J("mat-sort-header","fecha_ejecucion")}function X(o,r){if(1&o&&(t.TgZ(0,"div",45),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu((null==e.Proveedor?null:e.Proveedor.nombre)||"Sin proveedor")}}function tt(o,r){if(1&o&&(t.TgZ(0,"div",45),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu((null==e.Contrato?null:e.Contrato.no_contrato)||"Sin contrato")}}function et(o,r){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.gM2(2,1,e.costo_cup,"CUP","symbol","1.2-2"))}}function ot(o,r){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.gM2(2,1,e.costo_usd,"USD","symbol","1.2-2"))}}function nt(o,r){if(1&o&&(t.TgZ(0,"div",45),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.trabajo_ejecutado||"N/A")}}function it(o,r){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.fecha_ejecucion,"shortDate"))}}function rt(o,r){1&o&&t.GkF(0)}const at=o=>({$implicit:o});function ct(o,r){if(1&o&&(t.ynx(0),t.YNc(1,rt,1,0,"ng-container",46),t.BQk()),2&o){const e=t.oxw().$implicit;t.oxw(2);const n=t.MAs(70);t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(2,at,e))}}function st(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",38),t.YNc(2,X,2,1,"div",39)(3,tt,2,1,"div",39)(4,et,3,6,"div",40)(5,ot,3,6,"div",40)(6,nt,2,1,"div",39)(7,it,3,4,"div",40),t.TgZ(8,"div",41)(9,"button",42),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.toggleDetails(a.id))}),t._UZ(10,"mat-icon",43),t.qZA()()(),t.TgZ(11,"div",44),t.YNc(12,ct,2,4,"ng-container",40),t.qZA(),t.BQk()}if(2&o){const e=r.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("ngIf",n.selectedColumns.includes("proveedor")),t.xp6(1),t.Q6J("ngIf",n.selectedColumns.includes("contrato")),t.xp6(1),t.Q6J("ngIf",n.selectedColumns.includes("costo_cup")),t.xp6(1),t.Q6J("ngIf",n.selectedColumns.includes("costo_usd")),t.xp6(1),t.Q6J("ngIf",n.selectedColumns.includes("trabajo_ejecutado")),t.xp6(1),t.Q6J("ngIf",n.selectedColumns.includes("fecha_ejecucion")),t.xp6(3),t.Q6J("svgIcon",(null==n.selectedRow?null:n.selectedRow.id)===e.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),t.xp6(2),t.Q6J("ngIf",(null==n.selectedRow?null:n.selectedRow.id)===e.id)}}const dt=o=>({"pointer-events-none":o}),lt=()=>[5,10,25,100];function pt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"div",31)(2,"div",32),t.YNc(3,Y,2,1,"div",33)(4,$,2,1,"div",33)(5,H,2,1,"div",33)(6,G,2,1,"div",33)(7,K,2,1,"div",33)(8,W,2,1,"div",33),t.TgZ(9,"div",34),t._uU(10,"Detalles"),t.qZA()(),t.YNc(11,st,13,8,"ng-container",35),t.qZA(),t._UZ(12,"mat-paginator",36),t.BQk()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.selectedColumns.includes("proveedor")),t.xp6(1),t.Q6J("ngIf",e.selectedColumns.includes("contrato")),t.xp6(1),t.Q6J("ngIf",e.selectedColumns.includes("costo_cup")),t.xp6(1),t.Q6J("ngIf",e.selectedColumns.includes("costo_usd")),t.xp6(1),t.Q6J("ngIf",e.selectedColumns.includes("trabajo_ejecutado")),t.xp6(1),t.Q6J("ngIf",e.selectedColumns.includes("fecha_ejecucion")),t.xp6(3),t.Q6J("ngForOf",e.dataSource.filteredData)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngClass",t.VKq(14,dt,e.isLoading))("length",e.pagination.length)("pageIndex",e.pagination.page)("pageSize",e.pagination.size)("pageSizeOptions",t.DdM(16,lt))("showFirstLastButtons",!0)}}function ut(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",47)(1,"div",48)(2,"form",49)(3,"div",50)(4,"div",51)(5,"div",52)(6,"mat-form-field",53)(7,"mat-label"),t._uU(8,"Proveedor"),t.qZA(),t._UZ(9,"input",54),t.qZA(),t.TgZ(10,"mat-form-field",53)(11,"mat-label"),t._uU(12,"Contrato"),t.qZA(),t._UZ(13,"input",55),t.qZA(),t.TgZ(14,"mat-form-field",53)(15,"mat-label"),t._uU(16,"Costo (CUP)"),t.qZA(),t.TgZ(17,"span",56),t._uU(18,"CUP"),t.qZA(),t._UZ(19,"input",57),t.qZA()(),t.TgZ(20,"div",58)(21,"mat-form-field",53)(22,"mat-label"),t._uU(23,"Costo (USD)"),t.qZA(),t.TgZ(24,"span",56),t._uU(25,"USD"),t.qZA(),t._UZ(26,"input",59),t.qZA(),t.TgZ(27,"mat-form-field",53)(28,"mat-label"),t._uU(29,"Trabajo Ejecutado"),t.qZA(),t._UZ(30,"input",60),t.qZA(),t.TgZ(31,"mat-form-field",53)(32,"mat-label"),t._uU(33,"Fecha Ejecuci\xf3n"),t.qZA(),t._UZ(34,"input",61),t.qZA()()()(),t.TgZ(35,"div",62)(36,"div",63)(37,"button",64),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateSelectedRecord())}),t._uU(38," Actualizar "),t.qZA(),t.TgZ(39,"button",65),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteSelectedRecord())}),t._uU(40," Eliminar "),t.qZA()()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.selectedRowForm),t.xp6(7),t.Q6J("disabled",!0),t.xp6(4),t.Q6J("disabled",!0)}}function mt(o,r){1&o&&(t.TgZ(0,"div",66),t._uU(1,"\xa1No hay ejecuciones!"),t.qZA())}let gt=(()=>{class o{constructor(e,n,i,a,l){this.ejecucionService=e,this.dialog=n,this.cdr=i,this.contratoService=a,this.proveedorService=l,this.data=[],this.montoInicialCup=0,this.totalEjecutadoCup=0,this.montoRestanteCup=0,this.montoInicialUsd="0.00",this.totalEjecutadoUsd="0.00",this.montoRestanteUsd="0.00",this.proveedores=[],this.contratos=[],this.columns=[{key:"proveedor",label:"Proveedor",nestedKey:"nombre",editable:!1},{key:"contrato",label:"Contrato",nestedKey:"no_contrato",editable:!1},{key:"costo_cup",label:"Costo (CUP)",type:"currency",editable:!0},{key:"costo_usd",label:"Costo (USD)",type:"currency",editable:!0},{key:"trabajo_ejecutado",label:"Trabajo Ejecutado",editable:!0},{key:"fecha_ejecucion",label:"Fecha Ejecuci\xf3n",type:"date",editable:!0}],this.selectedColumns=this.columns.map(h=>h.key),this._unsubscribeAll=new R.x,this.title="Ejecuci\xf3n de Contratos",this.addButtonText="Agregar Ejecuci\xf3n",this.displayedColumns=[],this.searchInputControl=new s.NI(""),this.selectedRow=null,this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.dataSource=new d.by([]),this.selectedRowForm=new s.cw({})}ngOnInit(){const e=localStorage.getItem("ejecucionContratoColumns");e&&(this.selectedColumns=JSON.parse(e)),this.updateDisplayedColumns(),this.loadInitialData(),this.setupSearch()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}loadInitialData(){this.isLoading=!0,this.errorMessage="",console.log("Starting loadInitialData"),(0,w.D)([this.ejecucionService.getEjecuciones(),this.contratoService.getContratos(),this.proveedorService.getProveedores().pipe((0,x.K)(e=>(console.error("Error fetching proveedores:",e),(0,v.of)([]))))]).subscribe({next:([e,n,i])=>{console.log("Ejecuciones response:",e),console.log("Contratos response:",n),console.log("Proveedores response:",i),this.data=e,this.contratos=n,this.proveedores=i,console.log("Assigned this.data:",this.data),console.log("Assigned this.contratos:",this.contratos),console.log("Assigned this.proveedores:",this.proveedores),this.data.length>0?this.enrichDataWithContractAndProvider().subscribe({next:a=>{console.log("Enriched data:",a),this.data=a,this.dataSource.data=a,console.log("dataSource.data:",this.dataSource.data),this.pagination.length=this.data.length,this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.calculateTotals(),this.isLoading=!1,this.cdr.markForCheck(),console.log("Data loaded, change detection triggered")},error:a=>{console.error("Error enriching data:",a),this.errorMessage="Error enriching data",this.isLoading=!1,this.cdr.markForCheck()}}):(console.log("No ejecuciones to enrich, setting empty data"),this.dataSource.data=[],this.pagination.length=0,this.calculateTotals(),this.isLoading=!1,this.cdr.markForCheck())},error:e=>{console.error("Error in loadInitialData:",e),this.errorMessage="Error loading initial data",this.data=[],this.dataSource.data=[],this.pagination.length=0,this.isLoading=!1,this.cdr.markForCheck()}})}enrichDataWithContractAndProvider(){if(!Array.isArray(this.data))return console.error("this.data is not an array:",this.data),(0,v.of)([]);console.log("Enriching data for",this.data.length,"ejecuciones");const e=this.data.map(i=>i.Contrato?(0,v.of)(i.Contrato):this.contratoService.getContratoById(i.contrato_id).pipe((0,x.K)(a=>(console.error(`Error fetching contrato ${i.contrato_id}:`,a),(0,v.of)({id:i.contrato_id,no_contrato:"Unknown"}))))),n=this.data.map(i=>i.Proveedor?(0,v.of)(i.Proveedor):this.proveedorService.getProveedor(i.proveedor_id).pipe((0,x.K)(a=>(console.error(`Error fetching proveedor ${i.proveedor_id}:`,a),(0,v.of)({id:i.proveedor_id,nombre:"Unknown"})))));return(0,w.D)([(0,w.D)(e),(0,w.D)(n)]).pipe((0,I.U)(([i,a])=>{const l=this.data.map((h,u)=>({...h,Contrato:i[u]||{id:h.contrato_id,no_contrato:"Unknown"},Proveedor:a[u]||{id:h.proveedor_id,nombre:"Unknown"}}));return console.log("Enriched data result:",l),l}))}calculateTotals(){this.totalEjecutadoCup=this.data.reduce((e,n)=>e+parseFloat(n.costo_cup||"0"),0),this.totalEjecutadoUsd=this.data.reduce((e,n)=>e+parseFloat(n.costo_usd||"0"),0).toFixed(2),this.montoInicialCup=this.totalEjecutadoCup+this.montoRestanteCup,this.montoRestanteCup=this.montoInicialCup-this.totalEjecutadoCup,this.montoInicialUsd="0.00",this.montoRestanteUsd="0.00"}setupSearch(){this.searchInputControl.valueChanges.pipe((0,q.b)(300),(0,Q.x)(),(0,N.R)(this._unsubscribeAll)).subscribe(e=>{this.dataSource.filter=e?.trim().toLowerCase()||"",this.cdr.markForCheck(),this.dataSource._updateChangeSubscription()}),this.dataSource.filterPredicate=(e,n)=>this.selectedColumns.reduce((a,l)=>a+(this.getNestedValue(e,l,this.columns.find(u=>u.key===l)?.nestedKey)||"")+" ","").toLowerCase().includes(n)}trackByFn(e,n){return n.id}getNestedValue(e,n,i){return i&&e[n]?e[n][i]||"":e[n]||""}toggleDetails(e){this.selectedRow=this.selectedRow?.id===e?null:this.data.find(n=>n.id===e)||null,this.selectedRowForm=new s.cw({proveedor:new s.NI({value:this.selectedRow?.Proveedor?.nombre||"Sin proveedor",disabled:!0}),contrato:new s.NI({value:this.selectedRow?.Contrato?.no_contrato||"Sin contrato",disabled:!0}),costo_cup:new s.NI(this.selectedRow?.costo_cup),costo_usd:new s.NI(this.selectedRow?.costo_usd),trabajo_ejecutado:new s.NI(this.selectedRow?.trabajo_ejecutado),fecha_ejecucion:new s.NI(this.selectedRow?.fecha_ejecucion)}),this.cdr.markForCheck()}createRecord(){this.dialog.open(M.h,{width:"30%",height:"90%",disableClose:!1,data:{mode:"create",contratos:this.contratos,proveedores:this.proveedores}}).afterClosed().subscribe(n=>{n&&this.ejecucionService.addEjecucion(n).subscribe({next:()=>this.loadInitialData(),error:i=>{console.error("Error creating ejecucion:",i),this.errorMessage="Error creating ejecucion",this.cdr.markForCheck()}})})}updateSelectedRecord(){if(this.selectedRow&&this.selectedRowForm.valid){const e={...this.selectedRow,costo_cup:this.selectedRowForm.get("costo_cup")?.value,costo_usd:this.selectedRowForm.get("costo_usd")?.value,trabajo_ejecutado:this.selectedRowForm.get("trabajo_ejecutado")?.value,fecha_ejecucion:this.selectedRowForm.get("fecha_ejecucion")?.value};this.ejecucionService.updateEjecucion(e).subscribe({next:()=>{this.loadInitialData(),this.selectedRow=null,this.cdr.markForCheck()},error:n=>{console.error("Error updating ejecucion:",n),this.errorMessage="Error updating ejecucion",this.cdr.markForCheck()}})}}deleteSelectedRecord(){this.selectedRow&&this.ejecucionService.deleteEjecucion(this.selectedRow.id).subscribe({next:()=>{this.loadInitialData(),this.selectedRow=null,this.cdr.markForCheck()},error:e=>{console.error("Error deleting ejecucion:",e),this.errorMessage="Error deleting ejecucion",this.cdr.markForCheck()}})}exportToCSV(){if(!this.dataSource.filteredData||0===this.dataSource.filteredData.length)return void console.log("No data to export");const e=[],n=this.selectedColumns.map(u=>this.columns.find(J=>J.key===u)?.label||u);e.push(n.join(",")),this.dataSource.filteredData.forEach(u=>{const de=this.selectedColumns.map(g=>"proveedor"===g?u.Proveedor?.nombre||"Sin proveedor":"contrato"===g?u.Contrato?.no_contrato||"Sin contrato":"costo_cup"===g?u.costo_cup:"costo_usd"===g?u.costo_usd:"trabajo_ejecutado"===g?u.trabajo_ejecutado||"":"fecha_ejecucion"===g&&u.fecha_ejecucion||"").map(g=>"string"==typeof g&&(g.includes(",")||g.includes('"'))?`"${g.replace(/"/g,'""')}"`:g);e.push(de.join(","))});const i=e.join("\n"),a=new Blob([i],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(a),h=document.createElement("a");h.href=l,h.download="ejecuciones_export.csv",h.click(),window.URL.revokeObjectURL(l)}printTable(){window.print()}toggleColumn(e){this.selectedColumns.includes(e)?this.selectedColumns=this.selectedColumns.filter(n=>n!==e):this.selectedColumns.push(e),localStorage.setItem("ejecucionContratoColumns",JSON.stringify(this.selectedColumns)),this.updateDisplayedColumns(),this.cdr.markForCheck()}updateDisplayedColumns(){this.displayedColumns=[...this.selectedColumns,"details"]}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(O),t.Y36(P.uw),t.Y36(t.sBO),t.Y36(k.d),t.Y36(V.z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-ejecucion-contrato"]],viewQuery:function(n,i){if(1&n&&(t.Gf(m.YE,5),t.Gf(f.NW,5)),2&n){let a;t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first)}},standalone:!0,features:[t.jDz],decls:73,vars:49,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"flex","flex-row","flex-wrap","mt-4","-mx-6"],[1,"flex","flex-col","mx-6","my-3"],[1,"text-sm","font-medium","leading-none","text-secondary"],[1,"mt-2","font-medium","text-3xl","leading-none"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-col","sm:flex-row","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4","search-add-wrapper"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","mt-4","sm:mt-0","w-40","text-lg",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-icon-button","","matTooltip","Exportar tabla a CSV","aria-label","Exportar tabla a CSV",1,"ml-4","mt-4","sm:mt-0",3,"color","click"],["mat-icon-button","","matTooltip","Imprimir tabla","aria-label","Imprimir tabla",1,"ml-4","mt-4","sm:mt-0",3,"color","click"],["mat-icon-button","","matTooltip","Seleccionar columnas","aria-label","Seleccionar columnas",1,"ml-4","mt-4","sm:mt-0",3,"color","matMenuTriggerFor"],["columnMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["rowDetailsTemplate",""],["noEjecucionesTemplate",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],["mat-menu-item","",3,"click"],[3,"checked","click","change"],[1,"flex","flex-col","h-full","overflow-y-auto"],["matSort","","matSortDisableClear","",1,"inventory-grid","sticky","top-0","z-30","grid","gap-4","py-4","px-6","md:px-8","shadow-md","text-md","font-semibold","text-secondary","bg-white","dark:bg-gray-900","border-b","border-gray-200","dark:border-gray-700",2,"grid-template-columns","200px 200px 150px 150px 300px 250px 120px"],[3,"mat-sort-header",4,"ngIf"],[1,"sticky-end"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[3,"mat-sort-header"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","items-center","text-m",2,"grid-template-columns","200px 200px 150px 150px 300px 250px 120px"],["class","truncate",4,"ngIf"],[4,"ngIf"],[1,"flex","items-center","justify-center","sticky-end"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","whitespace-nowrap",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"grid"],[1,"truncate"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"responsive-form","flex","flex-col","w-full","max-w-full","mx-auto","box-border",2,"width","100%","max-width","500px","padding","0 16px","box-sizing","border-box",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","p-8"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-2/4","sm:pl-8"],[1,"w-full"],["matInput","","formControlName","proveedor",3,"disabled"],["matInput","","formControlName","contrato",3,"disabled"],["matPrefix",""],["matInput","","type","number","formControlName","costo_cup"],[1,"flex","flex-col","w-full","lg:w-1/4","sm:pl-8"],["matInput","","type","number","formControlName","costo_usd"],["matInput","","formControlName","trabajo_ejecutado"],["matInput","","type","date","formControlName","fecha_ejecucion"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","w-full","border-t","px-4","sm:px-8","py-4"],[1,"flex","flex-col","sm:flex-row","items-center","gap-3","w-full","sm:w-auto","lg:w-auto"],["mat-stroked-button","","color","primary",1,"w-full","sm:w-auto","lg:w-auto","px-6",3,"click"],["mat-stroked-button","","color","warn",1,"w-full","sm:w-auto","lg:w-auto","px-6",3,"click"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5,"Total Ejecuciones"),t.qZA(),t.TgZ(6,"div",5),t._uU(7),t.qZA()(),t.TgZ(8,"div",3)(9,"div",4),t._uU(10,"Monto Inicial CUP"),t.qZA(),t.TgZ(11,"div",5),t._uU(12),t.ALo(13,"currency"),t.qZA()(),t.TgZ(14,"div",3)(15,"div",4),t._uU(16,"Total Ejecutado CUP"),t.qZA(),t.TgZ(17,"div",5),t._uU(18),t.ALo(19,"currency"),t.qZA()(),t.TgZ(20,"div",3)(21,"div",4),t._uU(22,"Monto Restante CUP"),t.qZA(),t.TgZ(23,"div",5),t._uU(24),t.ALo(25,"currency"),t.qZA()(),t.TgZ(26,"div",3)(27,"div",4),t._uU(28,"Monto Inicial USD"),t.qZA(),t.TgZ(29,"div",5),t._uU(30),t.ALo(31,"currency"),t.qZA()(),t.TgZ(32,"div",3)(33,"div",4),t._uU(34,"Total Ejecutado USD"),t.qZA(),t.TgZ(35,"div",5),t._uU(36),t.ALo(37,"currency"),t.qZA()(),t.TgZ(38,"div",3)(39,"div",4),t._uU(40,"Monto Restante USD"),t.qZA(),t.TgZ(41,"div",5),t._uU(42),t.ALo(43,"currency"),t.qZA()()()(),t.TgZ(44,"div",6)(45,"div",7),t.YNc(46,z,2,1,"div",8),t.TgZ(47,"div",9),t._uU(48,"Ejecuci\xf3n de Contratos"),t.qZA(),t.TgZ(49,"div",10)(50,"mat-form-field",11),t._UZ(51,"mat-icon",12)(52,"input",13),t.qZA(),t.TgZ(53,"button",14),t.NdJ("click",function(){return i.createRecord()}),t._UZ(54,"mat-icon",15),t.TgZ(55,"span",16),t._uU(56,"Agregar"),t.qZA()(),t.TgZ(57,"button",17),t.NdJ("click",function(){return i.exportToCSV()}),t._UZ(58,"mat-icon",15),t.qZA(),t.TgZ(59,"button",18),t.NdJ("click",function(){return i.printTable()}),t._UZ(60,"mat-icon",15),t.qZA(),t.TgZ(61,"button",19),t._UZ(62,"mat-icon",15),t.qZA(),t.TgZ(63,"mat-menu",null,20),t.YNc(65,B,3,2,"button",21),t.qZA()()(),t.TgZ(66,"div",22)(67,"div",23),t.YNc(68,pt,13,17,"ng-container",24)(69,ut,41,3,"ng-template",null,25,t.W1O)(71,mt,2,0,"ng-template",null,26,t.W1O),t.qZA()()()()),2&n){const a=t.MAs(64),l=t.MAs(72);t.xp6(7),t.Oqu(i.data.length),t.xp6(5),t.Oqu(t.Dn7(13,25,i.montoInicialCup,"CUP","symbol")),t.xp6(6),t.Oqu(t.Dn7(19,29,i.totalEjecutadoCup,"CUP","symbol")),t.xp6(6),t.Oqu(t.Dn7(25,33,i.montoRestanteCup,"CUP","symbol")),t.xp6(6),t.Oqu(t.Dn7(31,37,i.montoInicialUsd,"USD","symbol")),t.xp6(6),t.Oqu(t.Dn7(37,41,i.totalEjecutadoUsd,"USD","symbol")),t.xp6(6),t.Oqu(t.Dn7(43,45,i.montoRestanteUsd,"USD","symbol")),t.xp6(4),t.Q6J("ngIf",i.isLoading),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar ejecuciones"),t.xp6(1),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(3),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:arrow-up-tray"),t.xp6(1),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:printer"),t.xp6(1),t.Q6J("color","primary")("matMenuTriggerFor",a),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:view-columns"),t.xp6(3),t.Q6J("ngForOf",i.columns),t.xp6(3),t.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",l)}},dependencies:[p.ez,p.mk,p.sg,p.O5,p.tP,p.H9,p.uU,C.ot,C.lW,C.RK,b.Cv,b.pW,m.JX,m.YE,m.nU,d.p0,y.Ps,y.Hw,s.UX,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.oH,s.sg,s.u,f.TU,f.NW,_.lN,_.KE,_.hX,_.qo,Z.c,Z.Nt,E.LD,T.Tx,T.VK,T.OP,T.p6,D.t,S.p9,S.oG],styles:[".inventory-grid{display:grid;align-items:center;gap:1rem;padding:.5rem 1.5rem;border-bottom:1px solid #e0e0e0}.inventory-grid.sticky{position:sticky;top:0;z-index:30;background-color:#fff;box-shadow:0 2px 4px #0000001a}.inventory-grid.header{font-weight:600;background-color:#f5f5f5;padding:.75rem 1.5rem}.inventory-grid>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:.25rem}.sticky-end{position:sticky;right:0;background-color:inherit;text-align:center}.bg-card{background-color:#fff;border-radius:.5rem;box-shadow:0 0 10px #0000001a}.text-secondary{color:#6b7280}.shadow{box-shadow:0 1px 3px #0000001a}@media print{.search-add-wrapper,.mat-paginator,.mat-icon-button,.mat-stroked-button,.mat-progress-bar,.mat-form-field,.row-details-template{display:none!important}.inventory-grid{display:table;width:100%;border-collapse:collapse;font-size:12pt}.inventory-grid.header{display:table-header-group;background-color:#f0f0f0!important}.inventory-grid:not(.header){display:table-row-group}.inventory-grid>div{display:table-cell;border:1px solid #000;padding:8px;vertical-align:middle}.sticky-end{display:table-cell!important}.text-red-500,.text-4xl{display:none!important}.border-b,.border-t{border:none!important}}\n"],encapsulation:2,changeDetection:0})}return o})();function ht(o,r){1&o&&(t.TgZ(0,"div",12),t._UZ(1,"mat-progress-bar",13),t.qZA())}function _t(o,r){if(1&o&&(t.TgZ(0,"div",14)(1,"div",15),t._uU(2),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(e.errorMessage)}}function ft(o,r){1&o&&(t.TgZ(0,"th",33),t._uU(1," No. Contrato "),t.qZA())}function xt(o,r){if(1&o&&(t.TgZ(0,"td",34)(1,"span",35),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",e.no_contrato," ")}}function Ct(o,r){1&o&&(t.TgZ(0,"th",33),t._uU(1," Proveedor "),t.qZA())}function vt(o,r){if(1&o&&(t.TgZ(0,"td",34)(1,"span",36),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",(null==e.proveedor?null:e.proveedor.nombre)||"N/A"," ")}}function bt(o,r){1&o&&(t.TgZ(0,"th",33),t._uU(1," Tipo Contrato "),t.qZA())}function yt(o,r){if(1&o&&(t.TgZ(0,"td",34)(1,"span",36),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",(null==e.tipo_contrato?null:e.tipo_contrato.tipo_contrato)||"N/A"," ")}}function Zt(o,r){1&o&&(t.TgZ(0,"th",33),t._uU(1," Valor (CUP) "),t.qZA())}function Tt(o,r){if(1&o&&(t.TgZ(0,"td",34)(1,"span",37),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",t.gM2(3,1,e.valor_cup,"CUP","symbol","1.2-2")," ")}}function wt(o,r){1&o&&(t.TgZ(0,"th",33),t._uU(1," Fecha Firmado "),t.qZA())}function jt(o,r){if(1&o&&(t.TgZ(0,"td",34)(1,"span",36),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,1,e.fecha_firmado,"dd/MM/yyyy")," ")}}function Et(o,r){1&o&&(t.TgZ(0,"th",33),t._uU(1," Fecha Vencido "),t.qZA())}function kt(o,r){if(1&o&&(t.TgZ(0,"td",34)(1,"span",38),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,1,e.fecha_vencido,"dd/MM/yyyy")," ")}}function Ut(o,r){1&o&&(t.TgZ(0,"th",39),t._uU(1," Acciones "),t.qZA())}function At(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td",34)(1,"div",40)(2,"button",41),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.restoreContrato(a.id))}),t._UZ(3,"mat-icon",42),t.qZA(),t.TgZ(4,"button",43),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.deleteContrato(a.id))}),t._UZ(5,"mat-icon",44),t.qZA()()()}2&o&&(t.xp6(3),t.Q6J("svgIcon","heroicons_outline:arrow-path"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:trash"))}function It(o,r){1&o&&t._UZ(0,"tr",45)}function St(o,r){1&o&&t._UZ(0,"tr",46)}function Jt(o,r){1&o&&(t.TgZ(0,"div",47)(1,"div",48),t._UZ(2,"mat-icon",49),t.TgZ(3,"span",50),t._uU(4,"No hay contratos vencidos"),t.qZA(),t.TgZ(5,"span",51),t._uU(6,"Los contratos vencidos aparecer\xe1n aqu\xed"),t.qZA()()()),2&o&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:document-text"))}const Ft=o=>({"pointer-events-none":o}),qt=()=>[5,10,25,100];function Qt(o,r){if(1&o&&(t.TgZ(0,"div",16)(1,"table",17,18),t.ynx(3,19),t.YNc(4,ft,2,0,"th",20)(5,xt,3,1,"td",21),t.BQk(),t.ynx(6,22),t.YNc(7,Ct,2,0,"th",20)(8,vt,3,1,"td",21),t.BQk(),t.ynx(9,23),t.YNc(10,bt,2,0,"th",20)(11,yt,3,1,"td",21),t.BQk(),t.ynx(12,24),t.YNc(13,Zt,2,0,"th",20)(14,Tt,4,6,"td",21),t.BQk(),t.ynx(15,25),t.YNc(16,wt,2,0,"th",20)(17,jt,4,4,"td",21),t.BQk(),t.ynx(18,26),t.YNc(19,Et,2,0,"th",20)(20,kt,4,4,"td",21),t.BQk(),t.ynx(21,27),t.YNc(22,Ut,2,0,"th",28)(23,At,6,2,"td",21),t.BQk(),t.YNc(24,It,1,0,"tr",29)(25,St,1,0,"tr",30),t.qZA(),t.YNc(26,Jt,7,1,"div",31),t._UZ(27,"mat-paginator",32),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource)("trackByFn",e.trackByFn),t.xp6(23),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.data.length&&!e.isLoading),t.xp6(1),t.Q6J("ngClass",t.VKq(12,Ft,e.isLoading))("length",e.pagination.length)("pageIndex",0)("pageSize",10)("pageSizeOptions",t.DdM(14,qt))("showFirstLastButtons",!0)}}let Nt=(()=>{class o{constructor(e,n){this.contratoService=e,this.cdr=n,this.displayedColumns=["no_contrato","proveedor","tipo_contrato","valor_cup","fecha_firmado","fecha_vencido","acciones"],this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.searchInputControl=new s.NI(""),this.dataSource=new d.by([])}ngOnInit(){this.loadExpiredContracts(),this.searchInputControl.valueChanges.subscribe(e=>{this.applyFilter(e)})}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.cdr.markForCheck()}loadExpiredContracts(){this.isLoading=!0,this.errorMessage="",this.contratoService.getExpiredContratos().subscribe({next:e=>{this.dataSource.data=e.filter(n=>n.proveedor&&n.proveedor.nombre),this.pagination.length=this.dataSource.data.length,this.isLoading=!1,this.cdr.markForCheck()},error:e=>{this.errorMessage="Failed to load expired contracts. Please try again.",this.isLoading=!1,this.cdr.markForCheck()}})}applyFilter(e){e=e.trim().toLowerCase(),this.dataSource.filter=e}trackByFn(e,n){return n.id}restoreContrato(e){this.contratoService.restoreContrato(e).subscribe({next:()=>{this.loadExpiredContracts(),this.cdr.markForCheck()},error:n=>{this.errorMessage="Failed to restore contract. Please try again.",this.cdr.markForCheck()}})}deleteContrato(e){this.contratoService.deleteContrato(e).subscribe({next:()=>{this.loadExpiredContracts(),this.cdr.markForCheck()},error:n=>{this.errorMessage="Failed to delete contract. Please try again.",this.cdr.markForCheck()}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(k.d),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-expired-contracts"]],viewQuery:function(n,i){if(1&n&&(t.Gf(m.YE,5),t.Gf(f.NW,5)),2&n){let a;t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first)}},standalone:!0,features:[t.jDz],decls:13,vars:7,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],["class","flex justify-center p-8",4,"ngIf"],["class","p-8 text-center",4,"ngIf"],["class","overflow-x-auto mx-6",4,"ngIf"],[1,"flex","justify-center","p-8"],["mode","indeterminate"],[1,"p-8","text-center"],[1,"text-red-600","text-lg"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackByFn"],["contractsTable",""],["matColumnDef","no_contrato"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","pr-6","mat-cell","",4,"matCellDef"],["matColumnDef","proveedor"],["matColumnDef","tipo_contrato"],["matColumnDef","valor_cup"],["matColumnDef","fecha_firmado"],["matColumnDef","fecha_vencido"],["matColumnDef","acciones"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","",4,"matHeaderCellDef"],["class","shadow-none","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","order-row h-16","mat-row","",4,"matRowDef","matRowDefColumns"],["class","p-8 sm:p-16 border-t text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],["mat-cell","",1,"pr-6"],[1,"text-md","font-medium","text-secondary"],[1,"text-md","font-medium"],[1,"text-md","font-medium","text-green-600"],[1,"text-md","font-medium","text-red-600"],["mat-header-cell","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"flex","items-center","gap-2"],["mat-stroked-button","","matTooltip","Restaurar contrato",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-blue-600",3,"svgIcon"],["mat-stroked-button","","matTooltip","Eliminar contrato",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-red-600",3,"svgIcon"],["mat-header-row","",1,"shadow-none"],["mat-row","",1,"order-row","h-16"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"],[1,"flex","flex-col","items-center"],[1,"icon-size-24","text-gray-400","mb-4",3,"svgIcon"],[1,"text-gray-500"],[1,"text-sm","text-gray-400","mt-2"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Contratos Vencidos"),t.qZA(),t.TgZ(4,"div",3)(5,"mat-form-field",4),t._UZ(6,"mat-icon",5)(7,"input",6),t.qZA()()(),t.TgZ(8,"div",7)(9,"div",8),t.YNc(10,ht,2,0,"div",9)(11,_t,3,1,"div",10)(12,Qt,28,15,"div",11),t.qZA()()()),2&n&&(t.xp6(6),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar contratos..."),t.xp6(3),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",i.errorMessage&&!i.isLoading),t.xp6(1),t.Q6J("ngIf",!i.isLoading))},dependencies:[p.ez,p.mk,p.O5,p.H9,p.uU,C.ot,C.lW,b.Cv,b.pW,m.JX,m.YE,m.nU,d.p0,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,y.Ps,y.Hw,s.UX,s.Fj,s.JJ,s.oH,f.TU,f.NW,_.lN,_.KE,_.qo,Z.c,Z.Nt,E.LD],styles:[".inventory-grid{display:grid;align-items:center;gap:1rem;padding:.5rem 1.5rem;border-bottom:1px solid #e0e0e0}.inventory-grid.header{font-weight:600;background-color:#f5f5f5;padding:.75rem 1.5rem}.inventory-grid[style*=grid-template-columns]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr)) 120px}.inventory-grid>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:.25rem}.inventory-grid>div:nth-child(1){min-width:200px;max-width:200px}.inventory-grid>div:nth-child(2){min-width:200px;max-width:200px}.inventory-grid>div:nth-child(3){min-width:150px;max-width:150px}.inventory-grid>div:nth-child(4){min-width:150px;max-width:150px}.inventory-grid>div:nth-child(5){min-width:300px;max-width:300px}.inventory-grid>div:nth-child(6){min-width:150px;max-width:150px}.inventory-grid>div.sticky-end{min-width:120px;max-width:120px;text-align:center}.sticky-end{position:sticky;right:0;background-color:inherit}.bg-card{background-color:#fff;border-radius:.5rem;box-shadow:0 0 10px #0000001a}.text-secondary{color:#6b7280}.shadow{box-shadow:0 1px 3px #0000001a}@media print{.search-add-wrapper,.mat-paginator,.mat-icon-button,.mat-stroked-button,.mat-progress-bar,.mat-form-field,.row-details-template{display:none!important}.inventory-grid{display:table;width:100%;border-collapse:collapse;font-size:12pt}.inventory-grid.header{display:table-header-group;background-color:#f0f0f0!important}.inventory-grid:not(.header){display:table-row-group}.inventory-grid>div{display:table-cell;border:1px solid #000;padding:8px;vertical-align:middle}.sticky-end,.text-red-500,.text-4xl{display:none!important}.border-b,.border-t{border:none!important}}\n"],encapsulation:2,changeDetection:0})}return o})();var Dt=c(5195);function Rt(o,r){1&o&&(t.TgZ(0,"div",15),t._UZ(1,"mat-progress-bar",16),t.qZA())}function Mt(o,r){if(1&o&&(t.TgZ(0,"div",17)(1,"div",18),t._uU(2),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(e.errorMessage)}}function Lt(o,r){1&o&&(t.TgZ(0,"th",34),t._uU(1," No. Contrato "),t.qZA())}function Ot(o,r){if(1&o&&(t.TgZ(0,"td",35)(1,"span",36),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",e.no_contrato," ")}}function Pt(o,r){1&o&&(t.TgZ(0,"th",34),t._uU(1," Proveedor "),t.qZA())}function Vt(o,r){if(1&o&&(t.TgZ(0,"td",35)(1,"span",37),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",(null==e.proveedor?null:e.proveedor.nombre)||"N/A"," ")}}function zt(o,r){1&o&&(t.TgZ(0,"th",34),t._uU(1," Tipo Contrato "),t.qZA())}function Bt(o,r){if(1&o&&(t.TgZ(0,"td",35)(1,"span",37),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",(null==e.tipo_contrato?null:e.tipo_contrato.nombre_tipo_contrato)||"N/A"," ")}}function Yt(o,r){1&o&&(t.TgZ(0,"th",34),t._uU(1," Valor (CUP) "),t.qZA())}function $t(o,r){if(1&o&&(t.TgZ(0,"td",35)(1,"span",38),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",t.gM2(3,1,e.valor_cup,"CUP","symbol","1.2-2")," ")}}function Ht(o,r){1&o&&(t.TgZ(0,"th",34),t._uU(1," Fecha Inicio "),t.qZA())}function Gt(o,r){if(1&o&&(t.TgZ(0,"td",35)(1,"span",37),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,1,e.fecha_inicio,"dd/MM/yyyy")," ")}}function Kt(o,r){1&o&&(t.TgZ(0,"th",34),t._uU(1," Fecha Vencido "),t.qZA())}function Wt(o,r){if(1&o&&(t.TgZ(0,"td",35)(1,"span",39),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,1,e.fecha_vencido,"dd/MM/yyyy")," ")}}function Xt(o,r){1&o&&(t.TgZ(0,"th",40),t._uU(1," Acciones "),t.qZA())}function te(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td",35)(1,"div",41)(2,"button",42),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.restoreContrato(a.id))}),t._UZ(3,"mat-icon",43),t.qZA(),t.TgZ(4,"button",44),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.deleteContrato(a.id))}),t._UZ(5,"mat-icon",45),t.qZA()()()}2&o&&(t.xp6(3),t.Q6J("svgIcon","heroicons_outline:arrow-path"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:trash"))}function ee(o,r){1&o&&t._UZ(0,"tr",46)}function oe(o,r){1&o&&t._UZ(0,"tr",47)}function ne(o,r){if(1&o&&(t.TgZ(0,"div",19)(1,"table",20,21),t.ynx(3,22),t.YNc(4,Lt,2,0,"th",23)(5,Ot,3,1,"td",24),t.BQk(),t.ynx(6,25),t.YNc(7,Pt,2,0,"th",23)(8,Vt,3,1,"td",24),t.BQk(),t.ynx(9,26),t.YNc(10,zt,2,0,"th",23)(11,Bt,3,1,"td",24),t.BQk(),t.ynx(12,27),t.YNc(13,Yt,2,0,"th",23)(14,$t,4,6,"td",24),t.BQk(),t.ynx(15,28),t.YNc(16,Ht,2,0,"th",23)(17,Gt,4,4,"td",24),t.BQk(),t.ynx(18,29),t.YNc(19,Kt,2,0,"th",23)(20,Wt,4,4,"td",24),t.BQk(),t.ynx(21,30),t.YNc(22,Xt,2,0,"th",31)(23,te,6,2,"td",24),t.BQk(),t.YNc(24,ee,1,0,"tr",32)(25,oe,1,0,"tr",33),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource)("trackByFn",e.trackByFn),t.xp6(23),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function ie(o,r){1&o&&t._UZ(0,"mat-progress-bar",16)}function re(o,r){if(1&o&&(t.TgZ(0,"div",48),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const ce=[{path:"list",component:F.M},{path:"ejecucion",component:gt},{path:"vencidos",component:Nt},{path:"vencidas",component:(()=>{class o{constructor(e,n){this.contratoService=e,this.cdr=n,this.displayedColumns=["no_contrato","proveedor","tipo_contrato","valor_cup","fecha_inicio","fecha_vencido","acciones"],this.isLoading=!1,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.searchInputControl=new s.NI(""),this.dataSource=new d.by([])}ngOnInit(){this.loadVencidoEjecucionContratos(),this.searchInputControl.valueChanges.subscribe(e=>{this.applyFilter(e)})}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.cdr.markForCheck()}loadVencidoEjecucionContratos(){this.isLoading=!0,this.errorMessage="",this.contratoService.getVencidoEjecucionContratos(this.pagination.page,this.pagination.size).subscribe({next:e=>{this.dataSource.data=e.data,this.pagination.length=e.total,this.isLoading=!1,this.cdr.markForCheck()},error:e=>{this.errorMessage="Error al cargar contratos vencidos.",this.isLoading=!1,this.cdr.markForCheck()}})}applyFilter(e){e=e.trim().toLowerCase(),this.dataSource.filter=e}trackByFn(e,n){return n.id}restoreContrato(e){this.contratoService.restoreContrato(e).subscribe({next:()=>{this.loadVencidoEjecucionContratos(),this.cdr.markForCheck()},error:n=>{this.errorMessage="Failed to restore contract. Please try again.",this.cdr.markForCheck()}})}deleteContrato(e){this.contratoService.deleteContrato(e).subscribe({next:()=>{this.loadVencidoEjecucionContratos(),this.cdr.markForCheck()},error:n=>{this.errorMessage="Failed to delete contract. Please try again.",this.cdr.markForCheck()}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(k.d),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-vencido-ejecucion-contrato"]],viewQuery:function(n,i){if(1&n&&(t.Gf(m.YE,5),t.Gf(f.NW,5)),2&n){let a;t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first)}},standalone:!0,features:[t.jDz],decls:16,vars:12,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],["class","flex justify-center p-8",4,"ngIf"],["class","p-8 text-center",4,"ngIf"],["class","overflow-x-auto mx-6",4,"ngIf"],[3,"length","pageSize","pageIndex","page"],["mode","indeterminate",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"flex","justify-center","p-8"],["mode","indeterminate"],[1,"p-8","text-center"],[1,"text-red-600","text-lg"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackByFn"],["contractsTable",""],["matColumnDef","no_contrato"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","pr-6","mat-cell","",4,"matCellDef"],["matColumnDef","proveedor"],["matColumnDef","tipo_contrato"],["matColumnDef","valor_cup"],["matColumnDef","fecha_inicio"],["matColumnDef","fecha_vencido"],["matColumnDef","acciones"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],["mat-cell","",1,"pr-6"],[1,"text-md","font-medium","text-secondary"],[1,"text-md","font-medium"],[1,"text-md","font-medium","text-green-600"],[1,"text-md","font-medium","text-red-600"],["mat-header-cell","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"flex","items-center","gap-2"],["mat-stroked-button","","matTooltip","Restaurar contrato",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-blue-600",3,"svgIcon"],["mat-stroked-button","","matTooltip","Eliminar contrato",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-red-600",3,"svgIcon"],["mat-header-row",""],["mat-row",""],[1,"error-message"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Contratos de Ejecuci\xf3n Vencidos"),t.qZA(),t.TgZ(4,"div",3)(5,"mat-form-field",4),t._UZ(6,"mat-icon",5)(7,"input",6),t.qZA()()(),t.TgZ(8,"div",7)(9,"div",8),t.YNc(10,Rt,2,0,"div",9)(11,Mt,3,1,"div",10)(12,ne,26,4,"div",11),t.TgZ(13,"mat-paginator",12),t.NdJ("page",function(){return i.loadVencidoEjecucionContratos()}),t.qZA(),t.YNc(14,ie,1,0,"mat-progress-bar",13)(15,re,2,1,"div",14),t.qZA()()()),2&n&&(t.xp6(6),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar contratos..."),t.xp6(3),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",i.errorMessage&&!i.isLoading),t.xp6(1),t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("length",i.pagination.length)("pageSize",i.pagination.size)("pageIndex",i.pagination.page),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",i.errorMessage))},dependencies:[p.ez,p.O5,p.H9,p.uU,C.ot,C.lW,b.Cv,b.pW,m.JX,m.YE,m.nU,d.p0,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,y.Ps,y.Hw,s.UX,s.Fj,s.JJ,s.oH,f.TU,f.NW,_.lN,_.KE,_.qo,Z.c,Z.Nt,E.LD,Dt.QW],encapsulation:2,changeDetection:0})}return o})()}];let se=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[A.Bz.forChild(ce),A.Bz]})}return o})()}}]);