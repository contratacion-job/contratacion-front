"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[706],{4706:(yt,k,s)=>{s.r(k),s.d(k,{SuplementosRoutingModule:()=>St});var F=s(1896),p=s(3566),f=s(1476),d=s(5313),c=s(6223),E=s(9773),y=s(3620),u=s(6814),g=s(2296),T=s(6007),x=s(617),m=s(4170),v=s(4516),C=s(8525),j=s(7988),H=s(6385),Z=s(2596),A=s(7700),I=s(7668),D=s(8645),e=s(9212),J=s(5300),N=s(4065),Q=s(3018),q=s(6819),G=s(1892);function W(n,a){1&n&&(e.TgZ(0,"div",31),e._UZ(1,"mat-progress-bar",32),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode","indeterminate"))}function $(n,a){1&n&&e.GkF(0)}const K=n=>({$implicit:n});function X(n,a){if(1&n&&(e.TgZ(0,"div",60),e.YNc(1,$,1,0,"ng-container",61),e.qZA()),2&n){const t=e.oxw().$implicit;e.oxw(2);const o=e.MAs(79);e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,K,t))}}function ee(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",54)(2,"div",55),e._uU(3),e.qZA(),e.TgZ(4,"div",55),e._uU(5),e.qZA(),e.TgZ(6,"div",55),e._uU(7),e.qZA(),e.TgZ(8,"div",55),e._uU(9),e.qZA(),e.TgZ(10,"div",55),e._uU(11),e.qZA(),e.TgZ(12,"div",55),e._uU(13),e.qZA(),e.TgZ(14,"div",55),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"div",55),e._uU(18),e.ALo(19,"date"),e.qZA(),e.TgZ(20,"div",55),e._uU(21),e.qZA(),e.TgZ(22,"div",56)(23,"button",57),e.NdJ("click",function(i){const l=e.CHM(t).$implicit,_=e.oxw(2);return i.stopPropagation(),e.KtG(_.toggleDetails(l.id))}),e._UZ(24,"mat-icon",58),e.qZA()()(),e.YNc(25,X,2,4,"div",59),e.BQk()}if(2&n){const t=a.$implicit,o=e.oxw(2);e.xp6(3),e.Oqu(t.contrato_id||"-"),e.xp6(2),e.Oqu(t.monto||"-"),e.xp6(2),e.Oqu(t.fecha_suplemento||"-"),e.xp6(2),e.Oqu(t.estado||"-"),e.xp6(2),e.Oqu(t.descripcion||"--"),e.xp6(2),e.Oqu(t.observaciones||"--"),e.xp6(2),e.Oqu(e.xi3(16,11,t.createdAt,"short")),e.xp6(3),e.Oqu(e.xi3(19,14,t.updatedAt,"short")),e.xp6(3),e.Oqu((null==t.documentos?null:t.documentos.length)||0),e.xp6(3),e.Q6J("svgIcon",(null==o.selectedSuplemento?null:o.selectedSuplemento.id)===t.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),e.xp6(1),e.Q6J("ngIf",(null==o.selectedSuplemento?null:o.selectedSuplemento.id)===t.id)}}const te=()=>[5,10,25,100];function oe(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33)(2,"div",34)(3,"div",35),e._uU(4,"No. Contrato"),e.qZA(),e.TgZ(5,"div",35),e._uU(6,"Monto"),e.qZA(),e.TgZ(7,"div",35),e._uU(8,"Fecha Suplemento"),e.qZA(),e.TgZ(9,"div",35),e._uU(10,"Estado"),e.qZA(),e.TgZ(11,"div",35),e._uU(12,"Descripci\xf3n"),e.qZA(),e.TgZ(13,"div",35),e._uU(14,"Observaciones"),e.qZA(),e.TgZ(15,"div",35),e._uU(16,"Creado"),e.qZA(),e.TgZ(17,"div",35),e._uU(18,"Actualizado"),e.qZA(),e.TgZ(19,"div",35),e._uU(20,"Documentos"),e.qZA(),e.TgZ(21,"div",36),e._uU(22,"Detalles"),e.qZA()(),e.TgZ(23,"div",37)(24,"div")(25,"mat-form-field",38),e._UZ(26,"input",39),e.qZA()(),e.TgZ(27,"div")(28,"mat-form-field",38),e._UZ(29,"input",40),e.qZA()(),e.TgZ(30,"div")(31,"mat-form-field",38),e._UZ(32,"input",41),e.qZA()(),e.TgZ(33,"div")(34,"mat-form-field",38),e._UZ(35,"input",42),e.qZA()(),e.TgZ(36,"div")(37,"mat-form-field",38),e._UZ(38,"input",43),e.qZA()(),e.TgZ(39,"div")(40,"mat-form-field",38),e._UZ(41,"input",44),e.qZA()(),e.TgZ(42,"div")(43,"mat-form-field",38),e._UZ(44,"input",45),e.qZA()(),e.TgZ(45,"div")(46,"mat-form-field",38),e._UZ(47,"input",46),e.qZA()(),e.TgZ(48,"div")(49,"mat-form-field",38),e._UZ(50,"input",47),e.qZA()(),e.TgZ(51,"div",48)(52,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.applyFilters())}),e.TgZ(53,"mat-icon",50),e._uU(54,"search"),e.qZA()(),e.TgZ(55,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearFilters())}),e.TgZ(56,"mat-icon",50),e._uU(57,"clear"),e.qZA()()()(),e.YNc(58,ee,26,17,"ng-container",52),e.qZA(),e._UZ(59,"mat-paginator",53),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("mat-sort-header","contrato_id"),e.xp6(2),e.Q6J("mat-sort-header","monto"),e.xp6(2),e.Q6J("mat-sort-header","fecha_suplemento"),e.xp6(2),e.Q6J("mat-sort-header","estado"),e.xp6(2),e.Q6J("mat-sort-header","descripcion"),e.xp6(2),e.Q6J("mat-sort-header","observaciones"),e.xp6(2),e.Q6J("mat-sort-header","createdAt"),e.xp6(2),e.Q6J("mat-sort-header","updatedAt"),e.xp6(2),e.Q6J("mat-sort-header","documentos"),e.xp6(4),e.Q6J("formGroup",t.filterForm),e.xp6(35),e.Q6J("ngForOf",t.dataSource.filteredData)("ngForTrackBy",t.trackByFn),e.xp6(1),e.Q6J("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(17,te))("showFirstLastButtons",!0)}}function ne(n,a){if(1&n&&(e.TgZ(0,"div",62)(1,"div",63)(2,"form",64)(3,"div",65)(4,"div",66)(5,"mat-form-field",67)(6,"mat-label"),e._uU(7,"No. Contrato"),e.qZA(),e._UZ(8,"input",68),e.qZA(),e.TgZ(9,"mat-form-field",67)(10,"mat-label"),e._uU(11,"Monto"),e.qZA(),e._UZ(12,"input",69),e.qZA(),e.TgZ(13,"mat-form-field",67)(14,"mat-label"),e._uU(15,"Fecha Suplemento"),e.qZA(),e._UZ(16,"input",70),e.qZA(),e.TgZ(17,"mat-form-field",67)(18,"mat-label"),e._uU(19,"Estado"),e.qZA(),e._UZ(20,"input",71),e.qZA()(),e.TgZ(21,"div",66)(22,"mat-form-field",67)(23,"mat-label"),e._uU(24,"Descripci\xf3n"),e.qZA(),e._UZ(25,"textarea",72),e.qZA(),e.TgZ(26,"mat-form-field",67)(27,"mat-label"),e._uU(28,"Observaciones"),e.qZA(),e._UZ(29,"textarea",73),e.qZA()(),e.TgZ(30,"div",66)(31,"mat-form-field",67)(32,"mat-label"),e._uU(33,"Creado"),e.qZA(),e._UZ(34,"input",74),e.qZA(),e.TgZ(35,"mat-form-field",67)(36,"mat-label"),e._uU(37,"Actualizado"),e.qZA(),e._UZ(38,"input",75),e.qZA(),e.TgZ(39,"mat-form-field",67)(40,"mat-label"),e._uU(41,"Documentos"),e.qZA(),e._UZ(42,"input",76),e.qZA()()(),e.TgZ(43,"div",77)(44,"button",78),e._uU(45," Actualizar "),e.qZA(),e.TgZ(46,"button",78),e._uU(47," Eliminar "),e.qZA()()()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.selectedSuplementoForm),e.xp6(40),e.Q6J("value",(null==t.selectedSuplemento||null==t.selectedSuplemento.documentos?null:t.selectedSuplemento.documentos.length)||0),e.xp6(2),e.Q6J("color","primary"),e.xp6(2),e.Q6J("color","warn")}}function ie(n,a){1&n&&(e.TgZ(0,"div",79),e._uU(1," \xa1No hay suplementos! "),e.qZA())}let re=(()=>{class n{constructor(t,o,i,r,l,_,h,S){this.cdr=t,this.tipocontratoervice=o,this.departamentoService=i,this.proveedorService=r,this.fb=l,this._matDialog=_,this.suplementoService=h,this.exportService=S,this.data=[],this.proveedores=[],this.tiposContrato=[],this.vigencias=[],this.departamentos=[],this._unsubscribeAll=new D.x,this.columns=[{key:"no_contrato_contratacion",label:"No. Contrato",sortable:!0},{key:"proveedor",label:"Proveedor",sortable:!0},{key:"tipo_contrato",label:"Tipo de Contrato",sortable:!0},{key:"departamento",label:"Departamento",sortable:!0},{key:"valor_cup",label:"Valor (CUP)",sortable:!0},{key:"valor_usd",label:"Valor (USD)",sortable:!0},{key:"fecha_entrada",label:"Fecha Entrada",sortable:!0},{key:"fecha_firmado",label:"Fecha Firmado",sortable:!0},{key:"vigencia",label:"Vigencia",sortable:!0},{key:"fecha_vencido",label:"Fecha Vencido",sortable:!0}],this.isLoading=!1,this.searchInputControl=new c.p4,this.dataSource=new d.by([]),this.displayedColumns=["no_contrato_contratacion","proveedor","tipo_contrato","departamento","valor_cup","valor_usd","fecha_entrada","fecha_firmado","vigencia","fecha_vencido","details"],this.selectedSuplemento=null,this.errorMessage="",this.pagination={length:0,page:0,size:10},this.dataSource=new d.by([]),this.initSelectedSuplementoForm(),this.filterForm=this.fb.group({contrato_id_filter:[""],monto_filter:[""],fecha_suplemento_filter:[""],estado_filter:[""],descripcion_filter:[""],observaciones_filter:[""],createdAt_filter:[""],updatedAt_filter:[""],documentos_filter:[""]})}openAddSuplementoDialog(){this._matDialog.open(I.h,{width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!0,data:{action:"new",suplemento:null}}).afterClosed().subscribe(o=>{o&&this.loadSuplementos()})}openEditSuplementoDialog(t){this._matDialog.open(I.h,{width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!0,data:{action:"edit",suplemento:t}}).afterClosed().subscribe(i=>{i&&this.loadSuplementos()})}deleteSuplemento(t){confirm(`\xbfEst\xe1 seguro de eliminar el suplemento #${t.id}?`)&&(console.log("Deleting suplemento:",t.id),this.loadSuplementos())}ngOnInit(){this.loadSuplementos(),this.dataSource.sortingDataAccessor=(t,o)=>{switch(o){case"proveedor":return t.proveedor?.nombre;case"tipo_contrato":return t.tipo_contrato?.nombre_tipo_contrato;case"departamento":return t.departamento?.nombre_departamento;case"vigencia":return t.vigencia?.vigencia;case"valor_cup":return t.valor_cup||0;case"valor_usd":return t.valor_usd||0;case"fecha_entrada":return t.fecha_entrada||"";case"fecha_firmado":return t.fecha_firmado||"";default:return t[o]}},this.dataSource.filterPredicate=(t,o)=>{if(!o)return!0;const i=o.toLowerCase().trim();return[t.no_contrato_contratacion?.toString()||"",t.proveedor?.nombre?.toLowerCase()||"",t.tipo_contrato?.nombre_tipo_contrato?.toLowerCase()||"",t.departamento?.nombre_departamento?.toLowerCase()||"",t.valor_cup?.toString()||"",t.valor_usd?.toString()||"",t.fecha_entrada||"",t.fecha_firmado||"",void 0!==t.vigencia?.vigencia?t.vigencia.vigencia.toString():"",t.observaciones?.toLowerCase()||""].join(" ").includes(i)},this.searchInputControl.valueChanges.pipe((0,E.R)(this._unsubscribeAll),(0,y.b)(300)).subscribe(t=>{this.closeDetails(),this.dataSource.filter=t?t.trim().toLowerCase():"",this.cdr.detectChanges()}),this.filterForm.valueChanges.pipe((0,E.R)(this._unsubscribeAll),(0,y.b)(300)).subscribe(()=>{this.applyFilters()})}convertToArray(t){return t?Array.isArray(t)?t:"object"==typeof t?t.data&&Array.isArray(t.data)?t.data:t.items&&Array.isArray(t.items)?t.items:t.results&&Array.isArray(t.results)?t.results:t.list&&Array.isArray(t.list)?t.list:t.content&&Array.isArray(t.content)?t.content:Object.values(t):[]:[]}loadSuplementos(){this.isLoading=!0,this.errorMessage="",this.tipocontratoervice.getTiposContrato().subscribe({next:t=>{console.log("Tipos de contrato raw:",t),this.tiposContrato=this.convertToArray(t),console.log("Tipos de contrato converted:",this.tiposContrato),this.cdr.detectChanges()},error:t=>{console.error("Error loading tipos contrato:",t),this.tiposContrato=[]}}),this.departamentoService.getDepartamentos().subscribe({next:t=>{console.log("Departamentos raw:",t),this.departamentos=this.convertToArray(t),console.log("Departamentos converted:",this.departamentos),this.cdr.detectChanges()},error:t=>{console.error("Error loading departamentos:",t),this.departamentos=[]}}),this.proveedorService.getProveedores().subscribe({next:t=>{console.log("Proveedores raw:",t);const o=this.convertToArray(t);this.proveedores=o.map(i=>({...i,municipio_id:i.municipio_id||null,ministerio_id:i.ministerio_id||null,fechaCreacion:i.fechaCreacion?new Date(i.fechaCreacion):null})),console.log("Proveedores converted:",this.proveedores),this.cdr.detectChanges()},error:t=>{console.error("Error loading proveedores:",t),this.proveedores=[]}}),this.suplementoService.getSuplementos().subscribe({next:t=>{const i=this.convertToArray(t).map(r=>({id:r.id,no_contrato_contratacion:r.contrato_id?r.contrato_id.toString():"N/A",proveedor:r.proveedor||null,tipo_contrato:r.tipo_contrato||null,departamento:r.departamento||null,valor_cup:r.monto?parseFloat(r.monto):0,valor_usd:0,fecha_entrada:r.contrato_fecha_inicio||"",fecha_firmado:r.fecha_suplemento||"",vigencia:r.vigencia||null,fecha_vencido:r.fecha_vencido||"",observaciones:r.observaciones||"",vigencia_id:r.vigencia_id||null,proveedor_id:r.proveedor_id||null,tipo_contrato_id:r.tipo_contrato_id||null,no_contrato_id:r.no_contrato_id||null,departamento_id:r.departamento_id||null,contrato_id:r.contrato_id||null,contrato_fecha_inicio:r.contrato_fecha_inicio||null,monto:r.monto||null,fecha_suplemento:r.fecha_suplemento||null,estado:r.estado||null,createdAt:r.createdAt||null,updatedAt:r.updatedAt||null,descripcion:r.descripcion||null,documentos:r.documentos||[],monto_vencimiento_cup:r.monto_vencimiento_cup||null,monto_vencimiento_cl:r.monto_vencimiento_cl||null,monto_vencimiento_usd:r.monto_vencimiento_usd||null,fecha_comite_contratacion:r.fecha_comite_contratacion||null,fecha_comite_evaluacion:r.fecha_comite_evaluacion||null,fecha_comite_juridico:r.fecha_comite_juridico||null,fecha_comite_tecnico:r.fecha_comite_tecnico||null,fecha_comite_finanzas:r.fecha_comite_finanzas||null,fecha_comite_aprobacion:r.fecha_comite_aprobacion||null,no_comite_contratacion:r.no_comite_contratacion||null,no_acuerdo_comite_contratacion:r.no_acuerdo_comite_contratacion||null,fecha_comite_administracion:r.fecha_comite_administracion||null,no_comite_administracion:r.no_comite_administracion||null,fecha_comite_finanzas_administracion:r.fecha_comite_finanzas_administracion||null,no_comite_finanzas_administracion:r.no_comite_finanzas_administracion||null,no_acuerdo_comite_administracion:r.no_acuerdo_comite_administracion||null,valor_monto_restante:r.valor_monto_restante||null}));this.dataSource.data=i,this.pagination.length=i.length,this.isLoading=!1,this.cdr.markForCheck()},error:t=>{this.errorMessage="Error al cargar suplementos. Por favor, int\xe9ntelo de nuevo.",this.isLoading=!1,this.cdr.markForCheck()}})}initSelectedSuplementoForm(){this.selectedSuplementoForm=this.fb.group({contrato_id:["",c.kI.required],monto:["",c.kI.required],fecha_suplemento:["",c.kI.required],estado:["",c.kI.required],descripcion:[""],observaciones:[""],createdAt:[""],updatedAt:[""],documentos:[[]]})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.paginator&&(this.paginator.pageSize=10,this.paginator.pageSizeOptions=[5,10,25,50]),this.dataSource.sort=this.sort,this.sort&&(this.sort.active="no_contrato_contratacion",this.sort.direction="asc"),this.cdr.detectChanges()}trackByFn(t,o){return o.id}toggleDetails(t){this.selectedSuplemento?.id===t?this.selectedSuplemento=null:(this.selectedSuplemento=this.dataSource.data.find(o=>o.id===t)||null,this.selectedSuplemento&&(this.selectedSuplementoForm||this.initSelectedSuplementoForm(),this.selectedSuplementoForm.patchValue({no_contrato_contratacion:this.selectedSuplemento.no_contrato_contratacion||"",proveedor:this.selectedSuplemento.proveedor||null,tipo_contrato:this.selectedSuplemento.tipo_contrato||null,departamento:this.selectedSuplemento.departamento||null,fecha_entrada:this.selectedSuplemento.fecha_entrada||"",valor_cup:this.selectedSuplemento.valor_cup||0,valor_usd:this.selectedSuplemento.valor_usd||0,fecha_firmado:this.selectedSuplemento.fecha_firmado||"",vigencia:this.selectedSuplemento.vigencia||null,observaciones:this.selectedSuplemento.observaciones||"",fecha_vencido:this.selectedSuplemento.fecha_vencido||""}))),this.cdr.detectChanges()}applyFilters(){const t=this.filterForm.value;this.dataSource.filterPredicate=(o,i)=>!(t.proveedor_id&&o.proveedor?.id!==t.proveedor_id||t.tipo_contrato_id&&o.tipo_contrato?.id!==t.tipo_contrato_id||t.departamento_id&&o.departamento?.id!==t.departamento_id||t.vigencia_id&&o.vigencia?.id!==t.vigencia_id||t.valor_cup_filter&&o.valor_cup<t.valor_cup_filter||t.valor_usd_filter&&o.valor_usd<t.valor_usd_filter||t.fecha_entrada_filter&&new Date(o.fecha_entrada)<new Date(t.fecha_entrada_filter)||t.fecha_firmado_filter&&new Date(o.fecha_firmado)<new Date(t.fecha_firmado_filter)),this.dataSource.filter=JSON.stringify(t),this.cdr.detectChanges()}clearFilters(){this.filterForm.reset(),this.dataSource.filter="",this.cdr.detectChanges()}closeDetails(){this.selectedSuplemento=null}truncateText(t,o){return t?t.length<=o?t:t.substring(0,o)+"...":""}exportToCSV(){const t=this.dataSource.filteredData||this.dataSource.data;if(!t||0===t.length)return;const i=t.map(r=>({no_contrato_contratacion:r.no_contrato_contratacion,proveedor:r.proveedor?.nombre||"",tipo_contrato:r.tipo_contrato?.nombre_tipo_contrato||"",departamento:r.departamento?.nombre_departamento||"",valor_cup:r.valor_cup,valor_usd:r.valor_usd,fecha_entrada:r.fecha_entrada,fecha_firmado:r.fecha_firmado,vigencia:r.vigencia?.vigencia,fecha_vencido:r.fecha_vencido,observaciones:r.observaciones||""}));this.exportService.exportToExcel(i,[{key:"no_contrato_contratacion",label:"No. Contrato"},{key:"proveedor",label:"Proveedor"},{key:"tipo_contrato",label:"Tipo de Contrato"},{key:"departamento",label:"Departamento"},{key:"valor_cup",label:"Valor (CUP)"},{key:"valor_usd",label:"Valor (USD)"},{key:"fecha_entrada",label:"Fecha Entrada"},{key:"fecha_firmado",label:"Fecha Firmado"},{key:"vigencia",label:"Vigencia"},{key:"fecha_vencido",label:"Fecha Vencido"},{key:"observaciones",label:"Observaciones"}],"suplementos_export.csv")}exportToPDF(){const o=this.dataSource.filteredData||this.dataSource.data;if(!o||0===o.length)return;const i=o.map(r=>({no_contrato_contratacion:r.no_contrato_contratacion,proveedor:this.truncateText(r.proveedor?.nombre||"",20),tipo_contrato:this.truncateText(r.tipo_contrato?.nombre_tipo_contrato||"",15),departamento:this.truncateText(r.departamento?.nombre_departamento||"",15),valor_cup:this.formatNumber(r.valor_cup),valor_usd:this.formatNumber(r.valor_usd),fecha_entrada:this.formatDateForPDF(r.fecha_entrada),fecha_firmado:this.formatDateForPDF(r.fecha_firmado),vigencia:r.vigencia?.vigencia,fecha_vencido:this.formatDateForPDF(r.fecha_vencido),observaciones:r.observaciones||""}));this.exportService.exportToPDF(i,[{key:"no_contrato_contratacion",label:"No. Contrato"},{key:"proveedor",label:"Proveedor"},{key:"tipo_contrato",label:"Tipo de Contrato"},{key:"departamento",label:"Departamento"},{key:"valor_cup",label:"Valor (CUP)"},{key:"valor_usd",label:"Valor (USD)"},{key:"fecha_entrada",label:"Fecha Entrada"},{key:"fecha_firmado",label:"Fecha Firmado"},{key:"vigencia",label:"Vigencia"},{key:"fecha_vencido",label:"Fecha Vencido"},{key:"observaciones",label:"Observaciones"}],"Reporte de Suplementos","assets/images/logo/logo.jpg")}print(){window.print()}formatNumber(t){return t&&0!==t?new Intl.NumberFormat("es-ES",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t):"0"}formatDateForPDF(t){if(!t)return"";try{let o;if(t instanceof Date)o=t;else{if("string"!=typeof t)return"";o=new Date(t)}return isNaN(o.getTime())?"":o.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit"})}catch{return""}}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(e.sBO),e.Y36(J.u),e.Y36(N._),e.Y36(Q.z),e.Y36(c.qu),e.Y36(A.uw),e.Y36(q.y),e.Y36(G.T))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-suplemento-list"]],viewQuery:function(o,i){if(1&o&&(e.Gf(p.YE,5),e.Gf(f.NW,5)),2&o){let r;e.iGM(r=e.CRH())&&(i.sort=r.first),e.iGM(r=e.CRH())&&(i.paginator=r.first)}},standalone:!0,features:[e.jDz],decls:82,vars:27,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"absolute","bottom-0","right-0","w-24","h-24","-m-6"],[1,"icon-size-24","opacity-25","text-green-500","dark:text-green-400",3,"svgIcon"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4","mb-6"],[1,"text-2xl","font-semibold"],[1,"flex","flex-row","flex-wrap","mt-4","-mx-6"],[1,"flex","flex-col","mx-6","my-3"],[1,"text-sm","font-medium","leading-none","text-secondary"],[1,"mt-2","font-medium","text-3xl","leading-none"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-col","sm:flex-row","shrink-0","items-center","justify-between","py-4","px-6","md:px-8","border-b"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","items-center","gap-4","mt-4","sm:mt-0"],["mat-raised-button","","color","primary",1,"w-full","sm:w-auto",3,"click"],[1,"flex","flex-col","sm:flex-row","gap-3","w-full","sm:w-auto"],["mat-icon-button","","matTooltip","Exportar tabla","aria-label","Exportar tabla",1,"ml-4","mt-4","sm:mt-0",3,"matMenuTriggerFor","color"],[3,"svgIcon"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","","color","primary","matTooltip","Imprimir","aria-label","Imprimir",1,"ml-2","mt-4","sm:mt-0",3,"click"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["rowDetailsTemplate",""],["noSuplementos",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"flex","flex-col","h-full","overflow-y-auto"],["matSort","","matSortDisableClear","",1,"inventory-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5",2,"grid-template-columns","repeat(9, minmax(100px, 1fr)) 100px"],[3,"mat-sort-header"],[1,"sticky-end"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","bg-gray-50","dark:bg-gray-800",2,"grid-template-columns","repeat(9, minmax(100px, 1fr)) 100px",3,"formGroup"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","No. Contrato","formControlName","contrato_id_filter"],["matInput","","type","number","placeholder","Monto","formControlName","monto_filter"],["matInput","","type","date","placeholder","Fecha Suplemento","formControlName","fecha_suplemento_filter"],["matInput","","placeholder","Estado","formControlName","estado_filter"],["matInput","","placeholder","Descripci\xf3n","formControlName","descripcion_filter"],["matInput","","placeholder","Observaciones","formControlName","observaciones_filter"],["matInput","","type","date","placeholder","Creado","formControlName","createdAt_filter"],["matInput","","type","date","placeholder","Actualizado","formControlName","updatedAt_filter"],["matInput","","placeholder","Documentos","formControlName","documentos_filter","disabled",""],[1,"flex","gap-1","sticky-end"],["mat-icon-button","","color","primary","type","button","matTooltip","Aplicar filtros",1,"!w-8","!h-8","!min-w-8",3,"click"],[1,"!text-sm"],["mat-icon-button","","color","warn","type","button","matTooltip","Limpiar filtros",1,"!w-8","!h-8","!min-w-8",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","items-center","text-m","hover:bg-gray-50","dark:hover:bg-gray-800",2,"grid-template-columns","repeat(9, minmax(100px, 1fr)) 100px"],[1,"truncate"],[1,"flex","items-center","justify-end","gap-2","sticky-end"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","whitespace-nowrap",3,"click"],[1,"icon-size-5",3,"svgIcon"],["class","grid",4,"ngIf"],[1,"grid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"responsive-form","flex","flex-col","w-full","mx-auto","p-8",3,"formGroup"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-1/3","sm:pl-8"],[1,"w-full"],["matInput","","formControlName","contrato_id"],["matInput","","type","number","formControlName","monto"],["matInput","","type","date","formControlName","fecha_suplemento"],["matInput","","formControlName","estado"],["matInput","","formControlName","descripcion"],["matInput","","formControlName","observaciones"],["matInput","","type","date","formControlName","createdAt"],["matInput","","type","date","formControlName","updatedAt"],["matInput","","disabled","",3,"value"],[1,"flex","flex-col","sm:flex-row","items-center","justify-end","w-full","border-t","px-4","py-4","gap-3"],["mat-stroked-button","",1,"w-full","sm:w-auto","px-6",3,"color"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",0)(2,"div",1)(3,"div",2),e._UZ(4,"mat-icon",3),e.qZA(),e.TgZ(5,"div",4)(6,"h2",5),e._uU(7,"Lista de Suplementos"),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8),e._uU(11," Monto Inicial CUP "),e.qZA(),e.TgZ(12,"div",9),e._uU(13),e.ALo(14,"currency"),e.qZA()(),e.TgZ(15,"div",7)(16,"div",8),e._uU(17," Total Ejecutado CUP "),e.qZA(),e.TgZ(18,"div",9),e._uU(19),e.ALo(20,"currency"),e.qZA()(),e.TgZ(21,"div",7)(22,"div",8),e._uU(23," Monto Restante CUP "),e.qZA(),e.TgZ(24,"div",9),e._uU(25),e.ALo(26,"currency"),e.qZA()(),e.TgZ(27,"div",7)(28,"div",8),e._uU(29," Monto Inicial USD "),e.qZA(),e.TgZ(30,"div",9),e._uU(31),e.qZA()(),e.TgZ(32,"div",7)(33,"div",8),e._uU(34," Total Ejecutado USD "),e.qZA(),e.TgZ(35,"div",9),e._uU(36),e.qZA()(),e.TgZ(37,"div",7)(38,"div",8),e._uU(39," Monto Restante USD "),e.qZA(),e.TgZ(40,"div",9),e._uU(41),e.qZA()()()(),e.TgZ(42,"div",10)(43,"div",11),e.YNc(44,W,2,1,"div",12),e.TgZ(45,"div",13),e._uU(46,"Suplementos"),e.qZA()(),e.TgZ(47,"div",14)(48,"mat-form-field",15),e._UZ(49,"mat-icon",16)(50,"input",17),e.qZA(),e.TgZ(51,"div",18)(52,"button",19),e.NdJ("click",function(){return i.openAddSuplementoDialog()}),e.TgZ(53,"mat-icon"),e._uU(54,"add"),e.qZA(),e.TgZ(55,"span"),e._uU(56,"Agregar Suplemento"),e.qZA()(),e.TgZ(57,"div",20)(58,"button",21),e._UZ(59,"mat-icon",22),e.qZA(),e.TgZ(60,"mat-menu",null,23)(62,"button",24),e.NdJ("click",function(){return i.exportToCSV()}),e.TgZ(63,"mat-icon"),e._uU(64,"description"),e.qZA(),e.TgZ(65,"span"),e._uU(66,"Exportar a CSV"),e.qZA()(),e.TgZ(67,"button",24),e.NdJ("click",function(){return i.exportToPDF()}),e.TgZ(68,"mat-icon"),e._uU(69,"table_chart"),e.qZA(),e.TgZ(70,"span"),e._uU(71,"Exportar a PDF"),e.qZA()()(),e.TgZ(72,"button",25),e.NdJ("click",function(){return i.print()}),e.TgZ(73,"mat-icon"),e._uU(74,"print"),e.qZA()()()()(),e.TgZ(75,"div",26)(76,"div",27),e.YNc(77,oe,60,18,"ng-container",28)(78,ne,48,4,"ng-template",null,29,e.W1O)(80,ie,2,0,"ng-template",null,30,e.W1O),e.qZA()()()()()),2&o){const r=e.MAs(61),l=e.MAs(81);e.xp6(4),e.Q6J("svgIcon","heroicons_outline:check-circle"),e.xp6(9),e.hij(" ",e.xi3(14,18,0,"CUP")," "),e.xp6(6),e.hij(" ",e.xi3(20,21,0,"CUP")," "),e.xp6(6),e.hij(" ",e.xi3(26,24,0,"CUP")," "),e.xp6(6),e.hij(" ",0," "),e.xp6(5),e.hij(" ",0," "),e.xp6(5),e.hij(" ",0," "),e.xp6(3),e.Q6J("ngIf",i.isLoading),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:magnifying-glass"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar suplementos"),e.xp6(8),e.Q6J("matMenuTriggerFor",r)("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:arrow-up-tray"),e.xp6(18),e.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",l)}},dependencies:[u.ez,u.sg,u.O5,u.tP,u.H9,u.uU,g.ot,g.lW,g.RK,T.Cv,T.pW,p.JX,p.YE,p.nU,d.p0,x.Ps,x.Hw,c.UX,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.oH,c.sg,c.u,f.TU,f.NW,m.lN,m.KE,m.hX,m.qo,v.c,v.Nt,C.LD,j.Tx,j.VK,j.OP,j.p6,Z.AV,Z.gM,H.t,A.Is],encapsulation:2,changeDetection:0})}return n})();var M=s(2939),b=s(8034),w=s(3680),ae=s(2246);function ce(n,a){if(1&n&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.AsE(" ",t.no_contrato_contratacion," - ",null==t.proveedor?null:t.proveedor.nombre," ")}}function le(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El suplemento es requerido "),e.qZA())}function se(n,a){if(1&n&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function de(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El proveedor es requerido "),e.qZA())}function ue(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El contrato es requerido "),e.qZA())}function me(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La fecha de ejecuci\xf3n es requerida "),e.qZA())}function pe(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El costo en CUP es requerido "),e.qZA())}function _e(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El costo no puede ser negativo "),e.qZA())}function fe(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El costo en CL es requerido "),e.qZA())}function ge(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El costo no puede ser negativo "),e.qZA())}function he(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n del trabajo es requerida "),e.qZA())}function ve(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n no puede exceder los 500 caracteres "),e.qZA())}let L=(()=>{class n{constructor(t,o,i){this._formBuilder=t,this._dialogRef=o,this.data=i,this.isEditMode=!1,this.suplementos=[],this.proveedores=ae.UB,this.isEditMode="edit"===i.action,this.ejecucionForm=this._formBuilder.group({id:[null],no_suplemento_id:[null,c.kI.required],proveedor_id:[null,c.kI.required],no_contrato_id:[null,c.kI.required],trabajo_ejecutado:["",[c.kI.required,c.kI.maxLength(500)]],costo_cup:[0,[c.kI.required,c.kI.min(0)]],costo_cl:[0,[c.kI.required,c.kI.min(0)]],fecha_ejecucion:[new Date,c.kI.required]})}ngOnInit(){this.isEditMode&&this.data.ejecucion&&this.ejecucionForm.patchValue({...this.data.ejecucion,fecha_ejecucion:this.data.ejecucion.fecha_ejecucion?new Date(this.data.ejecucion.fecha_ejecucion):new Date,no_suplemento_id:this.data.ejecucion.no_suplemento_id,proveedor_id:this.data.ejecucion.proveedor?.id,no_contrato_id:this.data.ejecucion.contrato?.id})}onSuplementoChange(t){const o=this.suplementos.find(i=>i.id===t);o&&this.ejecucionForm.patchValue({proveedor_id:o.proveedor?.id,no_contrato_id:o.no_contrato_contratacion})}onSubmit(){if(this.ejecucionForm.invalid)return void this.ejecucionForm.markAllAsTouched();const t=this.ejecucionForm.value,o={...t,id:this.isEditMode&&this.data.ejecucion?.id?this.data.ejecucion.id:void 0,proveedor:this.proveedores.find(i=>i.id===t.proveedor_id),suplemento:this.suplementos.find(i=>i.id===t.no_suplemento_id)};this._dialogRef.close(o)}onCancel(){this._dialogRef.close()}compareWithId(t,o){return t&&o?t.id===o.id:t===o}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(c.qu),e.Y36(A.so),e.Y36(A.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-ejecucion-suplemento-form"]],standalone:!0,features:[e.jDz],decls:61,vars:22,consts:[[1,"p-6"],["mat-dialog-title","",1,"text-xl","font-bold","mb-4"],[1,"space-y-4",3,"formGroup","ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["formControlName","no_suplemento_id","required","",3,"compareWith","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","proveedor_id","required","",3,"compareWith"],["formControlName","no_contrato_id","required","",3,"compareWith"],["matInput","","formControlName","fecha_ejecucion","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","formControlName","costo_cup","min","0","step","0.01","required",""],["matTextPrefix",""],["matInput","","type","number","formControlName","costo_cl","min","0","step","0.01","required",""],["matInput","","formControlName","trabajo_ejecutado","rows","4","placeholder","Describa el trabajo ejecutado...","required",""],["align","end"],[1,"flex","justify-end","gap-3","pt-4"],["mat-button","","type","button",1,"px-6",3,"click"],["mat-flat-button","","color","primary","type","submit",1,"px-6",3,"disabled"],[3,"value"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA(),e.TgZ(3,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),e._uU(7,"Suplemento"),e.qZA(),e.TgZ(8,"mat-select",5),e.NdJ("selectionChange",function(l){return i.onSuplementoChange(l.value)}),e.YNc(9,ce,2,3,"mat-option",6),e.qZA(),e.YNc(10,le,2,0,"mat-error",7),e.qZA(),e.TgZ(11,"mat-form-field",4)(12,"mat-label"),e._uU(13,"Proveedor"),e.qZA(),e.TgZ(14,"mat-select",8),e.YNc(15,se,2,2,"mat-option",6),e.qZA(),e.YNc(16,de,2,0,"mat-error",7),e.qZA(),e.TgZ(17,"mat-form-field",4)(18,"mat-label"),e._uU(19,"Contrato"),e.qZA(),e._UZ(20,"mat-select",9),e.YNc(21,ue,2,0,"mat-error",7),e.qZA(),e.TgZ(22,"mat-form-field",4)(23,"mat-label"),e._uU(24,"Fecha de Ejecuci\xf3n"),e.qZA(),e._UZ(25,"input",10),e.TgZ(26,"mat-hint"),e._uU(27,"DD/MM/YYYY"),e.qZA(),e._UZ(28,"mat-datepicker-toggle",11)(29,"mat-datepicker",null,12),e.YNc(31,me,2,0,"mat-error",7),e.qZA(),e.TgZ(32,"mat-form-field",4)(33,"mat-label"),e._uU(34,"Costo (CUP)"),e.qZA(),e._UZ(35,"input",13),e.TgZ(36,"span",14),e._uU(37,"$\xa0"),e.qZA(),e.YNc(38,pe,2,0,"mat-error",7)(39,_e,2,0,"mat-error",7),e.qZA(),e.TgZ(40,"mat-form-field",4)(41,"mat-label"),e._uU(42,"Costo (CL)"),e.qZA(),e._UZ(43,"input",15),e.TgZ(44,"span",14),e._uU(45,"CLP\xa0"),e.qZA(),e.YNc(46,fe,2,0,"mat-error",7)(47,ge,2,0,"mat-error",7),e.qZA()(),e.TgZ(48,"mat-form-field",4)(49,"mat-label"),e._uU(50,"Trabajo Ejecutado"),e.qZA(),e._UZ(51,"textarea",16),e.TgZ(52,"mat-hint",17),e._uU(53),e.qZA(),e.YNc(54,he,2,0,"mat-error",7)(55,ve,2,0,"mat-error",7),e.qZA(),e.TgZ(56,"div",18)(57,"button",19),e.NdJ("click",function(){return i.onCancel()}),e._uU(58," Cancelar "),e.qZA(),e.TgZ(59,"button",20),e._uU(60),e.qZA()()()()),2&o){const r=e.MAs(30);let l,_,h,S,Y,P,O,B,U,V,R;e.xp6(2),e.hij(" ",i.isEditMode?"Editar":"Nueva"," Ejecuci\xf3n de Suplemento "),e.xp6(1),e.Q6J("formGroup",i.ejecucionForm),e.xp6(5),e.Q6J("compareWith",i.compareWithId),e.xp6(1),e.Q6J("ngForOf",i.suplementos),e.xp6(1),e.Q6J("ngIf",null==(l=i.ejecucionForm.get("no_suplemento_id"))?null:l.hasError("required")),e.xp6(4),e.Q6J("compareWith",i.compareWithId),e.xp6(1),e.Q6J("ngForOf",i.proveedores),e.xp6(1),e.Q6J("ngIf",null==(_=i.ejecucionForm.get("proveedor_id"))?null:_.hasError("required")),e.xp6(4),e.Q6J("compareWith",i.compareWithId),e.xp6(1),e.Q6J("ngIf",null==(h=i.ejecucionForm.get("no_contrato_id"))?null:h.hasError("required")),e.xp6(4),e.Q6J("matDatepicker",r),e.xp6(3),e.Q6J("for",r),e.xp6(3),e.Q6J("ngIf",null==(S=i.ejecucionForm.get("fecha_ejecucion"))?null:S.hasError("required")),e.xp6(7),e.Q6J("ngIf",null==(Y=i.ejecucionForm.get("costo_cup"))?null:Y.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(P=i.ejecucionForm.get("costo_cup"))?null:P.hasError("min")),e.xp6(7),e.Q6J("ngIf",null==(O=i.ejecucionForm.get("costo_cl"))?null:O.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(B=i.ejecucionForm.get("costo_cl"))?null:B.hasError("min")),e.xp6(6),e.hij(" ",(null==(U=i.ejecucionForm.get("trabajo_ejecutado"))||null==U.value?null:U.value.length)||0,"/500 "),e.xp6(1),e.Q6J("ngIf",null==(V=i.ejecucionForm.get("trabajo_ejecutado"))?null:V.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(R=i.ejecucionForm.get("trabajo_ejecutado"))?null:R.hasError("maxlength")),e.xp6(4),e.Q6J("disabled",i.ejecucionForm.invalid),e.xp6(1),e.hij(" ",i.isEditMode?"Actualizar":"Guardar"," ")}},dependencies:[u.ez,u.sg,u.O5,c.UX,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.qQ,c.sg,c.u,m.lN,m.KE,m.hX,m.bx,m.TO,m.qo,m.R9,v.c,v.Nt,g.ot,g.lW,C.LD,C.gD,w.ey,b.FA,b.Mq,b.hl,b.nW,w.XK,x.Ps]})}return n})();function xe(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido "),e.qZA())}function be(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido "),e.qZA())}function Ze(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido "),e.qZA())}function Te(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El valor debe ser mayor o igual a 0 "),e.qZA())}function Ce(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido "),e.qZA())}function Ae(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",43)(1,"div",44)(2,"div",45)(3,"form",46)(4,"div",47)(5,"div",48)(6,"mat-form-field",49)(7,"mat-label"),e._uU(8,"No. Suplemento"),e.qZA(),e._UZ(9,"input",50),e.YNc(10,xe,2,0,"mat-error",51),e.qZA(),e.TgZ(11,"mat-form-field",49)(12,"mat-label"),e._uU(13,"Proveedor"),e.qZA(),e._UZ(14,"input",52),e.qZA(),e.TgZ(15,"mat-form-field",49)(16,"mat-label"),e._uU(17,"Fecha Suplemento"),e.qZA(),e._UZ(18,"input",52),e.ALo(19,"date"),e.qZA(),e.TgZ(20,"mat-form-field",49)(21,"mat-label"),e._uU(22,"Trabajo Ejecutado"),e.qZA(),e._UZ(23,"textarea",53),e.YNc(24,be,2,0,"mat-error",51),e.qZA()(),e.TgZ(25,"div",48)(26,"mat-form-field",49)(27,"mat-label"),e._uU(28,"Costo CUP"),e.qZA(),e._UZ(29,"input",54),e.YNc(30,Ze,2,0,"mat-error",51)(31,Te,2,0,"mat-error",51),e.qZA(),e.TgZ(32,"mat-form-field",49)(33,"mat-label"),e._uU(34,"Fecha de Ejecuci\xf3n"),e.qZA(),e.TgZ(35,"input",55),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(38);return e.KtG(i.open())}),e.qZA(),e._UZ(36,"mat-datepicker-toggle",56)(37,"mat-datepicker",null,57),e.YNc(39,Ce,2,0,"mat-error",51),e.qZA()()(),e.TgZ(40,"div",58)(41,"button",59),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onCancelEdit())}),e._uU(42," Cancelar "),e.qZA(),e.TgZ(43,"button",60),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onSaveEjecucion())}),e._uU(44," Guardar Cambios "),e.qZA()()()()()()}if(2&n){const t=e.MAs(38),o=e.oxw(3);let i,r,l,_,h;e.xp6(3),e.Q6J("formGroup",o.selectedEjecucionForm),e.xp6(7),e.Q6J("ngIf",null==(i=o.selectedEjecucionForm.get("no_suplemento_id"))?null:i.hasError("required")),e.xp6(4),e.Q6J("value",(null==o.selectedEjecucion||null==o.selectedEjecucion.proveedor?null:o.selectedEjecucion.proveedor.nombre)||(null==o.selectedEjecucion||null==o.selectedEjecucion.Proveedor?null:o.selectedEjecucion.Proveedor.nombre)||"N/A"),e.xp6(4),e.Q6J("value",e.xi3(19,11,(null==o.selectedEjecucion||null==o.selectedEjecucion.suplemento?null:o.selectedEjecucion.suplemento.fecha_suplemento)||(null==o.selectedEjecucion||null==o.selectedEjecucion.Suplemento?null:o.selectedEjecucion.Suplemento.fecha_suplemento),"dd/MM/yyyy")),e.xp6(6),e.Q6J("ngIf",null==(r=o.selectedEjecucionForm.get("trabajo_ejecutado"))?null:r.hasError("required")),e.xp6(6),e.Q6J("ngIf",null==(l=o.selectedEjecucionForm.get("costo_cup"))?null:l.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(_=o.selectedEjecucionForm.get("costo_cup"))?null:_.hasError("min")),e.xp6(4),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t),e.xp6(3),e.Q6J("ngIf",null==(h=o.selectedEjecucionForm.get("fecha_ejecucion"))?null:h.hasError("required")),e.xp6(4),e.Q6J("disabled",!o.selectedEjecucionForm.valid)}}function Se(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"div",37),e._uU(3),e.qZA(),e.TgZ(4,"div",37),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"div",37),e._uU(10),e.qZA(),e.TgZ(11,"div",38),e._uU(12),e.ALo(13,"number"),e.qZA(),e.TgZ(14,"div",38),e._uU(15),e.ALo(16,"number"),e.qZA(),e.TgZ(17,"div"),e._uU(18),e.ALo(19,"date"),e.qZA(),e.TgZ(20,"div",39)(21,"button",40),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.toggleDetails(r.id))}),e._UZ(22,"mat-icon",41),e.qZA()()(),e.YNc(23,Ae,45,14,"div",42),e.BQk()}if(2&n){const t=a.$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("matTooltip",t.codigo_proveedor),e.xp6(1),e.Oqu(t.codigo_proveedor||"N/A"),e.xp6(1),e.Q6J("matTooltip",null==t.proveedor?null:t.proveedor.nombre),e.xp6(1),e.Oqu((null==t.proveedor?null:t.proveedor.nombre)||"\u2014"),e.xp6(1),e.Q6J("matTooltip",null==t.suplemento?null:t.suplemento.fecha_suplemento),e.xp6(1),e.Oqu(e.xi3(8,13,null==t.suplemento?null:t.suplemento.fecha_suplemento,"dd/MM/yyyy")||"N/A"),e.xp6(2),e.Q6J("matTooltip",t.trabajo_ejecutado),e.xp6(1),e.Oqu(t.trabajo_ejecutado||"N/A"),e.xp6(2),e.Oqu(e.xi3(13,16,t.costo_cup,"1.2-2")),e.xp6(3),e.Oqu(e.xi3(16,19,t.costo_usd,"1.2-2")),e.xp6(3),e.Oqu(e.xi3(19,22,t.fecha_ejecucion,"dd/MM/yyyy")),e.xp6(4),e.Q6J("svgIcon",(null==o.selectedEjecucion?null:o.selectedEjecucion.id)===t.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),e.xp6(1),e.Q6J("ngIf",(null==o.selectedEjecucion?null:o.selectedEjecucion.id)===t.id)}}const ye=()=>[5,10,25,100];function je(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",21)(2,"div",22)(3,"div",23),e._uU(4,"C\xf3digo Proveedor"),e.qZA(),e.TgZ(5,"div",23),e._uU(6,"Proveedor"),e.qZA(),e.TgZ(7,"div",23),e._uU(8,"Fecha Suplemento"),e.qZA(),e.TgZ(9,"div",23),e._uU(10,"Trabajo Ejecutado"),e.qZA(),e.TgZ(11,"div",24),e._uU(12,"Costo (CUP)"),e.qZA(),e.TgZ(13,"div",24),e._uU(14,"Costo (USD)"),e.qZA(),e.TgZ(15,"div",23),e._uU(16,"Fecha de Ejecuci\xf3n"),e.qZA(),e.TgZ(17,"div"),e._uU(18,"Acciones"),e.qZA()(),e.TgZ(19,"div",25)(20,"mat-form-field",26),e._UZ(21,"input",27),e.qZA(),e.TgZ(22,"mat-form-field",26),e._UZ(23,"input",28),e.qZA(),e.TgZ(24,"mat-form-field",26),e._UZ(25,"input",29),e.qZA(),e.TgZ(26,"mat-form-field",26),e._UZ(27,"input",30),e.qZA(),e.TgZ(28,"mat-form-field",26),e._UZ(29,"input",31),e.qZA(),e.TgZ(30,"mat-form-field",26),e._UZ(31,"input",32),e.qZA(),e.TgZ(32,"mat-form-field",26),e._UZ(33,"input",33),e.qZA(),e._UZ(34,"div"),e.qZA(),e.YNc(35,Se,24,25,"ng-container",34),e.qZA(),e.TgZ(36,"mat-paginator",35),e.NdJ("page",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onPageChange(i))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("mat-sort-header","codigo_proveedor"),e.xp6(2),e.Q6J("mat-sort-header","proveedor_nombre"),e.xp6(2),e.Q6J("mat-sort-header","suplemento_fecha"),e.xp6(2),e.Q6J("mat-sort-header","trabajo_ejecutado"),e.xp6(2),e.Q6J("mat-sort-header","costo_cup"),e.xp6(2),e.Q6J("mat-sort-header","costo_usd"),e.xp6(2),e.Q6J("mat-sort-header","fecha_ejecucion"),e.xp6(4),e.Q6J("formGroup",t.filterForm),e.xp6(16),e.Q6J("ngForOf",t.dataSource.data)("ngForTrackBy",t.trackByFn),e.xp6(1),e.Q6J("length",t.resultsLength)("pageIndex",0)("pageSize",10)("pageSizeOptions",e.DdM(15,ye))("showFirstLastButtons",!0)}}function we(n,a){1&n&&(e.TgZ(0,"div",61),e._uU(1," \xa1No hay ejecuciones! "),e.qZA())}let Ee=(()=>{class n{ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}constructor(t,o,i,r,l,_,h){this.tipocontratoervice=t,this.departamentoService=o,this.proveedorService=i,this.suplementoService=r,this._matDialog=l,this._snackBar=_,this._formBuilder=h,this.ejecuciones=[],this.displayedColumns=["no_suplemento","proveedor","contrato","trabajo_ejecutado","costo_cup","costo_cl","fecha_ejecucion","acciones"],this.selectedEjecucion=null,this.selectedEjecucionForm=this._formBuilder.group({id:[""],no_suplemento_id:["",c.kI.required],proveedor_id:["",c.kI.required],no_contrato_id:["",c.kI.required],trabajo_ejecutado:["",c.kI.required],costo_cup:["",[c.kI.required,c.kI.min(0)]],costo_cl:["",[c.kI.required,c.kI.min(0)]],fecha_ejecucion:["",c.kI.required],proveedor:[null],contrato:[null],suplemento:[null]}),this.isLoadingResults=!0,this.isRateLimitReached=!1,this._unsubscribeAll=new D.x,this.searchInputControl=new c.NI(""),this.dataSource=new d.by([]),this.initFilterForm(),this.loadEjecuciones()}loadEjecuciones(){this.isLoadingResults=!0,this.suplementoService.getEjecucionSuplementos().subscribe({next:t=>{console.log("Data received:",t),console.log("Data type:",typeof t),console.log("Is array:",Array.isArray(t));let o=[];Array.isArray(t)?o=t:t&&t.data&&Array.isArray(t.data)?o=t.data:t&&t.results&&Array.isArray(t.results)?o=t.results:t&&"object"==typeof t?o=[t]:(console.error("Unexpected data structure:",t),o=[]);const i=o.filter(l=>l&&!l.mock&&l.id>0);console.log("Filtered data:",i);const r=i.map(l=>({...l,proveedor:l.Proveedor||l.proveedor||null,suplemento:l.Suplemento||l.suplemento||null}));console.log("Mapped data:",r),this.dataSource=new d.by(r),this.dataSource.paginator=this._paginator,this.dataSource.sort=this._sort,this.resultsLength=r.length,this.isLoadingResults=!1},error:t=>{console.error("Error loading data:",t),this.isLoadingResults=!1,this.showMessage("Error al cargar ejecuciones de suplementos")}})}initFilterForm(){this.filterForm=this._formBuilder.group({no_suplemento_id_filter:[""],proveedor_filter:[""],contrato_filter:[""],trabajo_ejecutado_filter:[""],suplemento_fecha_filter:[""],costo_usd_filter:[""],costo_cup_filter:[""],costo_cl_filter:[""],fecha_ejecucion_filter:[""],no_contrato_filter:[""],valor_cup_filter:[""],valor_usd_filter:[""],fecha_entrada_filter:[""],fecha_firmado_filter:[""]})}initSelectedEjecucionForm(){}ngAfterViewInit(){this.dataSource&&(this.dataSource.paginator=this._paginator,this.dataSource.sort=this._sort),this.searchInputControl.valueChanges.pipe((0,E.R)(this._unsubscribeAll)).subscribe(t=>{this.dataSource.filter=t?.trim().toLowerCase()||""})}openAddEjecucionDialog(){this._matDialog.open(L,{width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!0,data:{action:"new",ejecucion:null}}).afterClosed().subscribe(o=>{o&&this.showMessage("Ejecuci\xf3n de suplemento guardada exitosamente")})}openEditEjecucionDialog(t){this._matDialog.open(L,{width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!0,data:{action:"edit",ejecucion:{...t}}}).afterClosed().subscribe(i=>{i&&this.showMessage("Ejecuci\xf3n de suplemento actualizada exitosamente")})}deleteEjecucion(t){confirm(`\xbfEst\xe1 seguro de eliminar la ejecuci\xf3n del suplemento ${t.no_suplemento_id}?`)&&this.suplementoService.deleteEjecucionSuplemento(t.id).subscribe({next:()=>{this.showMessage("Ejecuci\xf3n de suplemento eliminada exitosamente"),this.loadEjecuciones()},error:()=>{this.showMessage("Error al eliminar la ejecuci\xf3n")}})}showMessage(t){this._snackBar.open(t,"Cerrar",{duration:5e3,horizontalPosition:"end",verticalPosition:"top"})}applyFilters(){this.showMessage("Filtros aplicados")}clearFilters(){this.filterForm.reset(),this.loadEjecuciones(),this.showMessage("Filtros limpiados")}exportToCSV(){this.showMessage("Exportar a CSV no implementado")}onPageChange(t){}toggleDetails(t){if(this.selectedEjecucion?.id===t)this.selectedEjecucion=null;else{const o=this.dataSource.data.find(i=>i.id===t);this.selectedEjecucion=o||null,o&&this.selectedEjecucionForm.patchValue({id:o.id,no_suplemento_id:o.no_suplemento_id,proveedor_id:o.proveedor_id,no_contrato_id:o.no_contrato_id,trabajo_ejecutado:o.trabajo_ejecutado,costo_cup:o.costo_cup,costo_cl:o.costo_cl,fecha_ejecucion:o.fecha_ejecucion?new Date(o.fecha_ejecucion).toISOString().substring(0,10):null,proveedor:o.proveedor,contrato:o.contrato,suplemento:o.suplemento})}}onSaveEjecucion(){if(this.selectedEjecucionForm.invalid)return void this.showMessage("Por favor complete todos los campos requeridos");const t=this.selectedEjecucionForm.getRawValue(),o={...this.selectedEjecucion,...t,fecha_ejecucion:t.fecha_ejecucion?new Date(t.fecha_ejecucion):null,proveedor:this.selectedEjecucion?.proveedor,contrato:this.selectedEjecucion?.contrato,suplemento:this.selectedEjecucion?.suplemento};o.id?this.suplementoService.updateEjecucionSuplemento(o.id,o).subscribe({next:i=>{this.showMessage("Ejecuci\xf3n actualizada correctamente"),this.loadEjecuciones(),this.selectedEjecucion=null},error:i=>{this.showMessage("Error al actualizar la ejecuci\xf3n")}}):this.suplementoService.createEjecucionSuplemento(o).subscribe({next:i=>{this.showMessage("Ejecuci\xf3n creada correctamente"),this.loadEjecuciones(),this.selectedEjecucion=null},error:i=>{this.showMessage("Error al crear la ejecuci\xf3n")}})}onCancelEdit(){this.selectedEjecucion=null}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(J.u),e.Y36(N._),e.Y36(Q.z),e.Y36(q.y),e.Y36(A.uw),e.Y36(M.ux),e.Y36(c.qu))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-ejecucion-suplemento"]],viewQuery:function(o,i){if(1&o&&(e.Gf(f.NW,5),e.Gf(p.YE,5)),2&o){let r;e.iGM(r=e.CRH())&&(i._paginator=r.first),e.iGM(r=e.CRH())&&(i._sort=r.first)}},standalone:!0,features:[e._Bn([b.Mq,u.uU,{provide:w.Ad,useValue:"es-ES"}]),e.jDz],decls:35,vars:8,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"relative","flex","flex-col","flex-auto","p-6","pr-3","pb-3","bg-card","rounded-2xl","shadow","overflow-hidden","mb-6","w-full"],[1,"absolute","bottom-0","right-0","w-24","h-24","-m-6"],[1,"icon-size-24","opacity-25","text-green-500","dark:text-green-400",3,"svgIcon"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4","mb-6"],[1,"text-2xl","font-semibold"],[1,"flex","flex-col","sm:flex-row","gap-3","w-full","sm:w-auto"],["mat-raised-button","","color","primary",1,"w-full","sm:w-auto",3,"click"],["mat-stroked-button","",1,"w-full","sm:w-auto",3,"click"],["mat-button","",1,"w-full","sm:w-auto",3,"click"],[1,"flex","flex-col","sm:flex-row","shrink-0","items-center","justify-between","py-4","px-6","md:px-8","border-b"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","autocomplete","off","placeholder","Buscar ejecuciones",3,"formControl"],[1,"flex","items-center","gap-4","mt-4","sm:mt-0"],["mat-icon-button","","matTooltip","Exportar tabla a CSV","aria-label","Exportar tabla a CSV",3,"color","click"],[3,"svgIcon"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf","ngIfElse"],["noEjecuciones",""],[1,"flex","flex-col","h-full","overflow-y-auto"],["matSort","","matSortDisableClear","",1,"inventory-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5",2,"grid-template-columns","120px 200px 150px 150px 150px 150px 150px 80px"],[3,"mat-sort-header"],[1,"text-right",3,"mat-sort-header"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","bg-gray-50","dark:bg-gray-800",2,"grid-template-columns","120px 200px 150px 150px 150px 150px 150px 80px",3,"formGroup"],[1,"fuse-mat-dense","fuse-mat-no-subscript","w-full"],["matInput","","formControlName","codigo_proveedor_filter","placeholder","Filtrar c\xf3digo..."],["matInput","","formControlName","proveedor_filter","placeholder","Filtrar proveedor..."],["matInput","","formControlName","suplemento_fecha_filter","placeholder","Filtrar fecha..."],["matInput","","formControlName","trabajo_ejecutado_filter","placeholder","Filtrar trabajo..."],["matInput","","formControlName","costo_cup_filter","placeholder","Filtrar CUP..."],["matInput","","formControlName","costo_usd_filter","placeholder","Filtrar USD..."],["matInput","","formControlName","fecha_ejecucion_filter","placeholder","Filtrar fecha..."],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"],[1,"inventory-grid","grid","gap-4","py-3","px-6","md:px-8","border-b","items-center","text-sm","hover:bg-gray-50","dark:hover:bg-gray-800",2,"grid-template-columns","120px 200px 150px 150px 150px 150px 150px 80px"],[1,"truncate",3,"matTooltip"],[1,"text-right"],[1,"flex","items-center","justify-end"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],[1,"icon-size-5",3,"svgIcon"],["class","grid",4,"ngIf"],[1,"grid"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"responsive-form","flex","flex-col","w-full","mx-auto","p-8",3,"formGroup"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-1/2","sm:pl-8"],[1,"w-full"],["matInput","","formControlName","no_suplemento_id","type","number"],[4,"ngIf"],["matInput","","readonly","",3,"value"],["matInput","","formControlName","trabajo_ejecutado","rows","3"],["matInput","","type","number","step","0.01","min","0","formControlName","costo_cup"],["matInput","","formControlName","fecha_ejecucion","readonly","",3,"matDatepicker","click"],["matSuffix","",3,"for"],["picker",""],[1,"flex","justify-end","gap-4","mt-8"],["mat-stroked-button","","type","button",3,"click"],["mat-flat-button","","color","primary",3,"disabled","click"],[1,"p-8","sm:p-16","border-b","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"mat-icon",3),e.qZA(),e.TgZ(4,"div",4)(5,"h2",5),e._uU(6,"Ejecuci\xf3n de Suplementos"),e.qZA(),e.TgZ(7,"div",6)(8,"button",7),e.NdJ("click",function(){return i.openAddEjecucionDialog()}),e.TgZ(9,"mat-icon"),e._uU(10,"add"),e.qZA(),e.TgZ(11,"span"),e._uU(12,"Agregar Ejecuci\xf3n"),e.qZA()(),e.TgZ(13,"button",8),e.NdJ("click",function(){return i.applyFilters()}),e.TgZ(14,"mat-icon"),e._uU(15,"filter_alt"),e.qZA(),e.TgZ(16,"span"),e._uU(17,"Aplicar Filtros"),e.qZA()(),e.TgZ(18,"button",9),e.NdJ("click",function(){return i.clearFilters()}),e.TgZ(19,"mat-icon"),e._uU(20,"clear_all"),e.qZA(),e.TgZ(21,"span"),e._uU(22,"Limpiar"),e.qZA()()()(),e.TgZ(23,"div",10)(24,"mat-form-field",11),e._UZ(25,"mat-icon",12)(26,"input",13),e.qZA(),e.TgZ(27,"div",14)(28,"button",15),e.NdJ("click",function(){return i.exportToCSV()}),e._UZ(29,"mat-icon",16),e.qZA()()(),e.TgZ(30,"div",17)(31,"div",18),e.YNc(32,je,37,16,"ng-container",19)(33,we,2,0,"ng-template",null,20,e.W1O),e.qZA()()()()),2&o){const r=e.MAs(34);e.xp6(3),e.Q6J("svgIcon","heroicons_outline:check-circle"),e.xp6(21),e.Q6J("subscriptSizing","dynamic"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:magnifying-glass"),e.xp6(1),e.Q6J("formControl",i.searchInputControl),e.xp6(2),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:arrow-up-tray"),e.xp6(3),e.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",r)}},dependencies:[u.ez,u.sg,u.O5,u.JJ,u.uU,d.p0,f.TU,f.NW,p.JX,p.YE,p.nU,x.Ps,x.Hw,g.ot,g.lW,g.RK,Z.AV,Z.gM,A.Is,M.ZX,c.UX,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.qQ,c.oH,c.sg,c.u,C.LD,m.KE,m.hX,m.TO,m.qo,m.R9,v.c,v.Nt,m.lN,b.FA,b.Mq,b.hl,b.nW,w.XK,c.u5],encapsulation:2})}return n})();var z=s(5195),qe=s(2096);const Ue=[{id:1,proveedor_id:1,no_contrato_id:101,no_suplemento_id:201,costo_cup:5e3,costo_cl:0,trabajo_ejecutado:"Trabajo de mantenimiento",fecha_ejecucion:new Date("2023-12-01"),proveedor:{id:1,municipio_id:1,ministerio_id:1,nombre:"Proveedor A",codigo:"P001",telefonos:"12345678",domicilio:"Calle 1",municipio:null,ministerio:null,fechaCreacion:"2023-01-01"},contrato:{id:101,vigencia_id:1,proveedor_id:1,tipo_contrato_id:1,no_contrato:1001,fecha_entrada:new Date("2023-01-01"),fecha_firmado:new Date("2023-01-10"),valor_cup:1e5,monto_vencimiento_cup:0,monto_vencimiento_cl:0,valor_usd:0,monto_vencimiento_usd:0,observaciones:"",no_contrato_contratacion:1001,fecha_comite_contratacion:new Date("2023-01-05"),no_comite_contratacion:1,no_acuerdo_comite_contratacion:1,fecha_comite_administracion:new Date("2023-01-07"),no_comite_administracion:1,no_acuerdo_comite_administracion:1,departamento_id:1,fecha_vencido:new Date("2023-11-30"),valor_monto_restante:0,entidad:[],vigencia:null,proveedor:null,tipo_contrato:null,departamento:null,estado:"Vencido"},suplemento:{id:201,estado:"Vencido",vigencia_id:1,proveedor_id:1,tipo_contrato_id:1,no_contrato_id:101,departamento_id:1,fecha_entrada:new Date("2023-01-15"),fecha_firmado:new Date("2023-01-20"),valor_cup:2e4,monto_vencimiento_cup:0,monto_vencimiento_cl:0,valor_usd:0,monto_vencimiento_usd:0,observaciones:"",no_contrato_contratacion:1001,fecha_comite_contratacion:new Date("2023-01-18"),no_comite_contratacion:1,no_acuerdo_comite_contratacion:1,fecha_comite_administracion:new Date("2023-01-19"),no_comite_administracion:1,no_acuerdo_comite_administracion:1,fecha_vencido:new Date("2023-11-30"),valor_monto_restante:0,vigencia:null,proveedor:null,tipo_contrato:null,departamento:null}},{id:2,proveedor_id:2,no_contrato_id:102,no_suplemento_id:202,costo_cup:3e3,costo_cl:0,trabajo_ejecutado:"Reparaci\xf3n de equipo",fecha_ejecucion:new Date("2023-11-15"),proveedor:{id:2,municipio_id:2,ministerio_id:2,nombre:"Proveedor B",codigo:"P002",telefonos:"87654321",domicilio:"Calle 2",municipio:null,ministerio:null,fechaCreacion:"2023-02-01"},contrato:{id:102,vigencia_id:2,proveedor_id:2,tipo_contrato_id:2,no_contrato:1002,fecha_entrada:new Date("2023-02-01"),fecha_firmado:new Date("2023-02-10"),valor_cup:8e4,monto_vencimiento_cup:0,monto_vencimiento_cl:0,valor_usd:0,monto_vencimiento_usd:0,observaciones:"",no_contrato_contratacion:1002,fecha_comite_contratacion:new Date("2023-02-05"),no_comite_contratacion:2,no_acuerdo_comite_contratacion:2,fecha_comite_administracion:new Date("2023-02-07"),no_comite_administracion:2,no_acuerdo_comite_administracion:2,departamento_id:2,fecha_vencido:new Date("2023-10-31"),valor_monto_restante:0,entidad:[],vigencia:null,proveedor:null,tipo_contrato:null,departamento:null,estado:"Vencido"},suplemento:{id:202,estado:"Vencido",vigencia_id:2,proveedor_id:2,tipo_contrato_id:2,no_contrato_id:102,departamento_id:2,fecha_entrada:new Date("2023-02-15"),fecha_firmado:new Date("2023-02-20"),valor_cup:15e3,monto_vencimiento_cup:0,monto_vencimiento_cl:0,valor_usd:0,monto_vencimiento_usd:0,observaciones:"",no_contrato_contratacion:1002,fecha_comite_contratacion:new Date("2023-02-18"),no_comite_contratacion:2,no_acuerdo_comite_contratacion:2,fecha_comite_administracion:new Date("2023-02-19"),no_comite_administracion:2,no_acuerdo_comite_administracion:2,fecha_vencido:new Date("2023-10-31"),valor_monto_restante:0,vigencia:null,proveedor:null,tipo_contrato:null,departamento:null}}];let ke=(()=>{class n{constructor(){this.ejecuciones=[],this.ejecuciones=Ue}getExpiredEjecuciones(t,o){const i=this.ejecuciones.filter(S=>"Vencido"===S.estado),r=t*o,_=i.slice(r,r+o);return(0,qe.of)({data:_,total:i.length})}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Fe(n,a){1&n&&(e.TgZ(0,"div",12),e._UZ(1,"mat-progress-bar",13),e.qZA())}function Ie(n,a){if(1&n&&(e.TgZ(0,"div",14)(1,"div",15),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.errorMessage)}}function De(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," No. Suplemento "),e.qZA())}function Je(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",35),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t.no_suplemento_id," ")}}function Ne(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Proveedor "),e.qZA())}function Qe(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",36),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",(null==t.proveedor?null:t.proveedor.nombre)||"N/A"," ")}}function Me(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," No. Contrato "),e.qZA())}function Le(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",36),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",(null==t.contrato?null:t.contrato.no_contrato)||"N/A"," ")}}function ze(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Trabajo Ejecutado "),e.qZA())}function Ye(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",36),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t.trabajo_ejecutado," ")}}function Pe(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Costo CUP "),e.qZA())}function Oe(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",37),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",e.gM2(3,1,t.costo_cup,"CUP","symbol","1.2-2")," ")}}function Be(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Fecha Ejecuci\xf3n "),e.qZA())}function Ve(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",38),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,t.fecha_ejecucion,"dd/MM/yyyy")," ")}}function Re(n,a){1&n&&(e.TgZ(0,"th",39),e._uU(1," Acciones "),e.qZA())}function He(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",34)(1,"div",40)(2,"button",41),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.restoreEjecucion(r.id))}),e._UZ(3,"mat-icon",42),e.qZA(),e.TgZ(4,"button",43),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.deleteEjecucion(r.id))}),e._UZ(5,"mat-icon",44),e.qZA()()()}2&n&&(e.xp6(3),e.Q6J("svgIcon","heroicons_outline:arrow-path"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:trash"))}function Ge(n,a){1&n&&e._UZ(0,"tr",45)}function We(n,a){1&n&&e._UZ(0,"tr",46)}function $e(n,a){1&n&&(e.TgZ(0,"div",47),e._uU(1," No hay ejecuciones vencidas "),e.qZA())}const Ke=n=>({"pointer-events-none":n}),Xe=()=>[5,10,25,100];function et(n,a){if(1&n&&(e.TgZ(0,"div",16)(1,"table",17,18),e.ynx(3,19),e.YNc(4,De,2,0,"th",20)(5,Je,3,1,"td",21),e.BQk(),e.ynx(6,22),e.YNc(7,Ne,2,0,"th",20)(8,Qe,3,1,"td",21),e.BQk(),e.ynx(9,23),e.YNc(10,Me,2,0,"th",20)(11,Le,3,1,"td",21),e.BQk(),e.ynx(12,24),e.YNc(13,ze,2,0,"th",20)(14,Ye,3,1,"td",21),e.BQk(),e.ynx(15,25),e.YNc(16,Pe,2,0,"th",20)(17,Oe,4,6,"td",21),e.BQk(),e.ynx(18,26),e.YNc(19,Be,2,0,"th",20)(20,Ve,4,4,"td",21),e.BQk(),e.ynx(21,27),e.YNc(22,Re,2,0,"th",28)(23,He,6,2,"td",21),e.BQk(),e.YNc(24,Ge,1,0,"tr",29)(25,We,1,0,"tr",30),e.qZA(),e.YNc(26,$e,2,0,"div",31),e._UZ(27,"mat-paginator",32),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource)("trackByFn",t.trackByFn),e.xp6(23),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("ngIf",0===t.dataSource.data.length&&!t.isLoading),e.xp6(1),e.Q6J("ngClass",e.VKq(12,Ke,t.isLoading))("length",t.dataSource.data.length)("pageIndex",0)("pageSize",10)("pageSizeOptions",e.DdM(14,Xe))("showFirstLastButtons",!0)}}let tt=(()=>{class n{constructor(t,o){this.ejecucionSuplementoService=t,this.cdr=o,this.displayedColumns=["no_suplemento_id","proveedor","contrato","trabajo_ejecutado","costo_cup","fecha_ejecucion","acciones"],this.isLoading=!1,this.errorMessage="",this.searchInputControl=new c.NI,this.selectedEjecucion=null,this.dataSource=new d.by([])}ngOnInit(){this.loadExpiredEjecuciones(),this.setupSearch()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.cdr.markForCheck()}setupSearch(){this.dataSource.filterPredicate=(t,o)=>{if(!o)return!0;const i=o.toLowerCase().split(" ").filter(l=>l.length>0),r=[t.no_suplemento_id?.toString()||"",t.proveedor?.nombre||"",t.contrato?.no_contrato?.toString()||"",t.trabajo_ejecutado||"",t.costo_cup?.toString()||""].join(" ").toLowerCase();return i.every(l=>r.includes(l))},this.searchInputControl.valueChanges.pipe((0,y.b)(300)).subscribe(t=>{this.dataSource.filter=t?.trim().toLowerCase()||""})}loadExpiredEjecuciones(){this.isLoading=!0,this.errorMessage="",console.log("Cargando ejecuciones vencidas...");const t=[{id:1,no_suplemento_id:1,proveedor_id:1,no_contrato_id:1,trabajo_ejecutado:"Instalaci\xf3n de equipos de red",costo_cup:15e3,costo_cl:0,fecha_ejecucion:new Date("2024-01-15"),estado:"Vencido",proveedor:{id:1,nombre:"Tecnolog\xeda Avanzada S.A.",codigo:"TECH001"},contrato:{id:1,no_contrato:1001,objeto_contrato:"Servicios de TI"},suplemento:{id:1,no_suplemento:"SUP-001"}},{id:2,no_suplemento_id:2,proveedor_id:2,no_contrato_id:2,trabajo_ejecutado:"Mantenimiento de servidores",costo_cup:25e3,costo_cl:0,fecha_ejecucion:new Date("2024-02-20"),estado:"Vencido",proveedor:{id:2,nombre:"Sistemas Integrales Ltd.",codigo:"SIS002"},contrato:{id:2,no_contrato:1002,objeto_contrato:"Mantenimiento de infraestructura"},suplemento:{id:2,no_suplemento:"SUP-002"}},{id:3,no_suplemento_id:3,proveedor_id:1,no_contrato_id:1,trabajo_ejecutado:"Configuraci\xf3n de firewall",costo_cup:8500,costo_cl:0,fecha_ejecucion:new Date("2024-03-10"),estado:"Vencido",proveedor:{id:1,nombre:"Tecnolog\xeda Avanzada S.A.",codigo:"TECH001"},contrato:{id:1,no_contrato:1001,objeto_contrato:"Servicios de TI"},suplemento:{id:3,no_suplemento:"SUP-003"}}];this.ejecucionSuplementoService.getExpiredEjecuciones(0,10).subscribe({next:o=>{console.log("Respuesta del servicio:",o);let i=[];o&&o.data&&Array.isArray(o.data)&&o.data.length>0?(i=o.data,console.log("Usando datos del servicio")):Array.isArray(o)&&o.length>0?(i=o,console.log("Usando respuesta directa del servicio")):(console.warn("Servicio no devolvi\xf3 datos v\xe1lidos, usando datos mock"),i=t),console.log("Datos finales para la tabla:",i),this.dataSource.data=i,this.isLoading=!1,this.cdr.markForCheck()},error:o=>{console.error("Error del servicio, usando datos mock:",o),this.dataSource.data=t,this.errorMessage="",this.isLoading=!1,this.cdr.markForCheck()}})}trackByFn(t,o){return o.id||t}selectEjecucion(t){this.selectedEjecucion=this.selectedEjecucion?.id===t.id?null:t}isSelected(t){return this.selectedEjecucion?.id===t.id}restoreEjecucion(t){console.log("Restaurar ejecuci\xf3n con id:",t)}deleteEjecucion(t){console.log("Eliminar ejecuci\xf3n con id:",t)}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(ke),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-expired"]],viewQuery:function(o,i){if(1&o&&(e.Gf(p.YE,5),e.Gf(f.NW,5)),2&o){let r;e.iGM(r=e.CRH())&&(i.sort=r.first),e.iGM(r=e.CRH())&&(i.paginator=r.first)}},standalone:!0,features:[e.jDz],decls:13,vars:7,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],["class","flex justify-center p-8",4,"ngIf"],["class","p-8 text-center",4,"ngIf"],["class","overflow-x-auto mx-6",4,"ngIf"],[1,"flex","justify-center","p-8"],["mode","indeterminate"],[1,"p-8","text-center"],[1,"text-red-600","text-lg"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackByFn"],["recentTransactionsTable",""],["matColumnDef","no_suplemento_id"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","pr-6","mat-cell","",4,"matCellDef"],["matColumnDef","proveedor"],["matColumnDef","contrato"],["matColumnDef","trabajo_ejecutado"],["matColumnDef","costo_cup"],["matColumnDef","fecha_ejecucion"],["matColumnDef","acciones"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","",4,"matHeaderCellDef"],["class","shadow-none","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","order-row h-16","mat-row","",4,"matRowDef","matRowDefColumns"],["class","p-8 sm:p-16 border-t text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],["mat-cell","",1,"pr-6"],[1,"text-md","font-medium","text-secondary"],[1,"text-md","font-medium"],[1,"text-md","font-medium","text-green-600"],[1,"text-md","font-medium","text-red-600"],["mat-header-cell","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"flex","items-center","gap-2"],["mat-stroked-button","","matTooltip","Restaurar",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4",3,"svgIcon"],["mat-stroked-button","","matTooltip","Eliminar permanentemente",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-red-600",3,"svgIcon"],["mat-header-row","",1,"shadow-none"],["mat-row","",1,"order-row","h-16"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Ejecuciones de Suplementos Vencidas"),e.qZA(),e.TgZ(4,"div",3)(5,"mat-form-field",4),e._UZ(6,"mat-icon",5)(7,"input",6),e.qZA()()(),e.TgZ(8,"div",7)(9,"div",8),e.YNc(10,Fe,2,0,"div",9)(11,Ie,3,1,"div",10)(12,et,28,15,"div",11),e.qZA()()()),2&o&&(e.xp6(6),e.Q6J("svgIcon","heroicons_solid:magnifying-glass"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar ejecuciones..."),e.xp6(3),e.Q6J("ngIf",i.isLoading),e.xp6(1),e.Q6J("ngIf",i.errorMessage&&!i.isLoading),e.xp6(1),e.Q6J("ngIf",!i.isLoading))},dependencies:[u.ez,u.mk,u.O5,u.H9,u.uU,g.ot,g.lW,T.Cv,T.pW,p.JX,p.YE,p.nU,d.p0,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,x.Ps,x.Hw,c.UX,c.Fj,c.JJ,c.oH,f.TU,f.NW,m.lN,m.KE,m.qo,v.c,v.Nt,C.LD,Z.AV,Z.gM,z.QW],styles:[".expired-component .mat-mdc-table .mat-mdc-header-row{height:56px}.expired-component .mat-mdc-table .mat-mdc-row{height:72px}.expired-component .mat-mdc-table .mat-mdc-row:hover{--tw-bg-opacity: 1;background-color:rgb(248 250 252 / var(--tw-bg-opacity))}:is(.dark .expired-component .mat-mdc-table .mat-mdc-row:hover){background-color:var(--fuse-bg-hover)}.expired-component .mat-mdc-table .mat-mdc-cell,.expired-component .mat-mdc-table .mat-mdc-header-cell{border-bottom:1px solid;--tw-border-opacity: 1;border-color:rgb(226 232 240 / var(--tw-border-opacity))}:is(.dark .expired-component .mat-mdc-table .mat-mdc-cell),:is(.dark .expired-component .mat-mdc-table .mat-mdc-header-cell){--tw-border-opacity: 1;border-color:rgb(51 65 85 / var(--tw-border-opacity))}.expired-component .order-row{cursor:pointer;transition:background-color .15s cubic-bezier(.25,.8,.25,1)}.expired-component .search-input .mat-mdc-form-field-subscript-wrapper{display:none}@media (max-width: 768px){.expired-component .mat-mdc-table .mat-mdc-cell,.expired-component .mat-mdc-table .mat-mdc-header-cell{padding:8px 4px;font-size:12px}}.loading-shade{position:absolute;inset:0 0 56px;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.action-buttons .mat-mdc-button{min-width:32px;padding:0 8px}.action-buttons .mat-mdc-button .mat-icon{margin:0}.status-expired{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity))}:is(.dark .status-expired){--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity))}.status-expired{padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500}.currency-amount{font-family:Roboto Mono,monospace;font-weight:500}.mat-mdc-table{background:transparent}.mat-mdc-table .mat-mdc-header-cell{font-weight:600;color:var(--fuse-text-secondary);border-bottom-color:var(--fuse-border)}.mat-mdc-table .mat-mdc-cell{border-bottom-color:var(--fuse-border)}.mat-mdc-table .mat-mdc-row:hover{background-color:var(--fuse-bg-hover)}.fuse-mat-dense .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-outlined-button{border-color:var(--fuse-border)}.mat-mdc-outlined-button:hover{background-color:var(--fuse-bg-hover)}.mat-mdc-progress-bar{--mdc-linear-progress-active-indicator-color: var(--fuse-primary)}.mat-mdc-tooltip{font-size:12px}@media (max-width: 1024px){.overflow-x-auto .mat-mdc-table{min-width:800px}}.overflow-x-auto::-webkit-scrollbar{height:6px}.overflow-x-auto::-webkit-scrollbar-track{background:var(--fuse-bg-card)}.overflow-x-auto::-webkit-scrollbar-thumb{background:var(--fuse-border);border-radius:3px}.overflow-x-auto::-webkit-scrollbar-thumb:hover{background:var(--fuse-text-hint)}\n"],encapsulation:2,changeDetection:0})}return n})();function ot(n,a){1&n&&(e.TgZ(0,"div",12),e._UZ(1,"mat-progress-bar",13),e.qZA())}function nt(n,a){if(1&n&&(e.TgZ(0,"div",14)(1,"div",15),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.errorMessage)}}function it(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," No. Suplemento "),e.qZA())}function rt(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",35),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t.no_suplemento," ")}}function at(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Proveedor "),e.qZA())}function ct(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"div",36)(2,"span",37),e._uU(3),e.qZA(),e.TgZ(4,"span",38),e._uU(5),e.qZA()()()),2&n){const t=a.$implicit;e.xp6(3),e.hij(" ",(null==t.proveedor?null:t.proveedor.nombre)||"N/A"," "),e.xp6(2),e.hij(" ",(null==t.proveedor?null:t.proveedor.codigo)||""," ")}}function lt(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Tipo Suplemento "),e.qZA())}function st(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",37),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",(null==t.tipo_suplemento?null:t.tipo_suplemento.nombre)||"N/A"," ")}}function dt(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Valor CUP "),e.qZA())}function ut(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",39),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",e.gM2(3,1,t.valor_cup,"CUP","symbol","1.2-2")," ")}}function mt(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Fecha Inicio "),e.qZA())}function pt(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"span",37),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,t.fecha_inicio,"dd/MM/yyyy")," ")}}function _t(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1," Fecha Vencimiento "),e.qZA())}function ft(n,a){if(1&n&&(e.TgZ(0,"td",34)(1,"div",40)(2,"span",41),e._uU(3),e.ALo(4,"date"),e.qZA()()()),2&n){const t=a.$implicit;e.xp6(3),e.hij(" ",e.xi3(4,1,t.fecha_vencido,"dd/MM/yyyy")," ")}}function gt(n,a){1&n&&(e.TgZ(0,"th",42),e._uU(1," Acciones "),e.qZA())}function ht(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",34)(1,"div",43)(2,"button",44),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.restoreSuplemento(r.id))}),e._UZ(3,"mat-icon",45),e.qZA(),e.TgZ(4,"button",46),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.deleteSuplemento(r.id))}),e._UZ(5,"mat-icon",47),e.qZA(),e.TgZ(6,"button",48),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.viewDetails(r.id))}),e._UZ(7,"mat-icon",49),e.qZA()()()}2&n&&(e.xp6(3),e.Q6J("svgIcon","heroicons_outline:arrow-path"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:trash"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:eye"))}function vt(n,a){1&n&&e._UZ(0,"tr",50)}function xt(n,a){1&n&&e._UZ(0,"tr",51)}function bt(n,a){1&n&&(e.TgZ(0,"div",52)(1,"div",53),e._UZ(2,"mat-icon",54),e.TgZ(3,"span",55),e._uU(4,"No hay suplementos vencidos"),e.qZA(),e.TgZ(5,"span",56),e._uU(6,"Los suplementos vencidos aparecer\xe1n aqu\xed"),e.qZA()()()),2&n&&(e.xp6(2),e.Q6J("svgIcon","heroicons_outline:document-text"))}const Zt=n=>({"pointer-events-none":n}),Tt=()=>[5,10,25,100];function Ct(n,a){if(1&n&&(e.TgZ(0,"div",16)(1,"table",17,18),e.ynx(3,19),e.YNc(4,it,2,0,"th",20)(5,rt,3,1,"td",21),e.BQk(),e.ynx(6,22),e.YNc(7,at,2,0,"th",20)(8,ct,6,2,"td",21),e.BQk(),e.ynx(9,23),e.YNc(10,lt,2,0,"th",20)(11,st,3,1,"td",21),e.BQk(),e.ynx(12,24),e.YNc(13,dt,2,0,"th",20)(14,ut,4,6,"td",21),e.BQk(),e.ynx(15,25),e.YNc(16,mt,2,0,"th",20)(17,pt,4,4,"td",21),e.BQk(),e.ynx(18,26),e.YNc(19,_t,2,0,"th",20)(20,ft,5,4,"td",21),e.BQk(),e.ynx(21,27),e.YNc(22,gt,2,0,"th",28)(23,ht,8,3,"td",21),e.BQk(),e.YNc(24,vt,1,0,"tr",29)(25,xt,1,0,"tr",30),e.qZA(),e.YNc(26,bt,7,1,"div",31),e._UZ(27,"mat-paginator",32),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource)("trackByFn",t.trackByFn),e.xp6(23),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("ngIf",0===t.dataSource.data.length&&!t.isLoading),e.xp6(1),e.Q6J("ngClass",e.VKq(12,Zt,t.isLoading))("length",t.dataSource.data.length)("pageIndex",0)("pageSize",10)("pageSizeOptions",e.DdM(14,Tt))("showFirstLastButtons",!0)}}const At=[{path:"list",component:re},{path:"ejecucion",component:Ee},{path:"vencidas",component:(()=>{class n{constructor(t,o){this.suplementoService=t,this.cdr=o,this.displayedColumns=["no_suplemento","proveedor","tipo_suplemento","valor_cup","fecha_inicio","fecha_vencido","acciones"],this.isLoading=!1,this.errorMessage="",this.searchInputControl=new c.NI,this.dataSource=new d.by([])}ngOnInit(){this.loadSuplementosVencidos(),this.setupSearch()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.cdr.markForCheck()}setupSearch(){this.dataSource.filterPredicate=(t,o)=>{if(!o)return!0;const i=o.toLowerCase().split(" ").filter(l=>l.length>0),r=[t.no_suplemento||"",t.proveedor?.nombre||"",t.tipo_suplemento?.nombre||"",t.valor_cup?.toString()||""].join(" ").toLowerCase();return i.every(l=>r.includes(l))},this.searchInputControl.valueChanges.pipe((0,y.b)(300)).subscribe(t=>{this.dataSource.filter=t?.trim().toLowerCase()||""})}loadSuplementosVencidos(){this.isLoading=!0,this.errorMessage="",console.log("Cargando suplementos vencidos...");const t=[{id:1,no_suplemento:"SUP-001",proveedor_id:1,tipo_suplemento_id:1,valor_cup:5e4,valor_usd:0,fecha_inicio:new Date("2024-01-01"),fecha_vencido:new Date("2024-01-31"),estado:"Vencido",proveedor:{id:1,nombre:"Tecnolog\xeda Avanzada S.A.",codigo:"TECH001"},tipo_suplemento:{id:1,nombre:"Servicios de TI",descripcion:"Servicios tecnol\xf3gicos"}},{id:2,no_suplemento:"SUP-002",proveedor_id:2,tipo_suplemento_id:2,valor_cup:75e3,valor_usd:0,fecha_inicio:new Date("2024-02-01"),fecha_vencido:new Date("2024-02-28"),estado:"Vencido",proveedor:{id:2,nombre:"Sistemas Integrales Ltd.",codigo:"SIS002"},tipo_suplemento:{id:2,nombre:"Mantenimiento",descripcion:"Servicios de mantenimiento"}},{id:3,no_suplemento:"SUP-003",proveedor_id:3,tipo_suplemento_id:1,valor_cup:35e3,valor_usd:0,fecha_inicio:new Date("2024-03-01"),fecha_vencido:new Date("2024-03-15"),estado:"Vencido",proveedor:{id:3,nombre:"Consultor\xeda Digital Corp.",codigo:"CDC003"},tipo_suplemento:{id:1,nombre:"Servicios de TI",descripcion:"Servicios tecnol\xf3gicos"}},{id:4,no_suplemento:"SUP-004",proveedor_id:1,tipo_suplemento_id:3,valor_cup:12e4,valor_usd:0,fecha_inicio:new Date("2024-04-01"),fecha_vencido:new Date("2024-04-30"),estado:"Vencido",proveedor:{id:1,nombre:"Tecnolog\xeda Avanzada S.A.",codigo:"TECH001"},tipo_suplemento:{id:3,nombre:"Capacitaci\xf3n",descripcion:"Servicios de formaci\xf3n"}}];this.suplementoService.getSuplementosVencidos(0,10).subscribe({next:o=>{console.log("Respuesta del servicio:",o);let i=[];o&&o.data&&Array.isArray(o.data)&&o.data.length>0?(i=o.data,console.log("Usando datos del servicio")):Array.isArray(o)&&o.length>0?(i=o,console.log("Usando respuesta directa del servicio")):(console.warn("Servicio no devolvi\xf3 datos v\xe1lidos, usando datos mock"),i=t),console.log("Datos finales para la tabla:",i),this.dataSource.data=i,this.isLoading=!1,this.cdr.markForCheck()},error:o=>{console.error("Error del servicio, usando datos mock:",o),this.dataSource.data=t,this.errorMessage="",this.isLoading=!1,this.cdr.markForCheck()}})}trackByFn(t,o){return o.id||t}restoreSuplemento(t){console.log("Restaurar suplemento con id:",t)}deleteSuplemento(t){console.log("Eliminar suplemento con id:",t)}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(q.y),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-suplementos-expired"]],viewQuery:function(o,i){if(1&o&&(e.Gf(p.YE,5),e.Gf(f.NW,5)),2&o){let r;e.iGM(r=e.CRH())&&(i.sort=r.first),e.iGM(r=e.CRH())&&(i.paginator=r.first)}},standalone:!0,features:[e.jDz],decls:13,vars:7,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],["class","flex justify-center p-8",4,"ngIf"],["class","p-8 text-center",4,"ngIf"],["class","overflow-x-auto mx-6",4,"ngIf"],[1,"flex","justify-center","p-8"],["mode","indeterminate"],[1,"p-8","text-center"],[1,"text-red-600","text-lg"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackByFn"],["suplementosTable",""],["matColumnDef","no_suplemento"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","pr-6","mat-cell","",4,"matCellDef"],["matColumnDef","proveedor"],["matColumnDef","tipo_suplemento"],["matColumnDef","valor_cup"],["matColumnDef","fecha_inicio"],["matColumnDef","fecha_vencido"],["matColumnDef","acciones"],["class","bg-gray-50 dark:bg-black dark:bg-opacity-5","mat-header-cell","",4,"matHeaderCellDef"],["class","shadow-none","mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","order-row h-16","mat-row","",4,"matRowDef","matRowDefColumns"],["class","p-8 sm:p-16 border-t text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],["mat-cell","",1,"pr-6"],[1,"text-md","font-medium","text-secondary"],[1,"flex","flex-col"],[1,"text-md","font-medium"],[1,"text-sm","text-secondary"],[1,"text-md","font-medium","text-green-600","currency-amount"],[1,"flex","items-center"],[1,"text-md","font-medium","text-red-600"],["mat-header-cell","",1,"bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"flex","items-center","gap-2","action-buttons"],["mat-stroked-button","","matTooltip","Restaurar suplemento",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-blue-600",3,"svgIcon"],["mat-stroked-button","","matTooltip","Eliminar permanentemente",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-red-600",3,"svgIcon"],["mat-stroked-button","","matTooltip","Ver detalles",1,"min-h-7","min-w-10","h-7","px-2","leading-6",3,"click"],[1,"icon-size-4","text-gray-600",3,"svgIcon"],["mat-header-row","",1,"shadow-none"],["mat-row","",1,"order-row","h-16"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"],[1,"flex","flex-col","items-center"],[1,"icon-size-24","text-gray-400","mb-4",3,"svgIcon"],[1,"text-gray-500"],[1,"text-sm","text-gray-400","mt-2"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Suplementos Vencidos"),e.qZA(),e.TgZ(4,"div",3)(5,"mat-form-field",4),e._UZ(6,"mat-icon",5)(7,"input",6),e.qZA()()(),e.TgZ(8,"div",7)(9,"div",8),e.YNc(10,ot,2,0,"div",9)(11,nt,3,1,"div",10)(12,Ct,28,15,"div",11),e.qZA()()()),2&o&&(e.xp6(6),e.Q6J("svgIcon","heroicons_solid:magnifying-glass"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar suplementos..."),e.xp6(3),e.Q6J("ngIf",i.isLoading),e.xp6(1),e.Q6J("ngIf",i.errorMessage&&!i.isLoading),e.xp6(1),e.Q6J("ngIf",!i.isLoading))},dependencies:[u.ez,u.mk,u.O5,u.H9,u.uU,g.ot,g.lW,T.Cv,T.pW,p.JX,p.YE,p.nU,d.p0,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,x.Ps,x.Hw,c.UX,c.Fj,c.JJ,c.oH,f.TU,f.NW,m.lN,m.KE,m.qo,v.c,v.Nt,C.LD,Z.AV,Z.gM,z.QW],encapsulation:2,changeDetection:0})}return n})()},{path:"vencidos",component:tt}];let St=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.oAB({type:n});static#o=this.\u0275inj=e.cJS({imports:[F.Bz.forChild(At),F.Bz]})}return n})()}}]);