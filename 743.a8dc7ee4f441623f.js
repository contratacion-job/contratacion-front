(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[743],{2743:(R,D,s)=>{"use strict";s.r(D),s.d(D,{OrganizacionRoutingModule:()=>Ut});var k=s(1896),u=s(6814),A=s(5195),x=s(6007),e=s(9212);let S=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[u.ez]})}return o})();var v=s(2096);let I=(()=>{class o{constructor(){}getLicense(){const t={id:1,entidad_id:1,numero_licencia:"ABC-123-XYZ",tipo_licencia:"Software",fecha_emision:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-10),fecha_vencimiento:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+20),estado:"Activo",entidad:{}};return(0,v.of)(t)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var U=s(125);function T(o,a){if(1&o&&(e.TgZ(0,"div",21),e._UZ(1,"img",22),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("src",t.licenseData.entidad.logo,e.LSH)("alt",t.licenseData.entidad.nombre_entidad+" Logo")}}function X(o,a){if(1&o&&(e.TgZ(0,"div",41)(1,"span",42),e._uU(2,"Ubicaci\xf3n:"),e.qZA(),e.TgZ(3,"span",43),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.AsE("",t.licenseData.entidad.municipio.nombre,", ",t.licenseData.entidad.provincia.nombre,"")}}function ee(o,a){if(1&o&&(e.TgZ(0,"div",47)(1,"h4",48),e._uU(2,"Observaciones"),e.qZA(),e.TgZ(3,"p",49),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.Oqu(t.licenseData.observaciones)}}function te(o,a){if(1&o&&(e.TgZ(0,"div",23)(1,"div",24)(2,"div",25)(3,"div",26),e._UZ(4,"i",27),e.TgZ(5,"span",28),e._uU(6,"Activaci\xf3n"),e.qZA()(),e.TgZ(7,"p",29),e._uU(8),e.qZA()(),e.TgZ(9,"div",25)(10,"div",26),e._UZ(11,"i",30),e.TgZ(12,"span",28),e._uU(13,"Expiraci\xf3n"),e.qZA()(),e.TgZ(14,"p",29),e._uU(15),e.qZA()(),e.TgZ(16,"div",25)(17,"div",26),e._UZ(18,"i",31),e.TgZ(19,"span",28),e._uU(20,"Estado"),e.qZA()(),e.TgZ(21,"div",32),e._UZ(22,"i"),e._uU(23),e.qZA()()(),e.TgZ(24,"div",33)(25,"div",34)(26,"div",35),e._uU(27),e.qZA(),e.TgZ(28,"div",36),e._uU(29,"d\xedas restantes"),e.qZA()()(),e.TgZ(30,"div",37)(31,"div",38)(32,"h3",39),e._uU(33,"Detalles de la Licencia"),e.qZA(),e.TgZ(34,"div",40)(35,"div",41)(36,"span",42),e._uU(37,"Tipo:"),e.qZA(),e.TgZ(38,"span",43),e._uU(39),e.qZA()(),e.TgZ(40,"div",41)(41,"span",42),e._uU(42,"ID:"),e.qZA(),e.TgZ(43,"span",44),e._uU(44),e.qZA()(),e.TgZ(45,"div",41)(46,"span",42),e._uU(47,"Entidad ID:"),e.qZA(),e.TgZ(48,"span",44),e._uU(49),e.qZA()()()(),e.TgZ(50,"div",38)(51,"h3",39),e._uU(52,"Informaci\xf3n de la Entidad"),e.qZA(),e.TgZ(53,"div",40)(54,"div",41)(55,"span",42),e._uU(56,"Nombre:"),e.qZA(),e.TgZ(57,"span",43),e._uU(58),e.qZA()(),e.TgZ(59,"div",41)(60,"span",42),e._uU(61,"C\xf3digo:"),e.qZA(),e.TgZ(62,"span",44),e._uU(63),e.qZA()(),e.TgZ(64,"div",41)(65,"span",42),e._uU(66,"Tipo Empresa:"),e.qZA(),e.TgZ(67,"span",43),e._uU(68),e.qZA()(),e.TgZ(69,"div",41)(70,"span",42),e._uU(71,"Domicilio Legal:"),e.qZA(),e.TgZ(72,"span",43),e._uU(73),e.qZA()(),e.TgZ(74,"div",41)(75,"span",42),e._uU(76,"Tel\xe9fonos:"),e.qZA(),e.TgZ(77,"span",43),e._uU(78),e.qZA()(),e.YNc(79,X,5,2,"div",45),e.qZA()()(),e.YNc(80,ee,5,1,"div",46),e.qZA()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.formatDate(t.licenseData.fecha_emision)),e.xp6(7),e.Oqu(t.formatDate(t.licenseData.fecha_vencimiento)),e.xp6(6),e.Q6J("ngClass",t.getStatusColor()),e.xp6(1),e.Tol("icon-"+t.getStatusIcon()),e.xp6(1),e.hij(" ",t.licenseData.estado," "),e.xp6(4),e.Oqu(t.daysRemaining),e.xp6(12),e.Oqu(t.licenseData.tipo_licencia),e.xp6(5),e.Oqu(t.licenseData.id),e.xp6(5),e.Oqu(t.licenseData.entidad_id),e.xp6(9),e.Oqu(t.licenseData.entidad.nombre_entidad),e.xp6(5),e.Oqu(t.licenseData.entidad.codigo_entidad),e.xp6(5),e.Oqu(t.licenseData.entidad.tipo_empresa),e.xp6(5),e.Oqu(t.licenseData.entidad.domicilio_legal),e.xp6(5),e.Oqu(t.licenseData.entidad.telefonos),e.xp6(1),e.Q6J("ngIf",t.licenseData.entidad.municipio&&t.licenseData.entidad.provincia),e.xp6(1),e.Q6J("ngIf",t.licenseData.observaciones)}}function ne(o,a){if(1&o&&(e.TgZ(0,"tr",57)(1,"td",58),e._uU(2),e.qZA(),e.TgZ(3,"td",59),e._uU(4),e.qZA()()),2&o){const t=a.$implicit;e.xp6(2),e.Oqu(t.serie),e.xp6(2),e.Oqu(t.fecha)}}function oe(o,a){if(1&o&&(e.TgZ(0,"div",60),e._UZ(1,"i",61),e.TgZ(2,"div",62)(3,"p",63),e._uU(4),e.qZA(),e.TgZ(5,"p",64),e._uU(6),e.qZA()()()),2&o){const t=a.$implicit;e.xp6(4),e.Oqu(t.usuario),e.xp6(2),e.hij("Activado: ",t.fecha,"")}}function ie(o,a){if(1&o&&(e.TgZ(0,"div",23)(1,"div",50)(2,"div",51)(3,"h3",39),e._uU(4,"Historial de Activaciones"),e.qZA(),e.TgZ(5,"div",52)(6,"table",53)(7,"thead")(8,"tr")(9,"th"),e._uU(10,"No. de serie"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Fecha"),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,ne,5,2,"tr",54),e.qZA()()()(),e.TgZ(15,"div",51)(16,"h3",39),e._uU(17,"Usuarios Vinculados"),e.qZA(),e.TgZ(18,"div",55),e.YNc(19,oe,7,2,"div",56),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",t.historialActivaciones),e.xp6(5),e.Q6J("ngForOf",t.historialActivaciones)}}function ae(o,a){if(1&o&&(e.TgZ(0,"div",23)(1,"div",65)(2,"h3",39),e._uU(3),e.qZA(),e.TgZ(4,"div",66)(5,"div",67)(6,"h4",68),e._uU(7,"Caracter\xedsticas Incluidas"),e.qZA(),e.TgZ(8,"ul",69)(9,"li",70),e._UZ(10,"i",71),e._uU(11," Acceso completo al sistema ERP "),e.qZA(),e.TgZ(12,"li",70),e._UZ(13,"i",71),e._uU(14," Usuarios ilimitados "),e.qZA(),e.TgZ(15,"li",70),e._UZ(16,"i",71),e._uU(17," Soporte t\xe9cnico 24/7 "),e.qZA(),e.TgZ(18,"li",70),e._UZ(19,"i",71),e._uU(20," Actualizaciones autom\xe1ticas "),e.qZA(),e.TgZ(21,"li",70),e._UZ(22,"i",71),e._uU(23," Respaldo en la nube "),e.qZA()()(),e.TgZ(24,"div",72)(25,"h4",73),e._uU(26,"Informaci\xf3n T\xe9cnica"),e.qZA(),e.TgZ(27,"div",74)(28,"div",75)(29,"p",76),e._uU(30,"Versi\xf3n:"),e.qZA(),e.TgZ(31,"p",77),e._uU(32,"v2.4.1"),e.qZA()(),e.TgZ(33,"div",75)(34,"p",76),e._uU(35,"\xdaltima actualizaci\xf3n:"),e.qZA(),e.TgZ(36,"p",77),e._uU(37,"15 de mayo, 2025"),e.qZA()(),e.TgZ(38,"div",75)(39,"p",76),e._uU(40,"Compatibilidad:"),e.qZA(),e.TgZ(41,"p",77),e._uU(42,"Windows, macOS, Linux"),e.qZA()(),e.TgZ(43,"div",75)(44,"p",76),e._uU(45,"Base de datos:"),e.qZA(),e.TgZ(46,"p",77),e._uU(47,"PostgreSQL 14+"),e.qZA()()()()()()()),2&o){const t=e.oxw();e.xp6(3),e.hij("Detalles del Plan ",t.licenseData.tipo_licencia,"")}}let re=(()=>{class o{constructor(t,n){this.licenseService=t,this.entidadService=n,this.activeTab="estado",this.licenseData=null,this.daysRemaining=0,this.isLoading=!0,this.error="",this.historialActivaciones=[{serie:"SN987654320",fecha:"1 de ene. 2024",usuario:"juan.perez@empresa.com"},{serie:"SN876543210",fecha:"15 de dic. 2023",usuario:"admin@empresa.com"}]}ngOnInit(){this.loadLicenseData()}loadLicenseData(){this.isLoading=!0,this.error="",this.entidadService.getLogs().subscribe({next:t=>{console.log("Respuesta de entidades:",t);try{let n=[];if(t&&t.data&&Array.isArray(t.data)?n=t.data:Array.isArray(t)&&(n=t),n.length>0){const i=n[0];this.licenseData={id:1,entidad_id:i.id,numero_licencia:"ABC123-XYZ456",tipo_licencia:"Empresarial Pro",fecha_emision:new Date("2025-06-01"),fecha_vencimiento:new Date("2025-07-01"),estado:"Activa",observaciones:"Licencia renovada autom\xe1ticamente",entidad:{id:i.id,municipio_id:1,nombre_entidad:i.nombre,codigo_entidad:i.codigo,domicilio_legal:i.domicilio_legal,telefonos:i.telefonos,logo:i.logo,tipo_empresa:i.tipo_empresa,ministerio:i.ministerio,activo:i.activo,director_id:i.director_id,provincia:{id:1,nombre_provincia:i.provincia},municipio:{id:1,provincia_id:1,nombre_municipio:i.municipio,provincia:{id:1,nombre_provincia:i.provincia}}}},this.calculateDaysRemaining()}else this.error="No se encontraron entidades"}catch(n){console.error("Error procesando datos de entidad:",n),this.error="Error procesando los datos de la entidad"}this.isLoading=!1},error:t=>{console.error("Error al cargar datos de entidad:",t),this.error="Error al cargar los datos de la entidad",this.isLoading=!1}})}setActiveTab(t){this.activeTab=t}calculateDaysRemaining(){if(!this.licenseData)return;const t=new Date,i=new Date(this.licenseData.fecha_vencimiento).getTime()-t.getTime();this.daysRemaining=Math.ceil(i/864e5)}getStatusColor(){return this.daysRemaining>15?"status-active":this.daysRemaining>7?"status-warning":"status-danger"}getStatusIcon(){return this.daysRemaining>7?"check-circle":"alert-circle"}formatDate(t){return t.toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}onRenovar(){console.log("Renovar licencia")}onDescargarLicencia(){console.log("Descargar licencia")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(I),e.Y36(U.q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-license"]],standalone:!0,features:[e.jDz],decls:37,vars:13,consts:[[1,"license-container"],[1,"license-card"],[1,"header-section"],[1,"header-content"],[1,"title-section"],["class","logo-section",4,"ngIf"],[1,"text-section"],[1,"main-title"],[1,"subtitle"],[1,"license-number"],[1,"license-code"],[1,"entity-code"],[1,"btn-renovar",3,"click"],[1,"tabs-container"],[1,"tabs-nav"],[1,"tab-button",3,"click"],[1,"content-card"],["class","content-section",4,"ngIf"],[1,"download-section"],[1,"btn-download",3,"click"],[1,"icon-download"],[1,"logo-section"],[1,"entity-logo",3,"src","alt"],[1,"content-section"],[1,"status-grid"],[1,"status-card"],[1,"status-header"],[1,"icon-calendar"],[1,"status-label"],[1,"status-value"],[1,"icon-clock"],[1,"icon-shield"],[1,"status-badge",3,"ngClass"],[1,"days-remaining-card"],[1,"days-content"],[1,"days-number"],[1,"days-label"],[1,"details-grid"],[1,"details-section"],[1,"section-title"],[1,"details-list"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[1,"detail-value","detail-code"],["class","detail-item",4,"ngIf"],["class","observaciones-card",4,"ngIf"],[1,"observaciones-card"],[1,"observaciones-title"],[1,"observaciones-text"],[1,"historial-grid"],[1,"historial-section"],[1,"table-container"],[1,"data-table"],["class","table-row",4,"ngFor","ngForOf"],[1,"usuarios-list"],["class","usuario-card",4,"ngFor","ngForOf"],[1,"table-row"],[1,"table-cell","table-code"],[1,"table-cell"],[1,"usuario-card"],[1,"icon-user"],[1,"usuario-info"],[1,"usuario-email"],[1,"usuario-fecha"],[1,"detalles-container"],[1,"plan-sections"],[1,"caracteristicas-card"],[1,"caracteristicas-title"],[1,"caracteristicas-list"],[1,"caracteristica-item"],[1,"icon-check-circle"],[1,"tecnica-card"],[1,"tecnica-title"],[1,"tecnica-grid"],[1,"tecnica-item"],[1,"tecnica-label"],[1,"tecnica-value"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,T,2,2,"div",5),e.TgZ(6,"div",6)(7,"h1",7),e._uU(8,"Licencia de Software"),e.qZA(),e.TgZ(9,"h2",8),e._uU(10),e.qZA(),e.TgZ(11,"p",9),e._uU(12," Licencia: "),e.TgZ(13,"span",10),e._uU(14),e.qZA()(),e.TgZ(15,"p",11),e._uU(16," C\xf3digo Entidad: "),e.TgZ(17,"span",10),e._uU(18),e.qZA()()()(),e.TgZ(19,"button",12),e.NdJ("click",function(){return i.onRenovar()}),e._uU(20," RENOVAR "),e.qZA()()(),e.TgZ(21,"div",13)(22,"div",14)(23,"button",15),e.NdJ("click",function(){return i.setActiveTab("estado")}),e._uU(24," Estado "),e.qZA(),e.TgZ(25,"button",15),e.NdJ("click",function(){return i.setActiveTab("historial")}),e._uU(26," Historial de Activaciones "),e.qZA(),e.TgZ(27,"button",15),e.NdJ("click",function(){return i.setActiveTab("detalles")}),e._uU(28," Detalles del Plan "),e.qZA()()()(),e.TgZ(29,"div",16),e.YNc(30,te,81,17,"div",17)(31,ie,20,2,"div",17)(32,ae,48,1,"div",17),e.TgZ(33,"div",18)(34,"button",19),e.NdJ("click",function(){return i.onDescargarLicencia()}),e._UZ(35,"i",20),e._uU(36," Descargar Licencia "),e.qZA()()()()),2&n&&(e.xp6(5),e.Q6J("ngIf",i.licenseData.entidad.logo),e.xp6(5),e.Oqu(i.licenseData.entidad.nombre_entidad),e.xp6(4),e.Oqu(i.licenseData.numero_licencia),e.xp6(4),e.Oqu(i.licenseData.entidad.codigo_entidad),e.xp6(5),e.ekj("active","estado"===i.activeTab),e.xp6(2),e.ekj("active","historial"===i.activeTab),e.xp6(2),e.ekj("active","detalles"===i.activeTab),e.xp6(3),e.Q6J("ngIf","estado"===i.activeTab),e.xp6(1),e.Q6J("ngIf","historial"===i.activeTab),e.xp6(1),e.Q6J("ngIf","detalles"===i.activeTab))},dependencies:[u.ez,u.mk,u.sg,u.O5,A.QW,x.Cv,S],styles:['@charset "UTF-8";.license-container{max-width:1024px;margin:0 auto;padding:24px;background-color:#f9fafb;min-height:100vh}.license-card,.content-card{background:white;border-radius:8px;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb}.license-card{margin-bottom:24px}.header-section{padding:32px;border-bottom:1px solid #f3f4f6}.header-content{display:flex;justify-content:space-between;align-items:flex-start}.title-section{display:flex;align-items:flex-start;gap:20px}.logo-section{flex-shrink:0}.entity-logo{width:80px;height:80px;object-fit:contain;border-radius:8px;border:1px solid #e5e7eb;background-color:#fff}.text-section{flex:1}.text-section h1.main-title{font-size:32px;font-weight:700;color:#111827;margin:0 0 8px}.text-section h2.subtitle{font-size:20px;color:#374151;margin:0 0 8px}.license-number,.entity-code{color:#6b7280;margin:0 0 4px}.license-code{font-family:Courier New,monospace;font-weight:500}.btn-renovar{background-color:#2563eb;color:#fff;padding:12px 24px;border:none;border-radius:8px;font-weight:500;cursor:pointer;transition:background-color .2s;margin-top:68px}.btn-renovar:hover{background-color:#1d4ed8}.tabs-container{padding:0 32px}.tabs-nav{display:flex;gap:32px;border-bottom:1px solid #e5e7eb}.tab-button{padding:16px 8px;border:none;background:none;border-bottom:2px solid transparent;font-weight:500;font-size:14px;color:#6b7280;cursor:pointer;transition:all .2s}.tab-button:hover{color:#374151}.tab-button.active{border-bottom-color:#2563eb;color:#2563eb}.content-section{padding:32px}.status-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:24px;margin-bottom:32px}.status-card{background-color:#f9fafb;border-radius:8px;padding:24px}.status-header{display:flex;align-items:center;gap:12px;margin-bottom:8px}.status-label{font-size:14px;color:#6b7280;font-weight:500}.status-value{font-size:18px;font-weight:600;color:#111827;margin:0}.status-badge{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:20px;font-size:14px;font-weight:500;width:-moz-fit-content;width:fit-content}.status-active{color:#065f46;background-color:#ecfdf5}.status-warning{color:#92400e;background-color:#fffbeb}.status-danger{color:#991b1b;background-color:#fef2f2}.days-remaining-card{background:linear-gradient(135deg,#dbeafe 0%,#e0e7ff 100%);border-radius:8px;padding:24px;margin-bottom:32px;border:1px solid #bfdbfe}.days-content{text-align:center}.days-number{font-size:48px;font-weight:700;color:#2563eb;margin-bottom:8px}.days-label{color:#1e40af;font-weight:500}.details-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:32px}.section-title{font-size:18px;font-weight:600;color:#111827;margin:0 0 16px}.details-list{display:flex;flex-direction:column;gap:12px}.detail-item{display:flex;justify-content:space-between}.detail-label{color:#6b7280}.detail-value{font-weight:500;color:#111827}.detail-code{font-family:Courier New,monospace}.observaciones-card{margin-top:32px;padding:16px;background-color:#dbeafe;border-radius:8px;border:1px solid #bfdbfe}.observaciones-title{font-weight:500;color:#1e40af;margin:0 0 8px}.observaciones-text{color:#1e3a8a;margin:0}.historial-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:32px}.table-container{overflow:hidden;border-radius:8px;border:1px solid #e5e7eb}.data-table{width:100%;border-collapse:collapse}.data-table thead{background-color:#f9fafb}.data-table th{padding:12px 16px;text-align:left;font-size:12px;font-weight:500;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.table-row:hover{background-color:#f9fafb}.table-cell{padding:12px 16px;font-size:14px;color:#111827;border-top:1px solid #e5e7eb}.table-code{font-family:Courier New,monospace}.usuarios-list{display:flex;flex-direction:column;gap:16px}.usuario-card{display:flex;align-items:center;gap:12px;padding:16px;background-color:#f9fafb;border-radius:8px}.usuario-info p{margin:0}.usuario-email{font-weight:500;color:#111827}.usuario-fecha{font-size:14px;color:#6b7280}.detalles-container{max-width:512px}.plan-sections{display:flex;flex-direction:column;gap:24px}.caracteristicas-card{background:linear-gradient(135deg,#ecfdf5 0%,#d1fae5 100%);border-radius:8px;padding:24px;border:1px solid #bbf7d0}.caracteristicas-title{font-weight:600;color:#065f46;margin:0 0 12px}.caracteristicas-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}.caracteristica-item{display:flex;align-items:center;gap:8px;color:#047857}.tecnica-card{background-color:#dbeafe;border-radius:8px;padding:24px;border:1px solid #bfdbfe}.tecnica-title{font-weight:600;color:#1e40af;margin:0 0 12px}.tecnica-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.tecnica-item{color:#1e3a8a}.tecnica-label{font-weight:500;margin:0 0 4px}.tecnica-value{margin:0}.download-section{padding:16px 32px;border-top:1px solid #f3f4f6;background-color:#f9fafb}.btn-download{display:flex;align-items:center;gap:8px;color:#2563eb;background:none;border:none;font-weight:500;cursor:pointer;transition:color .2s}.btn-download:hover{color:#1d4ed8}.icon-calendar:before{content:"\\1f4c5"}.icon-clock:before{content:"\\23f0"}.icon-shield:before{content:"\\1f6e1"}.icon-check-circle:before{content:"\\2705"}.icon-alert-circle:before{content:"\\26a0\\fe0f"}.icon-user:before{content:"\\1f464"}.icon-download:before{content:"\\2b07\\fe0f"}@media (max-width: 768px){.license-container{padding:16px}.header-content{flex-direction:column;gap:16px}.title-section{flex-direction:column;text-align:center}.entity-logo{width:60px;height:60px}.header-section,.content-section{padding:24px 16px}.tabs-container{padding:0 16px}.tabs-nav{gap:16px;overflow-x:auto}.status-grid,.details-grid,.historial-grid{grid-template-columns:1fr}.days-number{font-size:36px}}\n'],encapsulation:2})}return o})();function ce(o,a){1&o&&(e.TgZ(0,"div",11),e._UZ(1,"div",12),e.qZA())}function se(o,a){if(1&o&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.importStatus)}}function le(o,a){1&o&&(e.TgZ(0,"div",14),e._UZ(1,"div",15),e.qZA())}function de(o,a){if(1&o&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.exportStatus)}}function pe(o,a){1&o&&(e.TgZ(0,"div",16),e._UZ(1,"div",17),e.qZA())}function ge(o,a){if(1&o&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.restoreStatus)}}let ue=(()=>{class o{constructor(){this.selectedFile=null,this.importInProgress=!1,this.importStatus=null,this.exportInProgress=!1,this.exportStatus=null,this.restoreInProgress=!1,this.restoreStatus=null}onFileSelected(t){const n=t.target;n.files&&n.files.length>0&&(this.selectedFile=n.files[0],this.importStatus=null)}importDatabase(){this.selectedFile?(this.importInProgress=!0,this.importStatus=null,setTimeout(()=>{this.importInProgress=!1,this.importStatus="Importaci\xf3n completada con \xe9xito.",this.selectedFile=null},3e3)):this.importStatus="Por favor, seleccione un archivo para importar."}exportDatabase(){this.exportInProgress=!0,this.exportStatus=null,setTimeout(()=>{this.exportInProgress=!1,this.exportStatus="Exportaci\xf3n completada con \xe9xito."},3e3)}restoreDatabase(){this.restoreInProgress=!0,this.restoreStatus=null,setTimeout(()=>{this.restoreInProgress=!1,this.restoreStatus="Restauraci\xf3n completada con \xe9xito."},3e3)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-bd"]],standalone:!0,features:[e.jDz],decls:23,vars:7,consts:[[1,"flex","flex-col","flex-auto","min-w-0","p-6","sm:p-10","space-y-8"],[1,"bg-white","dark:bg-gray-800","shadow","rounded-lg","p-6"],[1,"text-xl","font-semibold","mb-4"],["type","file","accept",".sql,.json,.zip",1,"mb-4","block","w-full","text-sm","text-gray-500","file:mr-4","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-blue-50","file:text-blue-700","hover:file:bg-blue-100","dark:file:bg-gray-700","dark:file:text-gray-300","dark:hover:file:bg-gray-600",3,"change"],[1,"px-6","py-2","bg-blue-600","text-white","rounded","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled","click"],["class","mt-2 h-2 bg-blue-200 rounded overflow-hidden",4,"ngIf"],["class","mt-2 text-sm text-gray-700 dark:text-gray-300",4,"ngIf"],[1,"px-6","py-2","bg-green-600","text-white","rounded","hover:bg-green-700",3,"click"],["class","mt-2 h-2 bg-green-200 rounded overflow-hidden",4,"ngIf"],[1,"px-6","py-2","bg-red-600","text-white","rounded","hover:bg-red-700",3,"click"],["class","mt-2 h-2 bg-red-200 rounded overflow-hidden",4,"ngIf"],[1,"mt-2","h-2","bg-blue-200","rounded","overflow-hidden"],[1,"h-2","bg-blue-600","animate-pulse","w-full"],[1,"mt-2","text-sm","text-gray-700","dark:text-gray-300"],[1,"mt-2","h-2","bg-green-200","rounded","overflow-hidden"],[1,"h-2","bg-green-600","animate-pulse","w-full"],[1,"mt-2","h-2","bg-red-200","rounded","overflow-hidden"],[1,"h-2","bg-red-600","animate-pulse","w-full"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Importar Base de Datos"),e.qZA(),e.TgZ(4,"input",3),e.NdJ("change",function(l){return i.onFileSelected(l)}),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.importDatabase()}),e._uU(6," Importar "),e.qZA(),e.YNc(7,ce,2,0,"div",5)(8,se,2,1,"p",6),e.qZA(),e.TgZ(9,"div",1)(10,"h2",2),e._uU(11,"Exportar Base de Datos"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return i.exportDatabase()}),e._uU(13," Exportar "),e.qZA(),e.YNc(14,le,2,0,"div",8)(15,de,2,1,"p",6),e.qZA(),e.TgZ(16,"div",1)(17,"h2",2),e._uU(18,"Restaurar Base de Datos"),e.qZA(),e.TgZ(19,"button",9),e.NdJ("click",function(){return i.restoreDatabase()}),e._uU(20," Restaurar "),e.qZA(),e.YNc(21,pe,2,0,"div",10)(22,ge,2,1,"p",6),e.qZA()()),2&n&&(e.xp6(5),e.Q6J("disabled",!i.selectedFile),e.xp6(2),e.Q6J("ngIf",i.importInProgress),e.xp6(1),e.Q6J("ngIf",i.importStatus),e.xp6(6),e.Q6J("ngIf",i.exportInProgress),e.xp6(1),e.Q6J("ngIf",i.exportStatus),e.xp6(6),e.Q6J("ngIf",i.restoreInProgress),e.xp6(1),e.Q6J("ngIf",i.restoreStatus))},dependencies:[u.ez,u.O5,A.QW,x.Cv]})}return o})();var c=s(6223),C=s(2296),Z=s(4170),F=s(617),O=s(4516),E=s(1476),q=s(3566),_=s(5313),z=s(2596),J=s(8525),me=s(5619),_e=s(8645),fe=s(7174),B=s(3680);function he(o,a){if(1&o&&(e.TgZ(0,"div",41),e._UZ(1,"img",42),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("src",t.dataSource.data[0].logo,e.LSH)("alt",t.dataSource.data[0].nombre_entidad)}}function be(o,a){if(1&o&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.getInitials(t.dataSource.data[0].nombre_entidad)," ")}}function xe(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",44)(1,"button",45),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.openAddEntidadDialog())}),e.TgZ(2,"mat-icon"),e._uU(3,"add"),e.qZA()()()}}function ve(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6)(4,"h1",7),e._uU(5,"Mi Entidad"),e.qZA(),e.TgZ(6,"div",8)(7,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleEditMode(!0))}),e.TgZ(8,"mat-icon",10),e._uU(9,"edit"),e.qZA(),e._uU(10," Editar "),e.qZA(),e.TgZ(11,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.goBack())}),e.TgZ(12,"mat-icon"),e._uU(13,"close"),e.qZA()()()(),e.TgZ(14,"div",12)(15,"div",13)(16,"div",14)(17,"div",15)(18,"div",16),e.YNc(19,he,2,2,"div",17)(20,be,2,1,"ng-template",null,18,e.W1O),e.qZA()()(),e.TgZ(22,"h2",19),e._uU(23),e.qZA(),e.TgZ(24,"div",20)(25,"div",21)(26,"mat-icon",22),e._uU(27,"business"),e.qZA(),e._uU(28),e.qZA(),e.TgZ(29,"div",23)(30,"mat-icon",22),e._uU(31,"location_city"),e.qZA(),e._uU(32),e.qZA(),e.TgZ(33,"div",24)(34,"mat-icon",22),e._uU(35),e.qZA(),e._uU(36),e.qZA()()(),e.TgZ(37,"div",25)(38,"div",26)(39,"div",27)(40,"mat-icon",28),e._uU(41,"account_balance"),e.qZA()(),e.TgZ(42,"div")(43,"p",29),e._uU(44,"Ministerio"),e.qZA(),e.TgZ(45,"p",30),e._uU(46),e.qZA()()(),e.TgZ(47,"div",26)(48,"div",31)(49,"mat-icon",32),e._uU(50,"phone"),e.qZA()(),e.TgZ(51,"div")(52,"p",29),e._uU(53,"Tel\xe9fono"),e.qZA(),e.TgZ(54,"p",30),e._uU(55),e.qZA()()(),e.TgZ(56,"div",26)(57,"div",33)(58,"mat-icon",34),e._uU(59,"location_on"),e.qZA()(),e.TgZ(60,"div")(61,"p",29),e._uU(62,"Ubicaci\xf3n"),e.qZA(),e.TgZ(63,"p",30),e._uU(64),e.qZA()()(),e.TgZ(65,"div",35)(66,"div",36)(67,"mat-icon",37),e._uU(68,"home"),e.qZA()(),e.TgZ(69,"div")(70,"p",29),e._uU(71,"Domicilio Legal"),e.qZA(),e.TgZ(72,"p",30),e._uU(73),e.qZA()()(),e.TgZ(74,"div",26)(75,"div",38)(76,"mat-icon",39),e._uU(77,"calendar_today"),e.qZA()(),e.TgZ(78,"div")(79,"p",29),e._uU(80,"Fecha de Registro"),e.qZA(),e.TgZ(81,"p",30),e._uU(82),e.qZA()()()()(),e.YNc(83,xe,4,0,"div",40),e.qZA()(),e.BQk()}if(2&o){const t=e.MAs(21),n=e.oxw(2);e.xp6(19),e.Q6J("ngIf",n.dataSource.data[0].logo)("ngIfElse",t),e.xp6(4),e.hij(" ",n.dataSource.data[0].nombre_entidad," "),e.xp6(5),e.hij(" ",n.dataSource.data[0].codigo_entidad," "),e.xp6(4),e.hij(" ",n.dataSource.data[0].tipo_empresa," "),e.xp6(1),e.ekj("bg-green-50",n.dataSource.data[0].activo)("text-green-700",n.dataSource.data[0].activo)("bg-red-50",!n.dataSource.data[0].activo)("text-red-700",!n.dataSource.data[0].activo),e.xp6(2),e.hij(" ",n.dataSource.data[0].activo?"check_circle":"cancel"," "),e.xp6(1),e.hij(" ",n.dataSource.data[0].activo?"Activa":"Inactiva"," "),e.xp6(10),e.Oqu(n.dataSource.data[0].ministerio),e.xp6(9),e.Oqu(n.dataSource.data[0].telefonos),e.xp6(9),e.AsE("",null==n.dataSource.data[0].municipio?null:n.dataSource.data[0].municipio.nombre_municipio,", ",null==n.dataSource.data[0].provincia?null:n.dataSource.data[0].provincia.nombre_provincia,""),e.xp6(9),e.Oqu(n.dataSource.data[0].domicilio_legal),e.xp6(9),e.Oqu(n.formatDate(n.dataSource.data[0].createdAt)),e.xp6(1),e.Q6J("ngIf",n.canAddEntidad())}}function Ze(o,a){if(1&o&&(e.TgZ(0,"div",41),e._UZ(1,"img",42),e.qZA()),2&o){const t=e.oxw(3);let n,i;e.xp6(1),e.Q6J("src",null==(n=t.contactForm.get("logo"))?null:n.value,e.LSH)("alt",null==(i=t.contactForm.get("nombre"))?null:i.value)}}function Te(o,a){if(1&o&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);let n;e.xp6(1),e.hij(" ",t.getInitials((null==(n=t.contactForm.get("nombre"))?null:n.value)||"E")," ")}}function Ce(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es requerido "),e.qZA())}function Ae(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El c\xf3digo es requerido "),e.qZA())}function ye(o,a){if(1&o&&(e.TgZ(0,"mat-option",69),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function we(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El tipo de empresa es requerido "),e.qZA())}function Ue(o,a){if(1&o&&(e.TgZ(0,"mat-option",69),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function qe(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El ministerio es requerido "),e.qZA())}function ke(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El tel\xe9fono es requerido "),e.qZA())}function Ee(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La provincia es requerida "),e.qZA())}function Pe(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El municipio es requerido "),e.qZA())}function De(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El domicilio legal es requerido "),e.qZA())}function Me(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6)(4,"h1",7),e._uU(5,"Editar Entidad"),e.qZA(),e.TgZ(6,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleEditMode(!1))}),e.TgZ(7,"mat-icon"),e._uU(8,"close"),e.qZA()()(),e.TgZ(9,"div",12)(10,"form",46)(11,"div",47)(12,"div",15)(13,"div",16)(14,"div",48)(15,"input",49,50),e.NdJ("change",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.uploadLogo(i.target.files))}),e.qZA(),e.TgZ(17,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(16);return e.KtG(i.click())}),e.TgZ(18,"mat-icon"),e._uU(19,"camera_alt"),e.qZA()(),e.TgZ(20,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.removeLogo())}),e.TgZ(21,"mat-icon"),e._uU(22,"delete"),e.qZA()()(),e.YNc(23,Ze,2,2,"div",17)(24,Te,2,1,"ng-template",null,52,e.W1O),e.qZA()()(),e.TgZ(26,"div",53)(27,"mat-form-field",54)(28,"mat-label"),e._uU(29,"Nombre de la Entidad"),e.qZA(),e._UZ(30,"input",55),e.YNc(31,Ce,2,0,"mat-error",3),e.qZA(),e.TgZ(32,"mat-form-field",54)(33,"mat-label"),e._uU(34,"C\xf3digo de la Entidad"),e.qZA(),e._UZ(35,"input",56),e.YNc(36,Ae,2,0,"mat-error",3),e.qZA(),e.TgZ(37,"mat-form-field",54)(38,"mat-label"),e._uU(39,"Tipo de Empresa"),e.qZA(),e.TgZ(40,"mat-select",57),e.YNc(41,ye,2,2,"mat-option",58),e.qZA(),e.YNc(42,we,2,0,"mat-error",3),e.qZA(),e.TgZ(43,"mat-form-field",54)(44,"mat-label"),e._uU(45,"Ministerio"),e.qZA(),e.TgZ(46,"mat-select",57),e.YNc(47,Ue,2,2,"mat-option",58),e.qZA(),e.YNc(48,qe,2,0,"mat-error",3),e.qZA(),e.TgZ(49,"mat-form-field",54)(50,"mat-label"),e._uU(51,"Tel\xe9fonos"),e.qZA(),e._UZ(52,"input",59),e.YNc(53,ke,2,0,"mat-error",3),e.qZA(),e.TgZ(54,"mat-form-field",54)(55,"mat-label"),e._uU(56,"Provincia"),e.qZA(),e._UZ(57,"input",60),e.YNc(58,Ee,2,0,"mat-error",3),e.qZA(),e.TgZ(59,"mat-form-field",54)(60,"mat-label"),e._uU(61,"Municipio"),e.qZA(),e._UZ(62,"input",61),e.YNc(63,Pe,2,0,"mat-error",3),e.qZA(),e.TgZ(64,"mat-form-field",54)(65,"mat-label"),e._uU(66,"Domicilio Legal"),e.qZA(),e._UZ(67,"textarea",62),e.YNc(68,De,2,0,"mat-error",3),e.qZA(),e.TgZ(69,"div",26)(70,"mat-slide-toggle",63),e._uU(71," Entidad Activa "),e.qZA()()(),e.TgZ(72,"div",64)(73,"button",65),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.deleteEntidad(i.dataSource.data[0]))}),e.TgZ(74,"mat-icon",10),e._uU(75,"delete"),e.qZA(),e._uU(76," Eliminar "),e.qZA(),e.TgZ(77,"div",66)(78,"button",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleEditMode(!1))}),e._uU(79," Cancelar "),e.qZA(),e.TgZ(80,"button",68),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.saveEntidad())}),e.TgZ(81,"mat-icon",10),e._uU(82,"save"),e.qZA(),e._uU(83," Guardar "),e.qZA()()()()()()(),e.BQk()}if(2&o){const t=e.MAs(25),n=e.oxw(2);let i,r,l,b,G,K,V,$,W;e.xp6(10),e.Q6J("formGroup",n.contactForm),e.xp6(13),e.Q6J("ngIf",null==(i=n.contactForm.get("logo"))?null:i.value)("ngIfElse",t),e.xp6(7),e.Q6J("formControlName","nombre"),e.xp6(1),e.Q6J("ngIf",null==(r=n.contactForm.get("nombre"))?null:r.hasError("required")),e.xp6(4),e.Q6J("formControlName","codigo"),e.xp6(1),e.Q6J("ngIf",null==(l=n.contactForm.get("codigo"))?null:l.hasError("required")),e.xp6(4),e.Q6J("formControlName","tipo_empresa"),e.xp6(1),e.Q6J("ngForOf",n.tiposEmpresa),e.xp6(1),e.Q6J("ngIf",null==(b=n.contactForm.get("tipo_empresa"))?null:b.hasError("required")),e.xp6(4),e.Q6J("formControlName","ministerio"),e.xp6(1),e.Q6J("ngForOf",n.ministerios),e.xp6(1),e.Q6J("ngIf",null==(G=n.contactForm.get("ministerio"))?null:G.hasError("required")),e.xp6(4),e.Q6J("formControlName","telefonos"),e.xp6(1),e.Q6J("ngIf",null==(K=n.contactForm.get("telefonos"))?null:K.hasError("required")),e.xp6(4),e.Q6J("formControlName","provincia"),e.xp6(1),e.Q6J("ngIf",null==(V=n.contactForm.get("provincia"))?null:V.hasError("required")),e.xp6(4),e.Q6J("formControlName","municipio"),e.xp6(1),e.Q6J("ngIf",null==($=n.contactForm.get("municipio"))?null:$.hasError("required")),e.xp6(4),e.Q6J("formControlName","domicilio_legal"),e.xp6(1),e.Q6J("ngIf",null==(W=n.contactForm.get("domicilio_legal"))?null:W.hasError("required")),e.xp6(2),e.Q6J("formControlName","activo"),e.xp6(10),e.Q6J("disabled",n.contactForm.invalid)}}function Se(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",2),e.YNc(2,ve,84,22,"ng-container",3)(3,Me,84,23,"ng-container",3),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.editMode),e.xp6(1),e.Q6J("ngIf",t.editMode)}}function Ie(o,a){}let Fe=(()=>{class o{constructor(t,n,i,r,l){this.entidadService=t,this.catalogService=n,this._cdr=i,this.fb=r,this._document=l,this.displayedColumns=["id","nombre","codigo","domicilio_legal","telefonos","tipo_empresa","municipio","actions"],this.dataSource=new _.by,this._entidadesSubject=new me.X([]),this.entidades$=this._entidadesSubject.asObservable(),this.isLoading=!1,this.error="",this.serverPagination={total:0,currentPage:1,totalPages:0,limit:50},this.pagination={length:0,page:0,size:10},this.editMode=!1,this.selectedEntidad=null,this.tiposEmpresa=["Empresa Estatal","Empresa Mixta","Empresa Privada","Cooperativa","Organizaci\xf3n"],this.ministerios=["MINCIN","MINAG","MINSAP","MINED","MININT","MINFAR"],this._unsubscribeAll=new _e.x,this.contactForm=this.fb.group({nombre:["",c.kI.required],codigo:["",c.kI.required],tipo_empresa:["",c.kI.required],ministerio:["",c.kI.required],telefonos:["",c.kI.required],provincia:["",c.kI.required],municipio:["",c.kI.required],domicilio_legal:["",c.kI.required],activo:[!0],logo:[null]})}ngOnInit(){this.initializeForm(),this.loadEntidades()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}initializeForm(){this.contactForm=this.fb.group({id:[null],nombre:["",c.kI.required],codigo:["",c.kI.required],domicilio_legal:["",c.kI.required],telefonos:["",c.kI.required],tipo_empresa:["",c.kI.required],ministerio:["",c.kI.required],municipio:["",c.kI.required],provincia:["",c.kI.required],activo:[!0],logo:[null],director_id:[null]})}loadEntidades(){this.isLoading=!0,this.error="",console.log("Iniciando carga de entidades..."),this.loadCatalogos(),this.entidadService.getLogs().subscribe({next:t=>{console.log("Respuesta completa del servicio:",t);try{let n=[];if(t&&t.data)Array.isArray(t.data)?(n=t.data,console.log("Datos encontrados en response.data (array):",n)):"object"==typeof t.data&&null!==t.data&&(n=[t.data],console.log("Datos encontrados en response.data (objeto \xfanico):",n)),t.pagination&&(this.serverPagination={total:t.pagination.total,currentPage:t.pagination.page,totalPages:t.pagination.pages,limit:t.pagination.limit});else if(Array.isArray(t))n=t,console.log("Datos encontrados directamente en response:",n);else{if("object"!=typeof t||null===t)return console.error("Estructura de datos no reconocida:",t),this.error="No se encontraron datos de entidades",this.isLoading=!1,void this._cdr.markForCheck();n=[t],console.log("Datos encontrados directamente en response (objeto \xfanico):",n)}if(console.log("Datos a transformar:",n),0===n.length)console.log("No hay entidades para mostrar"),this._entidadesSubject.next([]),this.dataSource.data=[],this.pagination.length=0;else{const i=this.transformApiData(n);console.log("Datos transformados:",i),this._entidadesSubject.next(i),this.dataSource.data=i,this.pagination.length=i.length,setTimeout(()=>{this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort)})}}catch(n){console.error("Error procesando datos:",n),this.error="Error procesando los datos del servidor"}this.isLoading=!1,this._cdr.markForCheck()},error:t=>{console.error("Error al cargar entidades:",t),this.error="Error al cargar las entidades del servidor",this.isLoading=!1,this._cdr.markForCheck()}})}loadCatalogos(){this.catalogService.getTiposEmpresa().subscribe({next:t=>{console.log("Tipos de empresa:",t),t&&Array.isArray(t)&&(this.tiposEmpresa=t.map(n=>n.nombre||n)),this._cdr.markForCheck()},error:t=>console.error("Error cargando tipos de empresa:",t)}),this.catalogService.getMinisterios().subscribe({next:t=>{console.log("Ministerios:",t),t&&Array.isArray(t)&&(this.ministerios=t.map(n=>n.nombre||n)),this._cdr.markForCheck()},error:t=>console.error("Error cargando ministerios:",t)}),this.catalogService.getProvincias().subscribe({next:t=>{console.log("Provincias:",t),this._cdr.markForCheck()},error:t=>console.error("Error cargando provincias:",t)}),this.catalogService.getMunicipios().subscribe({next:t=>{console.log("Municipios:",t),this._cdr.markForCheck()},error:t=>console.error("Error cargando municipios:",t)})}transformApiData(t){return console.log("Transformando datos API:",t),t.map(n=>{console.log("Transformando item:",n);const i={id:1,nombre_provincia:n.provincia||"Sin provincia"},l={id:n.id,municipio_id:1,nombre_entidad:n.nombre,codigo_entidad:n.codigo,domicilio_legal:n.domicilio_legal,telefonos:n.telefonos,logo:n.logo,tipo_empresa:n.tipo_empresa,ministerio:n.ministerio,activo:n.activo,director_id:n.director_id,createdAt:n.createdAt,updatedAt:n.updatedAt,provincia:i,municipio:{id:1,nombre_municipio:n.municipio||"Sin municipio",provincia_id:1,provincia:i}};return console.log("Item transformado:",l),l})}openEditEntidadDialog(t){this.editMode=!0,this.selectedEntidad=t,this.contactForm.patchValue({id:t.id,nombre:t.nombre_entidad,codigo:t.codigo_entidad,domicilio_legal:t.domicilio_legal,telefonos:t.telefonos,tipo_empresa:t.tipo_empresa,ministerio:t.ministerio,municipio:t.municipio?.nombre_municipio||"",provincia:t.provincia?.nombre_provincia||"",activo:t.activo,logo:t.logo,director_id:t.director_id}),this._cdr.markForCheck()}saveEntidad(){if(this.contactForm.invalid)return;const t=this.contactForm.value;this.editMode&&this.selectedEntidad?this.updateEntidad(t):this.createEntidad(t)}createEntidad(t){console.log("Crear entidad:",t);const n={id:1,nombre_provincia:t.provincia},i={id:1,nombre_municipio:t.municipio,provincia_id:1,provincia:n},r={id:Date.now(),municipio_id:1,nombre_entidad:t.nombre,codigo_entidad:t.codigo,domicilio_legal:t.domicilio_legal,telefonos:t.telefonos,logo:t.logo,tipo_empresa:t.tipo_empresa,ministerio:t.ministerio,activo:t.activo,director_id:t.director_id,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),provincia:n,municipio:i},b=[...this._entidadesSubject.getValue(),r];this._entidadesSubject.next(b),this.dataSource.data=b,this.pagination.length=b.length,this.cancelEdit()}updateEntidad(t){if(!this.selectedEntidad)return;console.log("Actualizar entidad:",t);const n=this._entidadesSubject.getValue(),i=n.findIndex(r=>r.id===this.selectedEntidad.id);if(-1!==i){const r={id:1,nombre_provincia:t.provincia},l={id:1,nombre_municipio:t.municipio,provincia_id:1,provincia:r};n[i]={...n[i],nombre_entidad:t.nombre,codigo_entidad:t.codigo,domicilio_legal:t.domicilio_legal,telefonos:t.telefonos,tipo_empresa:t.tipo_empresa,ministerio:t.ministerio,activo:t.activo,logo:t.logo,director_id:t.director_id,updatedAt:(new Date).toISOString(),provincia:r,municipio:l},this._entidadesSubject.next([...n]),this.dataSource.data=n}this.cancelEdit()}cancelEdit(){this.editMode=!1,this.selectedEntidad=null,this.contactForm.reset(),this._cdr.markForCheck()}deleteEntidad(t){if(confirm(`\xbfEst\xe1 seguro de que desea eliminar la entidad "${t.nombre_entidad}"?`)){console.log("Eliminar entidad:",t.id);const i=this._entidadesSubject.getValue().filter(r=>r.id!==t.id);this._entidadesSubject.next(i),this.dataSource.data=i,this.pagination.length=i.length,this._cdr.markForCheck()}}canAddEntidad(){return!1}trackByFn(t,n){return n.id||t}uploadLogo(t){if(!t||!t[0])return;const n=t[0];if(!n.type.startsWith("image/"))return void alert("Por favor seleccione un archivo de imagen v\xe1lido");if(n.size>5242880)return void alert("El archivo es demasiado grande. M\xe1ximo 5MB");const i=new FileReader;i.onload=()=>{this.contactForm.get("logo")?.setValue(i.result),this.contactForm.markAsDirty(),this._cdr.markForCheck()},i.readAsDataURL(n)}removeLogo(){this.contactForm.get("logo").setValue(null),this.contactForm.markAsDirty(),this._cdr.markForCheck()}openAddEntidadDialog(){this.editMode=!1,this.selectedEntidad=null,this.contactForm.reset(),this.contactForm.patchValue({activo:!0,nombre:"",codigo:"",tipo_empresa:"",ministerio:"",telefonos:"",provincia:"",municipio:"",domicilio_legal:"",logo:null,director_id:null}),this.contactForm.markAsPristine(),this.contactForm.markAsUntouched(),this._cdr.markForCheck()}toggleEditMode(t){if(this.editMode=t,t&&this.dataSource.data.length>0){const n=this.dataSource.data[0];this.selectedEntidad=n,this.contactForm.patchValue({id:n.id,nombre:n.nombre_entidad,codigo:n.codigo_entidad,domicilio_legal:n.domicilio_legal,telefonos:n.telefonos,tipo_empresa:n.tipo_empresa,ministerio:n.ministerio,municipio:n.municipio?.nombre_municipio||"",provincia:n.provincia?.nombre_provincia||"",activo:n.activo,logo:n.logo,director_id:n.director_id})}else this.selectedEntidad=null,this.contactForm.reset(),this.contactForm.patchValue({activo:!0});this._cdr.markForCheck()}getInitials(t){if(!t)return"E";const n=t.split(" ");return 1===n.length?n[0].charAt(0).toUpperCase():(n[0].charAt(0)+n[n.length-1].charAt(0)).toUpperCase()}formatDate(t){return t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):""}goBack(){this.editMode?this.toggleEditMode(!1):console.log("Navegando hacia atr\xe1s...")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(U.q),e.Y36(fe.a),e.Y36(e.sBO),e.Y36(c.qu),e.Y36(u.K0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-entidad-list"]],viewQuery:function(n,i){if(1&n&&(e.Gf(E.NW,5),e.Gf(q.YE,5)),2&n){let r;e.iGM(r=e.CRH())&&(i.paginator=r.first),e.iGM(r=e.CRH())&&(i.sort=r.first)}},standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["multipleEntities",""],[1,"flex","flex-col","w-full"],[4,"ngIf"],[1,"min-h-screen","bg-gray-50","py-8","px-4"],[1,"max-w-2xl","mx-auto"],[1,"flex","justify-between","items-center","mb-8"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"flex","items-center","space-x-4"],["mat-flat-button","","color","primary",1,"px-6",3,"click"],[1,"mr-2"],["mat-icon-button","",1,"w-10","h-10",3,"click"],[1,"bg-white","rounded-2xl","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"px-8","py-8","text-center"],[1,"flex","justify-center","mb-6"],[1,"relative"],[1,"w-24","h-24","rounded-full","bg-gray-200","flex","items-center","justify-center","overflow-hidden"],["class","w-full h-full",4,"ngIf","ngIfElse"],["noLogo",""],[1,"text-2xl","font-semibold","text-gray-900","mb-2"],[1,"flex","flex-wrap","gap-2","justify-center","mb-8"],[1,"flex","items-center","bg-blue-50","text-blue-700","px-3","py-1","rounded-full","text-sm"],[1,"w-4","h-4","mr-1",2,"font-size","16px"],[1,"flex","items-center","bg-green-50","text-green-700","px-3","py-1","rounded-full","text-sm"],[1,"flex","items-center","px-3","py-1","rounded-full","text-sm"],[1,"px-8","pb-8","space-y-6"],[1,"flex","items-center"],[1,"w-8","h-8","bg-blue-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-blue-600","w-5","h-5",2,"font-size","18px"],[1,"text-sm","text-gray-500"],[1,"text-gray-900","font-medium"],[1,"w-8","h-8","bg-green-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-green-600","w-5","h-5",2,"font-size","18px"],[1,"w-8","h-8","bg-purple-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-purple-600","w-5","h-5",2,"font-size","18px"],[1,"flex","items-start"],[1,"w-8","h-8","bg-orange-100","rounded-full","flex","items-center","justify-center","mr-4","mt-1"],[1,"text-orange-600","w-5","h-5",2,"font-size","18px"],[1,"w-8","h-8","bg-gray-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"text-gray-600","w-5","h-5",2,"font-size","18px"],["class","fixed bottom-8 right-8",4,"ngIf"],[1,"w-full","h-full"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"text-gray-600","text-2xl","font-medium"],[1,"fixed","bottom-8","right-8"],["mat-fab","","color","primary","matTooltip","Agregar nueva entidad",3,"click"],[1,"p-8",3,"formGroup"],[1,"flex","justify-center","mb-8"],[1,"absolute","inset-0","bg-black","bg-opacity-50","opacity-0","hover:opacity-100","transition-opacity","duration-200","flex","items-center","justify-center","space-x-2"],["id","logo-file-input","type","file","accept","image/*",1,"hidden",3,"change"],["logoFileInput",""],["type","button","mat-icon-button","",1,"text-white",3,"click"],["noLogoEdit",""],[1,"space-y-6"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Nombre de la entidad",3,"formControlName"],["matInput","","placeholder","C\xf3digo \xfanico",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","N\xfamero de tel\xe9fono",3,"formControlName"],["matInput","","placeholder","Provincia",3,"formControlName"],["matInput","","placeholder","Municipio",3,"formControlName"],["matInput","","placeholder","Direcci\xf3n completa","rows","3",3,"formControlName"],["color","primary",3,"formControlName"],[1,"flex","justify-between","items-center","mt-8","pt-6","border-t"],["type","button","mat-button","","color","warn",3,"click"],[1,"flex","space-x-4"],["type","button","mat-button","",3,"click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(n,i){if(1&n&&e.YNc(0,Se,4,2,"ng-container",0)(1,Ie,0,0,"ng-template",null,1,e.W1O),2&n){const r=e.MAs(2);e.Q6J("ngIf",1===i.dataSource.data.length)("ngIfElse",r)}},dependencies:[u.ez,u.sg,u.O5,C.ot,C.lW,C.RK,C.cs,x.Cv,q.JX,_.p0,F.Ps,F.Hw,c.UX,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,E.TU,Z.lN,Z.KE,Z.hX,Z.TO,O.c,O.Nt,z.AV,z.gM,J.LD,J.gD,B.ey],styles:[".custom-top-offset{top:75px}\n"],encapsulation:2,changeDetection:0})}return o})();var Y=s(217),N=s(9397),L=s(6306),Q=s(2022),Oe=s(9862);let Je=(()=>{class o{constructor(t){this.http=t,this.log=[]}getLogs(){return this.http.get(Q.P.LOGS.BASE).pipe((0,N.b)(t=>console.log("log fetched:",t)),(0,L.K)(t=>(console.error("Error fetching contratos:",t),(0,v.of)([...this.log]))))}logsdelete(){return this.http.delete(Q.P.LOGS.DELETE_ALL).pipe((0,N.b)(t=>console.log("log fetched:",t)),(0,L.K)(t=>(console.error("Error fetching contratos:",t),(0,v.of)([...this.log]))))}exportToExcel(){return this.http.post(Q.P.LOGS.EXPORT_EXCEL,{},{responseType:"blob"}).pipe((0,N.b)(t=>console.log("Excel export initiated")),(0,L.K)(t=>(console.error("Error exporting logs to Excel:",t),(0,v.of)(new Blob))))}exportToPDF(){return this.http.post(Q.P.LOGS.EXPORT_PDF,{},{responseType:"blob"}).pipe((0,N.b)(t=>console.log("PDF export initiated")),(0,L.K)(t=>(console.error("Error exporting logs to PDF:",t),(0,v.of)(new Blob))))}static#e=this.\u0275fac=function(n){return new(n||o)(e.LFG(Oe.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function Ne(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"div",20),e._UZ(3,"i",21),e.TgZ(4,"input",22),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.searchTerm=i)})("input",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSearchChange())}),e.qZA()(),e.TgZ(5,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.toggleFilters())}),e._UZ(6,"i",24),e._uU(7," Filtros "),e.qZA()(),e.TgZ(8,"div",25),e._uU(9),e.TgZ(10,"span",26),e._uU(11),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.searchTerm),e.xp6(1),e.ekj("active",t.showFilters),e.xp6(4),e.AsE(" Mostrando ",t.filteredLogs.length," de ",t.logs.length," registros locales "),e.xp6(2),e.hij("(",t.serverPagination.total," total en servidor)")}}function Le(o,a){if(1&o&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function Qe(o,a){if(1&o&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function Re(o,a){if(1&o&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function je(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",27)(1,"div",28)(2,"div",29)(3,"label"),e._uU(4,"Usuario"),e.qZA(),e.TgZ(5,"select",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filterUser=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onFilterChange())}),e.TgZ(6,"option",31),e._uU(7,"Todos los usuarios"),e.qZA(),e.YNc(8,Le,2,2,"option",32),e.qZA()(),e.TgZ(9,"div",29)(10,"label"),e._uU(11,"Tabla"),e.qZA(),e.TgZ(12,"select",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filterTable=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onFilterChange())}),e.TgZ(13,"option",31),e._uU(14,"Todas las tablas"),e.qZA(),e.YNc(15,Qe,2,2,"option",32),e.qZA()(),e.TgZ(16,"div",29)(17,"label"),e._uU(18,"Acci\xf3n"),e.qZA(),e.TgZ(19,"select",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filterAction=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onFilterChange())}),e.TgZ(20,"option",31),e._uU(21,"Todas las acciones"),e.qZA(),e.YNc(22,Re,2,2,"option",32),e.qZA()(),e.TgZ(23,"div",29)(24,"button",33),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearFilters())}),e._uU(25," Limpiar filtros "),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.filterUser),e.xp6(3),e.Q6J("ngForOf",t.uniqueUsers),e.xp6(4),e.Q6J("ngModel",t.filterTable),e.xp6(3),e.Q6J("ngForOf",t.uniqueTables),e.xp6(4),e.Q6J("ngModel",t.filterAction),e.xp6(3),e.Q6J("ngForOf",t.uniqueActions)}}function ze(o,a){1&o&&(e.TgZ(0,"div",35),e._UZ(1,"div",36),e.TgZ(2,"p"),e._uU(3,"Cargando logs del sistema..."),e.qZA()())}function Be(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",37),e._UZ(1,"i",38),e.TgZ(2,"h3"),e._uU(3,"Error al cargar los logs"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.qZA(),e.TgZ(6,"button",39),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.refresh())}),e._uU(7," Reintentar "),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(5),e.Oqu(t.error)}}function Ye(o,a){if(1&o&&(e.TgZ(0,"tr",48)(1,"td",49),e._uU(2),e.qZA(),e.TgZ(3,"td",50)(4,"div",51)(5,"div",52),e._UZ(6,"i",42),e.qZA(),e._uU(7),e.qZA()(),e.TgZ(8,"td",53),e._uU(9),e.qZA(),e.TgZ(10,"td",54)(11,"span",55),e._uU(12),e.qZA()(),e.TgZ(13,"td",56)(14,"span",57),e._uU(15),e.qZA()()()),2&o){const t=a.$implicit,n=e.oxw(2);e.xp6(2),e.hij("#",t.id,""),e.xp6(5),e.hij(" ",t.usuario," "),e.xp6(2),e.Oqu(n.formatDate(t.fecha)),e.xp6(3),e.Oqu(t.tabla),e.xp6(2),e.Q6J("ngClass",n.getActionClass(t.accion)),e.xp6(1),e.hij(" ",t.accion," ")}}function He(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",66),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.changePage(r))}),e._uU(1),e.qZA()}if(2&o){const t=a.$implicit,n=e.oxw(3);e.ekj("active",n.localCurrentPage===t),e.xp6(1),e.hij(" ",t," ")}}function Ge(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",58)(1,"div",59)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"div",60)(5,"button",61),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changePage(i.localCurrentPage-1))}),e._UZ(6,"i",62),e._uU(7," Anterior "),e.qZA(),e.TgZ(8,"div",63),e.YNc(9,He,2,3,"button",64),e.qZA(),e.TgZ(10,"button",61),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changePage(i.localCurrentPage+1))}),e._uU(11," Siguiente "),e._UZ(12,"i",65),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.lnq(" Mostrando ",t.getStartIndex()," a ",t.getEndIndex()," de ",t.filteredLogs.length," resultados filtrados "),e.xp6(2),e.Q6J("disabled",1===t.localCurrentPage),e.xp6(4),e.Q6J("ngForOf",t.getPagesArray()),e.xp6(1),e.Q6J("disabled",t.localCurrentPage===t.localTotalPages)}}function Ke(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",67)(1,"div",68)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"div",69)(5,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changeServerPage(i.serverPagination.currentPage-1))}),e._UZ(6,"i",62),e._uU(7," P\xe1gina Anterior "),e.qZA(),e.TgZ(8,"div",71)(9,"span"),e._uU(10),e.qZA()(),e.TgZ(11,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changeServerPage(i.serverPagination.currentPage+1))}),e._uU(12," P\xe1gina Siguiente "),e._UZ(13,"i",65),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.lnq(" P\xe1gina ",t.serverPagination.currentPage," de ",t.serverPagination.totalPages," del servidor (",t.serverPagination.total," registros totales) "),e.xp6(2),e.Q6J("disabled",1===t.serverPagination.currentPage),e.xp6(5),e.AsE("",t.serverPagination.currentPage," / ",t.serverPagination.totalPages,""),e.xp6(1),e.Q6J("disabled",t.serverPagination.currentPage===t.serverPagination.totalPages)}}function Ve(o,a){if(1&o&&(e.TgZ(0,"div",40)(1,"table",41)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"ID"),e.qZA(),e.TgZ(6,"th"),e._UZ(7,"i",42),e._uU(8," Usuario "),e.qZA(),e.TgZ(9,"th"),e._UZ(10,"i",43),e._uU(11," Fecha "),e.qZA(),e.TgZ(12,"th"),e._UZ(13,"i",44),e._uU(14," Tabla "),e.qZA(),e.TgZ(15,"th"),e._UZ(16,"i",4),e._uU(17," Acci\xf3n "),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,Ye,16,6,"tr",45),e.qZA()(),e.YNc(20,Ge,13,6,"div",46)(21,Ke,14,7,"div",47),e.qZA()),2&o){const t=e.oxw();e.xp6(19),e.Q6J("ngForOf",t.paginatedLogs),e.xp6(1),e.Q6J("ngIf",t.localTotalPages>1),e.xp6(1),e.Q6J("ngIf",t.serverPagination.totalPages>1)}}function $e(o,a){1&o&&(e.TgZ(0,"p"),e._uU(1," No hay logs que coincidan con los filtros aplicados. "),e.qZA())}function We(o,a){1&o&&(e.TgZ(0,"p"),e._uU(1,"No hay logs disponibles en esta p\xe1gina."),e.qZA())}function Xe(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clearFilters())}),e._uU(1," Limpiar filtros "),e.qZA()}}function et(o,a){if(1&o&&(e.TgZ(0,"div",72),e._UZ(1,"i",4),e.TgZ(2,"h3"),e._uU(3,"No se encontraron logs"),e.qZA(),e.YNc(4,$e,2,0,"p",73)(5,We,2,0,"ng-template",null,74,e.W1O)(7,Xe,2,0,"button",75),e.qZA()),2&o){const t=e.MAs(6),n=e.oxw();e.xp6(4),e.Q6J("ngIf",n.searchTerm||n.filterUser||n.filterTable||n.filterAction)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",n.searchTerm||n.filterUser||n.filterTable||n.filterAction)}}let tt=(()=>{class o{constructor(t,n){this.logService=t,this.cdr=n,this.logs=[],this.loading=!0,this.error="",this.serverPagination={total:0,currentPage:1,totalPages:0,limit:50},this.searchTerm="",this.filterUser="",this.filterTable="",this.filterAction="",this.showFilters=!1,this.localCurrentPage=1,this.itemsPerPage=10,this.filteredLogs=[],this.paginatedLogs=[],this.uniqueUsers=[],this.uniqueTables=[],this.uniqueActions=[],this.localTotalPages=0}ngOnInit(){this.loadLogs()}loadLogs(t=1){this.loading=!0,this.error="",this.logService.getLogs().subscribe({next:n=>{if(console.log("Respuesta completa:",n),n&&n.data&&Array.isArray(n.data)){const i=n;this.serverPagination={total:i.pagination.total,currentPage:i.pagination.page,totalPages:i.pagination.pages,limit:i.pagination.limit},this.logs=this.transformApiData(i.data),this.calculateUniqueValues(),this.applyFilters()}else console.error("Estructura de datos inesperada:",n),this.error="Estructura de datos inesperada del servidor";this.loading=!1},error:n=>{console.error("Error al cargar logs:",n),this.error="Error al cargar los logs del sistema",this.loading=!1}})}transformApiData(t){return t.map(n=>{let i=this.extractTableFromDetails(n.details);return i||(i=this.extractTableFromDescription(n.description)),{id:n.id,usuario:`ID: ${n.user_id}`,fecha:new Date(n.createdAt),tabla:i,accion:this.mapActionToSpanish(n.action)}})}extractTableFromDetails(t){try{const n=JSON.parse(t);if(n.tipo)return n.tipo}catch{console.warn("No se pudo parsear details:",t)}return""}extractTableFromDescription(t){return t.includes("Catalogo")?"catalogo":t.includes("ministerios")?"ministerios":t.includes("municipios")?"municipios":"sistema"}mapActionToSpanish(t){return{consultar:"READ",crear:"CREATE",actualizar:"UPDATE",eliminar:"DELETE"}[t]||t.toUpperCase()}calculateUniqueValues(){this.uniqueUsers=[...new Set(this.logs.map(t=>t.usuario))],this.uniqueTables=[...new Set(this.logs.map(t=>t.tabla))],this.uniqueActions=[...new Set(this.logs.map(t=>t.accion))]}applyFilters(){this.filteredLogs=this.logs.filter(t=>(""===this.searchTerm||t.usuario.toLowerCase().includes(this.searchTerm.toLowerCase())||t.tabla.toLowerCase().includes(this.searchTerm.toLowerCase())||t.accion.toLowerCase().includes(this.searchTerm.toLowerCase()))&&(""===this.filterUser||t.usuario===this.filterUser)&&(""===this.filterTable||t.tabla===this.filterTable)&&(""===this.filterAction||t.accion===this.filterAction)),this.localTotalPages=Math.ceil(this.filteredLogs.length/this.itemsPerPage),this.localCurrentPage=Math.min(this.localCurrentPage,Math.max(1,this.localTotalPages)),this.updatePagination()}updatePagination(){const t=(this.localCurrentPage-1)*this.itemsPerPage;this.paginatedLogs=this.filteredLogs.slice(t,t+this.itemsPerPage)}onSearchChange(){this.localCurrentPage=1,this.applyFilters()}onFilterChange(){this.localCurrentPage=1,this.applyFilters()}toggleFilters(){this.showFilters=!this.showFilters}clearFilters(){this.searchTerm="",this.filterUser="",this.filterTable="",this.filterAction="",this.localCurrentPage=1,this.applyFilters()}changePage(t){t>=1&&t<=this.localTotalPages&&(this.localCurrentPage=t,this.updatePagination())}changeServerPage(t){t>=1&&t<=this.serverPagination.totalPages&&this.loadLogs(t)}getActionClass(t){switch(t){case"CREATE":return"action-create";case"READ":return"action-read";case"UPDATE":return"action-update";case"DELETE":return"action-delete";default:return"action-default"}}formatDate(t){return t.toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}getPagesArray(){return Array.from({length:this.localTotalPages},(t,n)=>n+1)}getStartIndex(){return(this.localCurrentPage-1)*this.itemsPerPage+1}getEndIndex(){return Math.min(this.localCurrentPage*this.itemsPerPage,this.filteredLogs.length)}refresh(){this.loadLogs(this.serverPagination.currentPage)}exportToExcel(){this.loading=!0,this.logService.exportToExcel().subscribe({next:t=>{(0,Y.saveAs)(t,"logs.xlsx"),this.loading=!1},error:()=>{this.loading=!1}})}exportToPDF(){this.loading=!0,this.logService.exportToPDF().subscribe({next:t=>{(0,Y.saveAs)(t,"logs.pdf"),this.loading=!1},error:()=>{this.loading=!1}})}deleteLogs(){this.loading=!0,this.logService.logsdelete().subscribe({next:()=>{this.loading=!1},error:()=>{this.loading=!1}})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Je),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-system"]],standalone:!0,features:[e.jDz],decls:26,vars:10,consts:[[1,"logs-container"],[1,"header"],[1,"header-title"],[1,"title-section"],[1,"icon-activity"],[1,"action-buttons"],[1,"btn","btn-primary",3,"disabled","click"],[1,"icon-refresh"],[1,"btn","btn-success",3,"disabled","click"],[1,"icon-download"],[1,"btn","btn-danger",3,"disabled","click"],[1,"icon-trash"],["class","search-filters-section",4,"ngIf"],["class","filters-section",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","table-container",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"search-filters-section"],[1,"search-and-filter"],[1,"search-container"],[1,"icon-search"],["type","text","placeholder","Buscar logs...",1,"search-input",3,"ngModel","ngModelChange","input"],[1,"btn-filter",3,"click"],[1,"icon-filter"],[1,"results-count"],[1,"server-info"],[1,"filters-section"],[1,"filters-grid"],[1,"filter-group"],[3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-secondary","full-width",3,"click"],[3,"value"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[1,"icon-alert-circle"],[1,"btn","btn-primary",3,"click"],[1,"table-container"],[1,"logs-table"],[1,"icon-user"],[1,"icon-calendar"],[1,"icon-database"],["class","table-row",4,"ngFor","ngForOf"],["class","pagination-container",4,"ngIf"],["class","server-pagination-container",4,"ngIf"],[1,"table-row"],[1,"log-id"],[1,"log-user"],[1,"user-info"],[1,"user-avatar"],[1,"log-date"],[1,"log-table"],[1,"table-badge"],[1,"log-action"],[1,"action-badge",3,"ngClass"],[1,"pagination-container"],[1,"pagination-info"],[1,"pagination-controls"],[1,"btn-pagination",3,"disabled","click"],[1,"icon-chevron-left"],[1,"page-numbers"],["class","btn-page",3,"active","click",4,"ngFor","ngForOf"],[1,"icon-chevron-right"],[1,"btn-page",3,"click"],[1,"server-pagination-container"],[1,"server-pagination-info"],[1,"server-pagination-controls"],[1,"btn-pagination","server-btn",3,"disabled","click"],[1,"server-page-info"],[1,"empty-state"],[4,"ngIf","ngIfElse"],["noLogs",""],["class","btn btn-primary",3,"click",4,"ngIf"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"i",4),e.TgZ(5,"h1"),e._uU(6,"Logs del Sistema"),e.qZA()(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return i.refresh()}),e._UZ(9,"i",7),e._uU(10," Actualizar "),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.exportToExcel()}),e._UZ(12,"i",9),e._uU(13," Exportar a Excel "),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return i.exportToPDF()}),e._UZ(15,"i",9),e._uU(16," Exportar a PDF "),e.qZA(),e.TgZ(17,"button",10),e.NdJ("click",function(){return i.deleteLogs()}),e._UZ(18,"i",11),e._uU(19," Eliminar logs "),e.qZA()()(),e.YNc(20,Ne,12,6,"div",12)(21,je,26,6,"div",13),e.qZA(),e.YNc(22,ze,4,0,"div",14)(23,Be,8,1,"div",15)(24,Ve,22,3,"div",16)(25,et,8,3,"div",17),e.qZA()),2&n&&(e.xp6(8),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("disabled",i.loading),e.xp6(3),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",i.showFilters&&!i.loading),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",i.error&&!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading&&!i.error),e.xp6(1),e.Q6J("ngIf",0===i.filteredLogs.length&&!i.loading&&!i.error))},dependencies:[u.ez,u.mk,u.sg,u.O5,c.u5,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.On],styles:['@charset "UTF-8";.logs-container[_ngcontent-%COMP%]{padding:1.5rem;width:100%;background-color:#f9fafb;min-height:100vh}.header[_ngcontent-%COMP%]{margin-bottom:2rem}.header-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:700;color:#111827;margin:0}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.btn-success[_ngcontent-%COMP%]{background-color:#16a34a;color:#fff}.btn-success[_ngcontent-%COMP%]:hover{background-color:#15803d}.btn-secondary[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}.search-filters-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;padding:1rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb}.search-and-filter[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem}.search-container[_ngcontent-%COMP%]{position:relative}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem .5rem 2.5rem;border:1px solid #d1d5db;border-radius:.5rem;width:16rem;font-size:.875rem}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.btn-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border:1px solid #d1d5db;background-color:#fff;border-radius:.5rem;cursor:pointer;transition:all .2s}.btn-filter[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-filter.active[_ngcontent-%COMP%]{background-color:#eff6ff;border-color:#93c5fd;color:#1d4ed8}.results-count[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.filters-section[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;padding-top:1rem}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.25rem}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:.875rem}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.full-width[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb;overflow:hidden}.logs-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.logs-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f9fafb;border-bottom:1px solid #e5e7eb}.logs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem 1.5rem;text-align:left;font-size:.75rem;font-weight:500;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.logs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.25rem}.logs-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6}.table-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.logs-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.5rem;font-size:.875rem}.log-id[_ngcontent-%COMP%]{font-weight:500;color:#111827}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.user-avatar[_ngcontent-%COMP%]{width:2rem;height:2rem;background-color:#dbeafe;border-radius:50%;display:flex;align-items:center;justify-content:center}.user-avatar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#2563eb}.table-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500;background-color:#f3f4f6;color:#374151;border:1px solid #e5e7eb}.action-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500;border:1px solid}.action-create[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534;border-color:#bbf7d0}.action-read[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af;border-color:#93c5fd}.action-update[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e;border-color:#fcd34d}.action-delete[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b;border-color:#fca5a5}.action-default[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151;border-color:#e5e7eb}.pagination-container[_ngcontent-%COMP%]{background-color:#fff;padding:.75rem 1.5rem;border-top:1px solid #e5e7eb;display:flex;align-items:center;justify-content:space-between}.pagination-info[_ngcontent-%COMP%]{font-size:.875rem;color:#374151}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.btn-pagination[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;padding:.5rem .75rem;font-size:.875rem;font-weight:500;border:1px solid #d1d5db;background-color:#fff;border-radius:.375rem;cursor:pointer;transition:all .2s}.btn-pagination[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f9fafb}.btn-pagination[_ngcontent-%COMP%]:disabled{color:#9ca3af;cursor:not-allowed}.page-numbers[_ngcontent-%COMP%]{display:flex;gap:.25rem}.btn-page[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.875rem;font-weight:500;border:1px solid #d1d5db;background-color:#fff;border-radius:.375rem;cursor:pointer;transition:all .2s}.btn-page[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-page.active[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff;border-color:#2563eb}.empty-state[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb;padding:2rem;text-align:center}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;color:#9ca3af;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:500;color:#111827;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:1rem}.icon-activity[_ngcontent-%COMP%]:before{content:"\\26a1"}.icon-refresh[_ngcontent-%COMP%]:before{content:"\\1f504"}.icon-download[_ngcontent-%COMP%]:before{content:"\\2b07\\fe0f"}.icon-search[_ngcontent-%COMP%]:before{content:"\\1f50d";position:absolute;left:.75rem;top:50%;transform:translateY(-50%);color:#9ca3af}.icon-filter[_ngcontent-%COMP%]:before{content:"\\1f53d"}.icon-user[_ngcontent-%COMP%]:before{content:"\\1f464"}.icon-calendar[_ngcontent-%COMP%]:before{content:"\\1f4c5"}.icon-database[_ngcontent-%COMP%]:before{content:"\\1f5c3\\fe0f"}.icon-chevron-left[_ngcontent-%COMP%]:before{content:"\\25c0"}.icon-chevron-right[_ngcontent-%COMP%]:before{content:"\\25b6"}@media (max-width: 768px){.logs-container[_ngcontent-%COMP%]{padding:1rem}.header-title[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.search-and-filter[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.logs-table[_ngcontent-%COMP%]{font-size:.75rem}.logs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .logs-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}.pagination-container[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}}']})}return o})();var nt=s(3620),ot=s(1073),P=s(7988),H=s(5986),it=s(4065),at=s(1892),rt=s(7700);const ct=["columnMenuTrigger"];function st(o,a){1&o&&(e.TgZ(0,"div",26),e._UZ(1,"mat-progress-bar",27),e.qZA()),2&o&&(e.xp6(1),e.Q6J("mode","indeterminate"))}function lt(o,a){1&o&&(e.TgZ(0,"th",44),e._uU(1,"#"),e.qZA())}function dt(o,a){if(1&o&&(e.TgZ(0,"td",45),e._uU(1),e.qZA()),2&o){const t=a.index;e.oxw();const n=e.MAs(16);e.xp6(1),e.hij(" ",((null==n?null:n.pageIndex)||0)*((null==n?null:n.pageSize)||10)+t+1," ")}}function pt(o,a){if(1&o&&(e.TgZ(0,"th",49),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("mat-sort-header",t.key)("matTooltip",t.tooltip),e.xp6(1),e.hij(" ",t.label," ")}}function gt(o,a){if(1&o&&(e.TgZ(0,"td",50),e._uU(1),e.qZA()),2&o){const t=a.$implicit,n=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.hij(" ",i.getColumnValue(t,n.key)," ")}}function ut(o,a){1&o&&(e.ynx(0,46),e.YNc(1,pt,2,3,"th",47)(2,gt,2,1,"td",48),e.BQk()),2&o&&e.Q6J("matColumnDef",a.$implicit.key)}function mt(o,a){1&o&&(e.TgZ(0,"th",51),e._uU(1,"Acciones"),e.qZA())}function _t(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"td",52)(1,"button",53),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.toggleDetails(r))}),e._UZ(2,"mat-icon",54),e.qZA()()}if(2&o){const t=a.$implicit,n=e.oxw(2);e.xp6(2),e.Q6J("svgIcon",n.isRowSelected(t)?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down")}}function ft(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",57)(1,"div",58)(2,"form",59)(3,"div",60)(4,"h3",61),e._uU(5," Detalles del Departamento "),e.qZA(),e.TgZ(6,"button",62),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.closeDetails())}),e._UZ(7,"mat-icon",11),e.qZA()(),e.TgZ(8,"div",63)(9,"mat-form-field",64)(10,"mat-label"),e._uU(11,"Nombre del Departamento"),e.qZA(),e._UZ(12,"input",65)(13,"mat-icon",66),e.qZA(),e.TgZ(14,"mat-form-field",64)(15,"mat-label"),e._uU(16,"C\xf3digo"),e.qZA(),e._UZ(17,"input",67)(18,"mat-icon",66),e.qZA(),e.TgZ(19,"mat-form-field",64)(20,"mat-label"),e._uU(21,"Director"),e.qZA(),e._UZ(22,"input",68)(23,"mat-icon",66),e.qZA(),e.TgZ(24,"mat-form-field",64)(25,"mat-label"),e._uU(26,"Tel\xe9fono"),e.qZA(),e._UZ(27,"input",69)(28,"mat-icon",66),e.qZA(),e.TgZ(29,"mat-form-field",64)(30,"mat-label"),e._uU(31,"Estado"),e.qZA(),e.TgZ(32,"mat-select",70)(33,"mat-option",71),e._uU(34,"Activo"),e.qZA(),e.TgZ(35,"mat-option",72),e._uU(36,"Inactivo"),e.qZA()()(),e.TgZ(37,"mat-form-field",64)(38,"mat-label"),e._uU(39,"Ministerio"),e.qZA(),e._UZ(40,"input",73)(41,"mat-icon",66),e.qZA()(),e.TgZ(42,"mat-form-field",64)(43,"mat-label"),e._uU(44,"Descripci\xf3n"),e.qZA(),e._UZ(45,"textarea",74)(46,"mat-icon",66),e.qZA(),e.TgZ(47,"div",75)(48,"button",76),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.deleteSelectedRecord())}),e._UZ(49,"mat-icon",77),e._uU(50," Eliminar "),e.qZA(),e.TgZ(51,"div",78)(52,"button",79),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.closeDetails())}),e._uU(53," Cancelar "),e.qZA(),e.TgZ(54,"button",80),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.updateSelectedRecord())}),e._UZ(55,"mat-icon",77),e._uU(56," Actualizar "),e.qZA()()()()()()}if(2&o){const t=e.oxw(3);e.xp6(2),e.Q6J("formGroup",t.selectedRowForm),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(6),e.Q6J("svgIcon","heroicons_outline:building-office"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:hashtag"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:user"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:phone"),e.xp6(13),e.Q6J("svgIcon","heroicons_outline:building-office-2"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:trash"),e.xp6(6),e.Q6J("svgIcon","heroicons_outline:check")}}function ht(o,a){if(1&o&&(e.TgZ(0,"td",55),e.YNc(1,ft,57,10,"div",56),e.qZA()),2&o){const t=a.$implicit,n=e.oxw(2);e.uIk("colspan",n.displayedColumns.length),e.xp6(1),e.Q6J("ngIf",n.isRowSelected(t))}}function bt(o,a){1&o&&e._UZ(0,"tr",81)}function xt(o,a){1&o&&e._UZ(0,"tr",82)}function vt(o,a){1&o&&e._UZ(0,"tr",83)}const Zt=()=>["detail"],Tt=()=>[5,10,25,50,100];function Ct(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",28)(2,"table",29),e.ynx(3,30),e.YNc(4,lt,2,0,"th",31)(5,dt,2,1,"td",32),e.BQk(),e.YNc(6,ut,3,1,"ng-container",33),e.ynx(7,34),e.YNc(8,mt,2,0,"th",35)(9,_t,3,1,"td",36),e.BQk(),e.ynx(10,37),e.YNc(11,ht,2,2,"td",38),e.BQk(),e.YNc(12,bt,1,0,"tr",39)(13,xt,1,0,"tr",40)(14,vt,1,0,"tr",41),e.qZA()(),e._UZ(15,"mat-paginator",42,43),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("dataSource",t.dataSource),e.xp6(4),e.Q6J("ngForOf",t.getVisibleColumns()),e.xp6(6),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)("matRowDefWhen",t.isRegularRow),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(12,Zt))("matRowDefWhen",t.isDetailRow),e.xp6(1),e.Q6J("length",t.dataSource.data.length)("pageSize",10)("pageSizeOptions",e.DdM(13,Tt))("showFirstLastButtons",!0)}}function At(o,a){1&o&&(e.TgZ(0,"div",84),e._UZ(1,"mat-icon",85),e.TgZ(2,"div",86),e._uU(3,"\xa1No hay departamentos!"),e.qZA(),e.TgZ(4,"p",87),e._uU(5,"Comienza agregando tu primer departamento al sistema"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:building-office"))}function yt(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",88),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(1,"mat-checkbox",89),e.NdJ("change",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.toggleColumn(r.key))})("click",function(i){return i.stopPropagation()}),e._uU(2),e.qZA()()}if(2&o){const t=a.$implicit;e.xp6(1),e.Q6J("checked",t.visible)("color","primary"),e.xp6(1),e.hij(" ",t.label," ")}}const wt=[{path:"entidad",component:Fe},{path:"trabajadores",loadChildren:()=>Promise.all([s.e(592),s.e(389)]).then(s.bind(s,9389)).then(o=>o.TrabajadoresModule)},{path:"departamentos",component:(()=>{class o{constructor(t,n,i,r){this.departamentoService=t,this.cdr=n,this.exportService=i,this.dialog=r,this.columnSettings=[{key:"nombre_departamento",label:"Nombre",visible:!0,tooltip:"Nombre del departamento"},{key:"codigo",label:"C\xf3digo",visible:!0,tooltip:"C\xf3digo del departamento"},{key:"descripcion",label:"Descripci\xf3n",visible:!0,tooltip:"Descripci\xf3n del departamento"},{key:"director",label:"Director",visible:!1,tooltip:"Director del departamento"},{key:"estado",label:"Estado",visible:!0,tooltip:"Estado del departamento"},{key:"fecha_creacion",label:"Fecha Creaci\xf3n",visible:!1,tooltip:"Fecha de creaci\xf3n"},{key:"ministerio",label:"Ministerio",visible:!1,tooltip:"Ministerio al que pertenece"},{key:"presupuesto_anual",label:"Presupuesto",visible:!1,tooltip:"Presupuesto anual"},{key:"telefono",label:"Tel\xe9fono",visible:!1,tooltip:"Tel\xe9fono del departamento"}],this.displayedColumns=[],this.dataSource=new _.by([]),this.searchInputControl=new c.NI,this.selectedRow=null,this.isLoading=!1,this.isRegularRow=(l,b)=>!0,this.isDetailRow=(l,b)=>!1,this.selectedRowForm=new c.cw({id:new c.NI(""),nombre_departamento:new c.NI(""),codigo:new c.NI(""),descripcion:new c.NI(""),director:new c.NI(""),estado:new c.NI(""),fecha_creacion:new c.NI(""),ministerio:new c.NI(""),presupuesto_anual:new c.NI(""),telefono:new c.NI("")})}ngOnInit(){this.updateDisplayedColumns(),this.isLoading=!0,this.departamentoService.getDepartamentos().subscribe(t=>{this.dataSource.data=t.data,this.isLoading=!1,this.cdr.detectChanges()}),this.dataSource.filterPredicate=(t,n)=>{if(!n)return!0;const i=n.toLowerCase().split(" ").filter(l=>l.length>0),r=[t.nombre_departamento,t.codigo,t.descripcion].join(" ").toLowerCase();return i.every(l=>r.includes(l))},this.searchInputControl.valueChanges.pipe((0,nt.b)(300)).subscribe(t=>{this.dataSource.filter=t.trim().toLowerCase(),this.closeDetails()})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.cdr.detectChanges()}getVisibleColumns(){return this.columnSettings.filter(t=>t.visible)}updateDisplayedColumns(){this.displayedColumns=["index",...this.getVisibleColumns().map(t=>t.key),"actions"]}toggleColumn(t){const n=this.columnSettings.find(i=>i.key===t);n&&(n.visible=!n.visible,this.updateDisplayedColumns(),this.cdr.detectChanges())}getColumnValue(t,n){switch(n){case"estado":return"activo"===t[n]?"Activo":"Inactivo";case"fecha_creacion":return t[n]?new Date(t[n]).toLocaleDateString():"-";case"presupuesto_anual":return t[n]?`$${Number(t[n]).toLocaleString()}`:"-";case"descripcion":return t[n]||"Sin descripci\xf3n";default:return t[n]||"-"}}isRowSelected(t){return!!this.selectedRow&&(this.selectedRow.id||this.selectedRow.nombre_departamento)===(t.id||t.nombre_departamento)}toggleDetails(t){const n=t.id||t.nombre_departamento;(this.selectedRow?.id||this.selectedRow?.nombre_departamento)===n?this.selectedRow=null:(this.selectedRow=t,this.selectedRowForm.patchValue(t))}closeDetails(){this.selectedRow=null}openNewDepartamentoDialog(){this.dialog.open(ot.Q,{width:"30%",height:"90%",data:{}}).afterClosed().subscribe(n=>{n&&this.departamentoService.createDepartamento(n).subscribe({next:i=>{this.dataSource.data=[...this.dataSource.data,i],this.departamentoService.getDepartamentos().subscribe(r=>{this.dataSource.data=r.data,this.isLoading=!1,this.cdr.detectChanges()}),this.cdr.detectChanges()},error:i=>{console.error("Error creating departamento:",i)}})})}updateSelectedRecord(){this.selectedRow&&this.selectedRowForm.valid&&console.log("Updating record:",this.selectedRowForm.value)}deleteSelectedRecord(){this.selectedRow&&console.log("Deleting record:",this.selectedRow)}exportToPDF(){const t=this.getVisibleColumns().map(i=>({key:i.key,label:i.label})),n=this.dataSource.filteredData.map(i=>{const r={};return t.forEach(l=>{r[l.key]=this.getColumnValue(i,l.key)}),r});this.exportService.exportToPDF(n,t,"Lista de Departamentos","departamentos")}exportToExcel(){const t=this.getVisibleColumns().map(i=>({key:i.key,label:i.label})),n=this.dataSource.filteredData.map(i=>{const r={};return t.forEach(l=>{r[l.key]=this.getColumnValue(i,l.key)}),r});this.exportService.exportToExcel(n,t,"departamentos")}print(){this.getFilteredData();const n=window.open("","_blank");n&&(n.document.close(),n.focus(),setTimeout(()=>{n.print(),n.close()},250))}getFilteredData(){return this.dataSource.filteredData?this.dataSource.filteredData:this.dataSource.data}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(it._),e.Y36(e.sBO),e.Y36(at.T),e.Y36(rt.uw))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-departamento"]],viewQuery:function(n,i){if(1&n&&(e.Gf(E.NW,5),e.Gf(q.YE,5),e.Gf(ct,5,P.p6)),2&n){let r;e.iGM(r=e.CRH())&&(i.paginator=r.first),e.iGM(r=e.CRH())&&(i.sort=r.first),e.iGM(r=e.CRH())&&(i.columnMenuTrigger=r.first)}},standalone:!0,features:[e.jDz],decls:44,vars:17,consts:[[1,"flex","flex-col","min-h-screen","p-6","w-full"],[1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","placeholder","Buscar departamentos",3,"formControl","autocomplete"],["mat-icon-button","","matTooltip","Configurar columnas",1,"ml-2",3,"matMenuTriggerFor","color"],["columnMenuTrigger","matMenuTrigger"],[3,"svgIcon"],["mat-icon-button","","matTooltip","Exportar",1,"ml-2",3,"matMenuTriggerFor"],["mat-flat-button","","color","primary",1,"ml-4",3,"click"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden"],[4,"ngIf","ngIfElse"],["noDepartments",""],[1,"column-menu"],["columnMenu","matMenu"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-300","border-b"],[1,"p-2",3,"click"],["class","flex items-center py-1 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",3,"click",4,"ngFor","ngForOf"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"min-w-full",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","class","w-16 text-center",4,"matHeaderCellDef"],["mat-cell","","class","w-16 text-center",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","","class","w-24 text-center",4,"matHeaderCellDef"],["mat-cell","","class","w-24 text-center",4,"matCellDef"],["matColumnDef","detail"],["mat-cell","","class","p-0",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-150",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns","matRowDefWhen"],[1,"border-t","bg-gray-50","dark:bg-transparent",3,"length","pageSize","pageSizeOptions","showFirstLastButtons"],["paginator",""],["mat-header-cell","",1,"w-16","text-center"],["mat-cell","",1,"w-16","text-center"],[3,"matColumnDef"],["mat-header-cell","","class","font-semibold",3,"mat-sort-header","matTooltip",4,"matHeaderCellDef"],["mat-cell","","class","truncate max-w-xs",4,"matCellDef"],["mat-header-cell","",1,"font-semibold",3,"mat-sort-header","matTooltip"],["mat-cell","",1,"truncate","max-w-xs"],["mat-header-cell","",1,"w-24","text-center"],["mat-cell","",1,"w-24","text-center"],["mat-stroked-button","","matTooltip","Ver detalles",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-cell","",1,"p-0"],["class","detail-container bg-gray-50 dark:bg-gray-800 border-t",4,"ngIf"],[1,"detail-container","bg-gray-50","dark:bg-gray-800","border-t"],[1,"p-6"],[1,"space-y-4",3,"formGroup"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-900","dark:text-gray-100"],["mat-icon-button","","matTooltip","Cerrar",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"w-full"],["matInput","","formControlName","nombre_departamento"],["matSuffix","",3,"svgIcon"],["matInput","","formControlName","codigo"],["matInput","","formControlName","director"],["matInput","","formControlName","telefono"],["formControlName","estado"],["value","activo"],["value","inactivo"],["matInput","","formControlName","ministerio"],["matInput","","formControlName","descripcion","rows","3"],[1,"flex","items-center","justify-between","pt-4","border-t"],["mat-button","","color","warn",1,"flex","items-center",3,"click"],[1,"mr-2",3,"svgIcon"],[1,"flex","space-x-2"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",1,"flex","items-center",3,"click"],["mat-header-row",""],["mat-row","",1,"hover:bg-gray-50","dark:hover:bg-gray-800","transition-colors","duration-150"],["mat-row","",1,"detail-row"],[1,"flex","flex-col","items-center","justify-center","py-16"],[1,"text-6xl","text-gray-400","mb-4",3,"svgIcon"],[1,"text-2xl","font-semibold","text-gray-600","mb-2"],[1,"text-gray-500","mb-6","text-center"],[1,"flex","items-center","py-1","px-2","hover:bg-gray-100","dark:hover:bg-gray-700","rounded",3,"click"],[3,"checked","color","change","click"]],template:function(n,i){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,st,2,1,"div",3),e.TgZ(4,"div",4),e._uU(5,"Departamentos"),e.qZA(),e.TgZ(6,"div",5)(7,"mat-form-field",6),e._UZ(8,"mat-icon",7)(9,"input",8),e.qZA(),e.TgZ(10,"button",9,10),e._UZ(12,"mat-icon",11),e.qZA(),e.TgZ(13,"button",12),e._UZ(14,"mat-icon",11),e.qZA(),e.TgZ(15,"button",13),e.NdJ("click",function(){return i.openNewDepartamentoDialog()}),e._UZ(16,"mat-icon",11),e.TgZ(17,"span",14),e._uU(18,"Agregar"),e.qZA()()()(),e.TgZ(19,"div",15)(20,"div",16),e.YNc(21,Ct,17,14,"ng-container",17)(22,At,6,1,"ng-template",null,18,e.W1O),e.qZA()()()(),e.TgZ(24,"mat-menu",19,20)(26,"div",21),e._uU(27," Mostrar Columnas "),e.qZA(),e.TgZ(28,"div",22),e.NdJ("click",function(l){return l.stopPropagation()}),e.YNc(29,yt,3,3,"div",23),e.qZA()(),e.TgZ(30,"mat-menu",null,24)(32,"button",25),e.NdJ("click",function(){return i.exportToPDF()}),e._UZ(33,"mat-icon",11),e.TgZ(34,"span"),e._uU(35,"Exportar a PDF"),e.qZA()(),e.TgZ(36,"button",25),e.NdJ("click",function(){return i.exportToExcel()}),e._UZ(37,"mat-icon",11),e.TgZ(38,"span"),e._uU(39,"Exportar a Excel"),e.qZA()(),e.TgZ(40,"button",25),e.NdJ("click",function(){return i.print()}),e._UZ(41,"mat-icon",11),e.TgZ(42,"span"),e._uU(43,"Imprimir"),e.qZA()()()),2&n){const r=e.MAs(23),l=e.MAs(25),b=e.MAs(31);e.xp6(3),e.Q6J("ngIf",i.isLoading),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:magnifying-glass"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off"),e.xp6(1),e.Q6J("matMenuTriggerFor",l)("color","primary"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:view-columns"),e.xp6(1),e.Q6J("matMenuTriggerFor",b),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:arrow-down-tray"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",i.dataSource.data.length>0)("ngIfElse",r),e.xp6(8),e.Q6J("ngForOf",i.columnSettings),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:table-cells"),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:printer")}},dependencies:[u.ez,u.sg,u.O5,A.QW,_.p0,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,E.TU,E.NW,q.JX,q.YE,q.nU,C.ot,C.lW,C.RK,F.Ps,F.Hw,Z.lN,Z.KE,Z.hX,Z.qo,Z.R9,O.c,O.Nt,c.UX,c._Y,c.Fj,c.JJ,c.JL,c.oH,c.sg,c.u,P.Tx,P.VK,P.OP,P.p6,H.p9,H.oG,J.LD,J.gD,B.ey]})}return o})()},{path:"log",component:tt},{path:"licencia",component:re},{path:"bd",component:ue}];let Ut=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[k.Bz.forChild(wt),k.Bz]})}return o})()},217:function(R,D){var s,u;void 0!==(u="function"==typeof(s=function(){"use strict";function x(d,p,h){var g=new XMLHttpRequest;g.open("GET",d),g.responseType="blob",g.onload=function(){w(g.response,p,h)},g.onerror=function(){console.error("could not download file")},g.send()}function e(d){var p=new XMLHttpRequest;p.open("HEAD",d,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function y(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(p)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,M=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),w=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!M?function(d,p,h){var g=f.URL||f.webkitURL,m=document.createElement("a");m.download=p=p||d.name||"download",m.rel="noopener","string"==typeof d?(m.href=d,m.origin===location.origin?y(m):e(m.href)?x(d,p,h):y(m,m.target="_blank")):(m.href=g.createObjectURL(d),setTimeout(function(){g.revokeObjectURL(m.href)},4e4),setTimeout(function(){y(m)},0))}:"msSaveOrOpenBlob"in navigator?function(d,p,h){if(p=p||d.name||"download","string"!=typeof d)navigator.msSaveOrOpenBlob(function A(d,p){return typeof p>"u"?p={autoBom:!1}:"object"!=typeof p&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\ufeff",d],{type:d.type}):d}(d,h),p);else if(e(d))x(d,p,h);else{var g=document.createElement("a");g.href=d,g.target="_blank",setTimeout(function(){y(g)})}}:function(d,p,h,g){if((g=g||open("","_blank"))&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof d)return x(d,p,h);var m="application/octet-stream"===d.type,j=/constructor/i.test(f.HTMLElement)||f.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||m&&j||M)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var T=v.result;T=S?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=T:location=T,g=null},v.readAsDataURL(d)}else{var I=f.URL||f.webkitURL,U=I.createObjectURL(d);g?g.location=U:location.href=U,g=null,setTimeout(function(){I.revokeObjectURL(U)},4e4)}});f.saveAs=w.saveAs=w,R.exports=w})?s.apply(D,[]):s)&&(R.exports=u)}}]);